define(["require","exports","tslib","react","classnames","typescript/libraries/file-viewer/src/core/logging/constants","typescript/libraries/file-viewer/src/css/preview-html.module.css","typescript/libraries/file-viewer/src/css/preview-core.module.css","typescript/libraries/file-viewer/src/preview_html/types","typescript/libraries/file-viewer/src/libraries/frame_messenger/html_frame_messenger_host","typescript/libraries/file-viewer/src/keyboard/index","typescript/libraries/file-viewer/src/toolbar/toolbar","typescript/libraries/file-viewer/src/core/data/actions","typescript/libraries/file-viewer/src/hooks/useStabilizedCallback","typescript/libraries/file-viewer/src/plugins/types","typescript/libraries/file-viewer/src/core/utils/index"],(function(e,i,r,t,a,s,l,n,o,c,p,d,f,u,v,w){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.PreviewHTML=void 0,t=r.__importStar(t),a=r.__importDefault(a),l=r.__importStar(l),n=r.__importStar(n);const _={[p.Key.RightArrow]:{altKey:!0,ctrlKey:!0,metaKey:!0},[p.Key.LeftArrow]:{altKey:!0,ctrlKey:!0,metaKey:!0}},m=[".xlsx"];i.PreviewHTML=e=>{const{config:i,dispatch:r,coreFileViewerUiData:p,previewKey:b,fileConfig:C,rootArchiveFileInformation:y,fileViewerId:M,filePreviewUiData:I,fileMetadata:T,intl:g,toolbarPlugins:S,snackbarManagerPluginInstance:E,width:O,responsiveSize:L,isRawHtml:h,onSetPreviewLoaded:D,iframeSrc:N,iframeSandbox:R}=e,H=null!=N?N:e.previewMetadata&&e.previewMetadata.preview_url,A=e.fileMetadata&&e.fileMetadata.file_name,K=t.useRef(),F=i=>{var r;if((e=>o.ACTIONS_FROM_CHILD_IFRAME.includes(e.action))(i))switch(i.action){case o.FROM_CHILD_ACTIONS.FAILED:e.onRenderFailed();break;case o.FROM_CHILD_ACTIONS.VIEWER_READY:e.onInteractive(),e.onRenderSucceeded();break;case o.FROM_CHILD_ACTIONS.KEYDOWN_KEYS:null===(r=K.current)||void 0===r||r.postMessageToChildren(o.TO_CHILD_ACTIONS.SEND_KEYDOWN_KEYS,{keycodes:_});break;case o.FROM_CHILD_ACTIONS.KEYDOWN:const t=new KeyboardEvent("keydown",i.parameters);document.dispatchEvent(t);break;case o.FROM_CHILD_ACTIONS.ACTIVE_MOUSE:window.dispatchEvent(new MouseEvent("mousemove"))}},P=t.useRef(null);t.useEffect(()=>{T&&(null===P.current||P.current!==T.file_name)&&m.includes(w.getFileExtension(T.file_name))&&(r(f.triggerDynamicRoutingModalCheck()),P.current=T.file_name)},[r,T]),t.useEffect(()=>{if(!h)return K.current=new c.HTMLFrameMessengerHost([]),K.current.configureChildMessaging("iframe.previewhtml",F,o.ACTIONS_FROM_CHILD_IFRAME),K.current.startListening(),K.current.postMessageToChildren(o.TO_CHILD_ACTIONS.SEND_KEYDOWN_KEYS,{keycodes:[]}),()=>{var e;null===(e=K.current)||void 0===e||e.stopListening()}},[]),t.useEffect(()=>{null==D||D()},[D]);const k=u.useStabilizedCallback(()=>{e.onRenderFailed()}),x=u.useStabilizedCallback(()=>{h&&(e.onInteractive(),e.onRenderSucceeded())}),Y=u.useStabilizedCallback(()=>{var e;null===(e=K.current)||void 0===e||e.postMessageToChildren(o.TO_CHILD_ACTIONS.PRINT,{context:s.UserActionContext.Toolbar})}),z=null!=R?R:(null==C?void 0:C.enable_print)?"allow-modals allow-scripts":"allow-scripts";return t.createElement("div",{className:a.default(l.app,n.app,{[l.ios]:!1})},t.createElement("iframe",{title:A,onError:k,name:"preview-content",src:H,sandbox:z,className:a.default("previewhtml",l.previewContent),onLoad:x}),t.createElement(d.ConfigurableToolbar,{className:n.toolbar,featureConfig:i,rootArchiveFileInformation:y,fileConfig:C,filePreviewUi:I,fileViewerUi:p,fileMetadata:T,previewKey:b,fileViewerId:M,intl:g,dispatch:r,onPrint:Y,previewType:h?v.PreviewType.RawHTML:v.PreviewType.HTML,plugins:S,snackbarManagerPluginInstance:E,previewWidth:O,responsiveSize:L}))},i.PreviewHTML.displayName="PreviewHTML",i.PreviewHTML.displayName="PreviewHTML"}));
//# sourceMappingURL=preview_html.amd.min.js-vflr-jZul.map