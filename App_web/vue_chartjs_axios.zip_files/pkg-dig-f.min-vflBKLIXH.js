define("metaserver/static/js/prod_assets_web_modules/dig-components/typeahead",["exports","../common/tslib.es6","focus-visible","react","./click_outside","./hooks","../classnames","./motion","./overlay","./progress_indicators","./icons","./icons/src","./typography","./buttons","./layer","react-dom","../resize-observer-polyfill","../common/Transition","../@popperjs/core","../react-transition-group/CSSTransition","../common/extends"],(function(e,t,n,o,a,s,i,r,l,c,u,d,m,p,g,v,f,h,y,w,_){"use strict";var T=['.dig-Typeahead-row--interactive[role="option"]','.dig-Typeahead-row--interactive[role="menuitemcheckbox"]',".dig-Typeahead-results--show-more"],E={value:void 0,setSelected:function(){return!1},setFocused:function(){return!1},closeMenu:function(){return!1},isPortaled:!0,menuRows:s.createMenuRows(),containerId:"",setIsTypeaheadDropdownVisible:function(){}},x=o.createContext(E),b=o.createContext({}),R=o.createContext({}),C=function(e){var n=e.children,i=e.isPortaled,r=e.closeOnSelection,l=void 0===r||r,c=e.inlineProps,u=e.openMenuOnFocus,d=void 0===u||u,m=e.containerId,p=e.hasMaxHeight,g=void 0!==p&&p,v=e.onSelection,f=e.onBlur,h=e.onToggle,y=t.__rest(e,["children","isPortaled","closeOnSelection","inlineProps","openMenuOnFocus","containerId","hasMaxHeight","onSelection","onBlur","onToggle"]),w=o.useRef(null),_=o.useState(!1),E=_[0],b=_[1],R=o.useState(!1),C=R[0],M=R[1],N=o.useRef(null),P=o.useRef(null),S=s.useUniqueId({prefix:"dig-Typeahead",idOverride:m}),I=o.useCallback((function(e){C!==e&&M(e)}),[C]),k=o.useCallback((function(e,t){v&&v(e,t),l&&(P&&P.current&&P.current(void 0),w&&s.returnFocus(w))}),[l,v,P]),F=s.useMenu({triggerRef:w,contentRef:N,onSelection:k,onToggle:h,closeOnSelection:l,shouldFocusDisabledRows:!0,interactiveRowSelectors:T,allowLetterNavigation:!1,focusMenuRowTriggerKey:"ArrowDown",allowSpaceBarToOpenMenu:!1,focusNextItemImmediately:!1}),O=F.isOpen,D=F.openMenu,B=F.closeMenu,A=F.toggleMenu,K=F.value,z=F.setSelected,H=F.setFocused,L=F.getRootProps,U=F.getTriggerProps,j=F.getContentProps,V=F.menuRows,W=F.isFocusing;P.current=H;var q=o.useCallback((function(){b(!1),document.removeEventListener("mouseup",q)}),[]);o.useEffect((function(){return E&&document.addEventListener("mouseup",q),function(){return document.removeEventListener("mouseup",q)}}),[E,q]);var Q={getContentProps:function(e){return t.__assign(t.__assign({open:Boolean(O),triggerRef:w},j(t.__assign({tabIndex:void 0},e))),{role:"listbox"})},getTriggerProps:function(e){return t.__assign(t.__assign({},U(t.__assign(t.__assign({},e),{onKeyDown:function(t){if(c){var n=c.customOpenKey,o=c.onCustomOpenKeyTrigger,a=c.customCloseKey;t.key===n.key?(D({autoFocus:!1}),o&&o(t)):a&&t.key===a.key&&B({autoFocus:!1})}e&&e.onKeyDown&&e.onKeyDown(t)}}))),{role:"combobox","aria-haspopup":"listbox","aria-autocomplete":"list","aria-controls":S,onChange:function(t){c||D({autoFocus:!1}),e&&e.onChange&&e.onChange(t)},onMouseDown:function(t){e&&e.onMouseDown&&e.onMouseDown(t),b(!0)},onClick:e?e.onClick:void 0,onKeyUp:e?e.onKeyUp:void 0,onFocus:function(t){d&&D({autoFocus:!1}),H(void 0),e&&e.onFocus&&e.onFocus(t)}})},openMenu:D,closeMenu:B,toggleMenu:A,triggerRef:w},G=o.useCallback((function(e){K||W||B({autoFocus:!1}),f&&f(e)}),[K,W,B,f]),J={isPortaled:i,contentRef:N,value:K,setSelected:z,setFocused:H,closeMenu:B,inlineProps:c,menuRows:V,containerId:S,hasMaxHeight:g,setIsTypeaheadDropdownVisible:I},X=o.useCallback((function(){B({autoFocus:!1})}),[B]),Y=c?n&&n(Q):o.createElement(a.ClickOutside,{className:"dig-Typeahead-backdrop",isBlock:!0,onClickOutside:X,shouldPropagateMouseEvents:!1,isClickThroughPortaled:i,isActive:Boolean(O)&&!E&&C},n&&n(Q));return o.createElement(x.Provider,{value:J},o.createElement("div",t.__assign({className:"dig-Typeahead"},L(t.__assign(t.__assign({},y),{onBlur:G}))),Y))};C.displayName="Wrapper";var M=function(e){var n=e.className,a=e.children,s=t.__rest(e,["className","children"]),r=i("dig-Typeahead-row-accessory",n);return o.createElement("div",t.__assign({className:r},s),a)};M.displayName="RowAccessory";var N=function(e){var n=e.className,a=e.children,s=t.__rest(e,["className","children"]),r=i("dig-Typeahead-row-content",n);return o.createElement("div",t.__assign({className:r},s),a)};N.displayName="RowContent";var P=function(e){var n=e.className,a=e.children,s=t.__rest(e,["className","children"]),r=i("dig-Typeahead-row-subtitle",n);return o.createElement("div",t.__assign({className:r},s),a)};P.displayName="RowSubtitle";var S=function(e){var n=e.className,a=e.children,s=t.__rest(e,["className","children"]),r=i("dig-Typeahead-row-title",n);return o.createElement("div",t.__assign({className:r},s),a)};S.displayName="RowTitle";var I=function(e){var t=e.id,n=e.title,a=e.subTitle,s=e.sectionTitle;return o.createElement("div",{className:"dig-Typeahead-accessible-text",id:t},n," ",a,s&&", "+s)},k=o.forwardRef((function(e,n){var a=e.tagName,r=void 0===a?"li":a,l=e.role,c=void 0===l?"option":l,u=e.disabled,d=void 0!==u&&u,m=e.interactive,p=void 0===m||m,g=e.className,v=e.withLeftAccessory,f=e.withRightAccessory,h=e.withSubtitle,y=e.withTitle,w=e.onFocus,_=e.onMouseDown,T=e.value;e.tabIndex;var E=e.children,C=t.__rest(e,["tagName","role","disabled","interactive","className","withLeftAccessory","withRightAccessory","withSubtitle","withTitle","onFocus","onMouseDown","value","tabIndex","children"]),k=o.useRef(null),F=o.useContext(x),O=F.menuRows,D=F.setSelected,B=F.setFocused,A=o.useContext(R).resultIndex,K=o.useContext(b),z=K.rowIndex,H=K.focusIndex,L=K.sectionTitle,U=100*(A||0)+(z||0),j=s.useUniqueId({prefix:""}),V=s.useMenuItem({interactive:p,disabled:d,ref:k,role:c,index:U},O).getItemProps;o.useEffect((function(){void 0!==H&&H===z&&setTimeout((function(){k.current&&k.current.focus()}),0)}),[H,z]);var W=i("dig-Typeahead-row",{"dig-Typeahead-row--disabled":d,"dig-Typeahead-row--interactive":p},g);return o.useImperativeHandle(n,(function(){return{getBoundingClientRect:function(){if(k.current)return k.current.getBoundingClientRect()}}})),o.createElement(r,t.__assign({onMouseDown:function(e){e.preventDefault(),D(T,e),B(void 0),_&&_(e)},onFocus:function(e){B(T),w&&w(e)},className:W,ref:k},V(t.__assign({},C))),E||o.createElement(o.Fragment,null,v&&o.createElement(M,null,v),o.createElement(N,{"aria-labelledby":j},o.createElement(S,{"aria-hidden":"true"},y),h&&o.createElement(P,{"aria-hidden":"true"},h)),o.createElement(I,{id:j,title:y,subTitle:h,sectionTitle:L}),f&&o.createElement(M,null,f)))}));k.displayName="Row";var F=function(e){var t=e.children;return o.createElement("div",{className:"dig-Typeahead-prompt"},t)};F.displayName="Prompt";var O=function(e){var n=e.open,i=e.triggerRef,u=e.emptyState,d=e.emptyPrompt,m=e.isEmptyQuery,p=void 0!==m&&m,g=e.loading,v=e.children,f=e.auto,h=void 0===f||f,y=e.positioningStrategy,w=void 0===y?"absolute":y,_=e.placement,T=void 0===_?"bottom-start":_,E=e.omitOverlay,b=void 0!==E&&E,C=t.__rest(e,["open","triggerRef","emptyState","emptyPrompt","isEmptyQuery","loading","children","auto","positioningStrategy","placement","omitOverlay"]),M=o.useContext(x),N=M.menuRows,P=M.closeMenu,S=M.contentRef,I=M.isPortaled,k=M.containerId,O=M.inlineProps,D=M.hasMaxHeight,B=M.setIsTypeaheadDropdownVisible,A=o.useCallback((function(){P({autoFocus:!1})}),[P]),K=s.useMaxHeight({hasMaxHeight:D,contentRef:S}).styles,z=u||d;if(o.useEffect((function(){void 0===u||console.warn("dig-components:","emptyState is deprecated. Please use emptyPrompt for empty prompts.")}),[]),o.useEffect((function(){var e=!0;g||p&&z||0!==N.items.size||(e=!1),B(e)}),[g,z,p,N.items.size,B]),!n||!v)return null;var H=void 0,L={};if(g?H=o.createElement(F,null,o.createElement(c.Spinner,null)):p&&z?H=d||u:0===N.items.size?(H=v,L={display:"none"}):H=o.Children.map(v,(function(e,t){return o.createElement(R.Provider,{value:{resultIndex:t}},e)})),b)return o.createElement(o.Fragment,null,H);var U=(function(e){switch(e){default:return"up";case"bottom":case"bottom-start":case"bottom-end":return"down"}})(T),j=o.createElement(r.Motion,{transitionIn:{transitions:[{property:U,value:0},{property:"opacity",value:1}],easing:"enter",duration:125},transitionOut:{transitions:[{property:"opacity",value:0}],easing:"leave",duration:125},style:{opacity:0},in:n,mountOnEnter:!0,unmountOnExit:!0},(function(e){var a=e.state,s=e.style;return(n||"exited"!==a)&&o.createElement(l.Overlay,{anchorRef:i,auto:h,isPortaled:I,placement:T,positioningStrategy:w,offsetDistance:4,setWidthSameAsAnchor:!Boolean(O)},o.createElement("ul",t.__assign({className:"dig-Typeahead-container",ref:S,id:k,style:L},C),o.createElement("div",{className:"dig-Typeahead-container--canvas",style:t.__assign(t.__assign({},s),K)},H)))}));return O?o.createElement(a.ClickOutside,{className:"dig-Typeahead-backdrop",isBlock:!0,onClickOutside:A,shouldPropagateMouseEvents:!1,isClickThroughPortaled:I,isActive:Boolean(n)},j):j};O.displayName="Container";var D=function(e){var t=e.placeholderText;return o.createElement(F,null,o.createElement(u.UIIcon,{size:"large",src:d.SearchLine}),o.createElement(m.Text,{color:"faint"},t))};D.displayName="EmptyPrompt";var B=function(e){var n=e.onShowMoreClick,a=e.showMoreButtonText,i=void 0===a?"Show more":a,r=o.useRef(null),l=o.useContext(x),c=l.menuRows,u=l.setFocused,d=100*(o.useContext(R).resultIndex||0)+(o.useContext(b).rowIndex||0),m=s.useMenuItem({interactive:!0,disabled:!0,ref:r,role:"option",index:d},c).getItemProps,g=function(e){e.stopPropagation(),e.preventDefault(),n()};return o.createElement(p.Button,t.__assign(t.__assign({className:"dig-Typeahead-results--show-more",variant:"transparent",ref:r,type:"button",onClick:g,onKeyDown:function(e){"Enter"!==e.key&&" "!==e.key||(e.stopPropagation(),e.preventDefault(),n())},onMouseDown:g,onFocus:function(){u(void 0)}},m()),{disabled:!1,"aria-disabled":!1}),i)};function A(e){var t=e.results,n=e.title,a=e.renderRow,s=e.initialResults,r=void 0===s?4:s,l=e.maxResults,c=void 0===l?8:l,u=e.showMoreButtonText,d=e.size,p=void 0===d?"standard":d,g=o.useContext(x).setFocused,v=o.useState(Math.min(t.length,r)),f=v[0],h=v[1],y=o.useState(),w=y[0],_=y[1];if(o.useEffect((function(){h(Math.min(t.length,r))}),[t,r]),!t||0===t.length)return null;var T=i("dig-Typeahead-results",{"dig-Typeahead-results--standard":"standard"===p,"dig-Typeahead-results--large":"large"===p});return o.createElement("div",{className:T},n?o.createElement(m.Text,{className:"dig-Typeahead-results--title",color:"faint",isBold:!0,size:"small","aria-hidden":"true"},n):o.createElement("div",{className:"dig-Typeahead-results--title-spacer",role:"presentation"}),t.slice(0,f).map((function(e,t){return o.createElement(b.Provider,{key:t,value:{rowIndex:t,focusIndex:w,sectionTitle:n}},a(e))})),f<t.length&&f!==c&&o.createElement(b.Provider,{value:{rowIndex:f+100}},o.createElement(B,{showMoreButtonText:u,onShowMoreClick:function(){f<t.length&&(g(t[f]),_(f),h(Math.min(t.length,c)))}})))}B.displayName="ShowMore",A.displayName="Results";var K={Row:k,RowAccessory:M,RowContent:N,RowSubtitle:P,RowTitle:S,Wrapper:C,Container:O,Prompt:F,EmptyState:D,EmptyPrompt:D,Results:A};e.Typeahead=K,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=pkg-dig-f.min.js-vflomwYN-.map