define("metaserver/static/js/dropbox/proto/js_init_data/browse_web/browse_web",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/js_init_data/login_form/login_form"],(function(e,t,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.browse_web=void 0;const a=(s=i.__importStar(s)).Reader,o=s.Writer,r=s.util,l=s.roots.default||(s.roots.default={});var n;t.default=l,t.browse_web=l.browse_web=((n=l.browse_web||{}).BrowseExperiments=(function(e){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.goldenGateRaclsEnabled=!1,e.prototype.folderHistoryRollbacks=!1,e.prototype.lifeVault=!1,e.prototype.plusPlusEnabled=!1,e.prototype.browseWebHqlPilot=!1,e.prototype.browseColumnHeaderImprovements=!1,e.prototype.spacesFssModalVariant="",e.prototype.splitTmfTsd=!1,e.prototype.browseRowPerformance=!1,e.prototype.browseBoostSharing="",e.prototype.suggestedFoldersIndividual="",e.prototype.manualTagging="",e.prototype.suggestedFoldersPro="",e.prototype.browseCommitTokenBatch=!1,e.prototype.flowsAutomatedFolderUi=!1,e.prototype.flowsAutoTagUi=!1,e.prototype.browseContentSuggestionsVariant="",e.prototype.autoTagAwareness=!1,e.prototype.coreO21nLeverageEmptyStates="",e.prototype.isTransferEnabled=!1,e.prototype.multiObjectSharingRedesignExp="",e.prototype.coreO21nInFolderActivationM2="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.goldenGateRaclsEnabled&&Object.hasOwnProperty.call(e,"goldenGateRaclsEnabled")&&t.uint32(8).bool(e.goldenGateRaclsEnabled),null!=e.folderHistoryRollbacks&&Object.hasOwnProperty.call(e,"folderHistoryRollbacks")&&t.uint32(24).bool(e.folderHistoryRollbacks),null!=e.lifeVault&&Object.hasOwnProperty.call(e,"lifeVault")&&t.uint32(72).bool(e.lifeVault),null!=e.plusPlusEnabled&&Object.hasOwnProperty.call(e,"plusPlusEnabled")&&t.uint32(112).bool(e.plusPlusEnabled),null!=e.browseWebHqlPilot&&Object.hasOwnProperty.call(e,"browseWebHqlPilot")&&t.uint32(120).bool(e.browseWebHqlPilot),null!=e.browseColumnHeaderImprovements&&Object.hasOwnProperty.call(e,"browseColumnHeaderImprovements")&&t.uint32(176).bool(e.browseColumnHeaderImprovements),null!=e.spacesFssModalVariant&&Object.hasOwnProperty.call(e,"spacesFssModalVariant")&&t.uint32(226).string(e.spacesFssModalVariant),null!=e.splitTmfTsd&&Object.hasOwnProperty.call(e,"splitTmfTsd")&&t.uint32(240).bool(e.splitTmfTsd),null!=e.browseRowPerformance&&Object.hasOwnProperty.call(e,"browseRowPerformance")&&t.uint32(288).bool(e.browseRowPerformance),null!=e.browseBoostSharing&&Object.hasOwnProperty.call(e,"browseBoostSharing")&&t.uint32(298).string(e.browseBoostSharing),null!=e.suggestedFoldersIndividual&&Object.hasOwnProperty.call(e,"suggestedFoldersIndividual")&&t.uint32(322).string(e.suggestedFoldersIndividual),null!=e.manualTagging&&Object.hasOwnProperty.call(e,"manualTagging")&&t.uint32(330).string(e.manualTagging),null!=e.suggestedFoldersPro&&Object.hasOwnProperty.call(e,"suggestedFoldersPro")&&t.uint32(346).string(e.suggestedFoldersPro),null!=e.browseCommitTokenBatch&&Object.hasOwnProperty.call(e,"browseCommitTokenBatch")&&t.uint32(360).bool(e.browseCommitTokenBatch),null!=e.flowsAutomatedFolderUi&&Object.hasOwnProperty.call(e,"flowsAutomatedFolderUi")&&t.uint32(368).bool(e.flowsAutomatedFolderUi),null!=e.flowsAutoTagUi&&Object.hasOwnProperty.call(e,"flowsAutoTagUi")&&t.uint32(376).bool(e.flowsAutoTagUi),null!=e.browseContentSuggestionsVariant&&Object.hasOwnProperty.call(e,"browseContentSuggestionsVariant")&&t.uint32(386).string(e.browseContentSuggestionsVariant),null!=e.autoTagAwareness&&Object.hasOwnProperty.call(e,"autoTagAwareness")&&t.uint32(392).bool(e.autoTagAwareness),null!=e.coreO21nLeverageEmptyStates&&Object.hasOwnProperty.call(e,"coreO21nLeverageEmptyStates")&&t.uint32(410).string(e.coreO21nLeverageEmptyStates),null!=e.isTransferEnabled&&Object.hasOwnProperty.call(e,"isTransferEnabled")&&t.uint32(416).bool(e.isTransferEnabled),null!=e.multiObjectSharingRedesignExp&&Object.hasOwnProperty.call(e,"multiObjectSharingRedesignExp")&&t.uint32(426).string(e.multiObjectSharingRedesignExp),null!=e.coreO21nInFolderActivationM2&&Object.hasOwnProperty.call(e,"coreO21nInFolderActivationM2")&&t.uint32(434).string(e.coreO21nInFolderActivationM2),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));let i=void 0===t?e.len:e.pos+t,s=new l.browse_web.BrowseExperiments;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:s.goldenGateRaclsEnabled=e.bool();break;case 3:s.folderHistoryRollbacks=e.bool();break;case 9:s.lifeVault=e.bool();break;case 14:s.plusPlusEnabled=e.bool();break;case 15:s.browseWebHqlPilot=e.bool();break;case 22:s.browseColumnHeaderImprovements=e.bool();break;case 28:s.spacesFssModalVariant=e.string();break;case 30:s.splitTmfTsd=e.bool();break;case 36:s.browseRowPerformance=e.bool();break;case 37:s.browseBoostSharing=e.string();break;case 40:s.suggestedFoldersIndividual=e.string();break;case 41:s.manualTagging=e.string();break;case 43:s.suggestedFoldersPro=e.string();break;case 45:s.browseCommitTokenBatch=e.bool();break;case 46:s.flowsAutomatedFolderUi=e.bool();break;case 47:s.flowsAutoTagUi=e.bool();break;case 48:s.browseContentSuggestionsVariant=e.string();break;case 49:s.autoTagAwareness=e.bool();break;case 51:s.coreO21nLeverageEmptyStates=e.string();break;case 52:s.isTransferEnabled=e.bool();break;case 53:s.multiObjectSharingRedesignExp=e.string();break;case 54:s.coreO21nInFolderActivationM2=e.string();break;default:e.skipType(7&t)}}return s},e.getTypeUrl=function(){return"type.googleapis.com/browse_web.BrowseExperiments"},e})(n.BrowseExperiments||{}),n.BrowseWebPageProps=(function(e){function e(e){if(this.selectFqPaths=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.autoTeamGroupId="",e.prototype.emailJustVerified=!1,e.prototype.emailJustVerifiedAndChanged=!1,e.prototype.fromSclSyncModal=!1,e.prototype.initFqPath="",e.prototype.nsId=0,e.prototype.nsPath="",e.prototype.openPreview=!1,e.prototype.selectFqPaths=r.emptyArray,e.prototype.sendVerificationEmail=!1,e.prototype.shareLink=!1,e.prototype.sharePrefillEmail="",e.prototype.shouldShowDeletedFiles=!1,e.prototype.shouldShowUnsyncNotification=!1,e.prototype.shouldOpenExtensionsEduModal="",e.prototype.shouldOpenAppRecommendationsModal=!1,e.prototype.shouldOpenUploadModal=!1,e.prototype.showShareModal=!1,e.prototype.showShareSuccessSnackbar=!1,e.prototype.userId=0,e.prototype.userVersionHistoryLength=0,e.prototype.browseExperiments=null,e.prototype.webTimingLoggerServerContext="",e.prototype.showPlusPlusSetupModal=!1,e.prototype.isSmbPersonalization=!1,e.prototype.hasLinkedMobile=!1,e.prototype.encryptionOptions=null,e.prototype.fromCtl=!1,e.prototype.rootNsId=0,e.prototype.hasLinkedDesktop=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.autoTeamGroupId&&Object.hasOwnProperty.call(e,"autoTeamGroupId")&&t.uint32(10).string(e.autoTeamGroupId),null!=e.emailJustVerified&&Object.hasOwnProperty.call(e,"emailJustVerified")&&t.uint32(16).bool(e.emailJustVerified),null!=e.emailJustVerifiedAndChanged&&Object.hasOwnProperty.call(e,"emailJustVerifiedAndChanged")&&t.uint32(24).bool(e.emailJustVerifiedAndChanged),null!=e.fromSclSyncModal&&Object.hasOwnProperty.call(e,"fromSclSyncModal")&&t.uint32(32).bool(e.fromSclSyncModal),null!=e.initFqPath&&Object.hasOwnProperty.call(e,"initFqPath")&&t.uint32(42).string(e.initFqPath),null!=e.nsId&&Object.hasOwnProperty.call(e,"nsId")&&t.uint32(48).int64(e.nsId),null!=e.nsPath&&Object.hasOwnProperty.call(e,"nsPath")&&t.uint32(58).string(e.nsPath),null!=e.openPreview&&Object.hasOwnProperty.call(e,"openPreview")&&t.uint32(64).bool(e.openPreview),null!=e.selectFqPaths&&e.selectFqPaths.length)for(let i=0;i<e.selectFqPaths.length;++i)t.uint32(74).string(e.selectFqPaths[i]);return null!=e.sendVerificationEmail&&Object.hasOwnProperty.call(e,"sendVerificationEmail")&&t.uint32(80).bool(e.sendVerificationEmail),null!=e.shareLink&&Object.hasOwnProperty.call(e,"shareLink")&&t.uint32(88).bool(e.shareLink),null!=e.sharePrefillEmail&&Object.hasOwnProperty.call(e,"sharePrefillEmail")&&t.uint32(98).string(e.sharePrefillEmail),null!=e.shouldShowDeletedFiles&&Object.hasOwnProperty.call(e,"shouldShowDeletedFiles")&&t.uint32(104).bool(e.shouldShowDeletedFiles),null!=e.shouldShowUnsyncNotification&&Object.hasOwnProperty.call(e,"shouldShowUnsyncNotification")&&t.uint32(112).bool(e.shouldShowUnsyncNotification),null!=e.shouldOpenExtensionsEduModal&&Object.hasOwnProperty.call(e,"shouldOpenExtensionsEduModal")&&t.uint32(122).string(e.shouldOpenExtensionsEduModal),null!=e.shouldOpenAppRecommendationsModal&&Object.hasOwnProperty.call(e,"shouldOpenAppRecommendationsModal")&&t.uint32(128).bool(e.shouldOpenAppRecommendationsModal),null!=e.shouldOpenUploadModal&&Object.hasOwnProperty.call(e,"shouldOpenUploadModal")&&t.uint32(136).bool(e.shouldOpenUploadModal),null!=e.showShareModal&&Object.hasOwnProperty.call(e,"showShareModal")&&t.uint32(144).bool(e.showShareModal),null!=e.showShareSuccessSnackbar&&Object.hasOwnProperty.call(e,"showShareSuccessSnackbar")&&t.uint32(152).bool(e.showShareSuccessSnackbar),null!=e.userId&&Object.hasOwnProperty.call(e,"userId")&&t.uint32(176).int64(e.userId),null!=e.userVersionHistoryLength&&Object.hasOwnProperty.call(e,"userVersionHistoryLength")&&t.uint32(184).int32(e.userVersionHistoryLength),null!=e.browseExperiments&&Object.hasOwnProperty.call(e,"browseExperiments")&&l.browse_web.BrowseExperiments.encode(e.browseExperiments,t.uint32(194).fork()).ldelim(),null!=e.webTimingLoggerServerContext&&Object.hasOwnProperty.call(e,"webTimingLoggerServerContext")&&t.uint32(210).string(e.webTimingLoggerServerContext),null!=e.showPlusPlusSetupModal&&Object.hasOwnProperty.call(e,"showPlusPlusSetupModal")&&t.uint32(216).bool(e.showPlusPlusSetupModal),null!=e.isSmbPersonalization&&Object.hasOwnProperty.call(e,"isSmbPersonalization")&&t.uint32(224).bool(e.isSmbPersonalization),null!=e.hasLinkedMobile&&Object.hasOwnProperty.call(e,"hasLinkedMobile")&&t.uint32(232).bool(e.hasLinkedMobile),null!=e.encryptionOptions&&Object.hasOwnProperty.call(e,"encryptionOptions")&&l.login_form.EncryptionOptions.encode(e.encryptionOptions,t.uint32(242).fork()).ldelim(),null!=e.fromCtl&&Object.hasOwnProperty.call(e,"fromCtl")&&t.uint32(248).bool(e.fromCtl),null!=e.rootNsId&&Object.hasOwnProperty.call(e,"rootNsId")&&t.uint32(256).int64(e.rootNsId),null!=e.hasLinkedDesktop&&Object.hasOwnProperty.call(e,"hasLinkedDesktop")&&t.uint32(264).bool(e.hasLinkedDesktop),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));let i=void 0===t?e.len:e.pos+t,s=new l.browse_web.BrowseWebPageProps;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:s.autoTeamGroupId=e.string();break;case 2:s.emailJustVerified=e.bool();break;case 3:s.emailJustVerifiedAndChanged=e.bool();break;case 4:s.fromSclSyncModal=e.bool();break;case 5:s.initFqPath=e.string();break;case 6:s.nsId=e.int64();break;case 7:s.nsPath=e.string();break;case 8:s.openPreview=e.bool();break;case 9:s.selectFqPaths&&s.selectFqPaths.length||(s.selectFqPaths=[]),s.selectFqPaths.push(e.string());break;case 10:s.sendVerificationEmail=e.bool();break;case 11:s.shareLink=e.bool();break;case 12:s.sharePrefillEmail=e.string();break;case 13:s.shouldShowDeletedFiles=e.bool();break;case 14:s.shouldShowUnsyncNotification=e.bool();break;case 15:s.shouldOpenExtensionsEduModal=e.string();break;case 16:s.shouldOpenAppRecommendationsModal=e.bool();break;case 17:s.shouldOpenUploadModal=e.bool();break;case 18:s.showShareModal=e.bool();break;case 19:s.showShareSuccessSnackbar=e.bool();break;case 22:s.userId=e.int64();break;case 23:s.userVersionHistoryLength=e.int32();break;case 24:s.browseExperiments=l.browse_web.BrowseExperiments.decode(e,e.uint32());break;case 26:s.webTimingLoggerServerContext=e.string();break;case 27:s.showPlusPlusSetupModal=e.bool();break;case 28:s.isSmbPersonalization=e.bool();break;case 29:s.hasLinkedMobile=e.bool();break;case 30:s.encryptionOptions=l.login_form.EncryptionOptions.decode(e,e.uint32());break;case 31:s.fromCtl=e.bool();break;case 32:s.rootNsId=e.int64();break;case 33:s.hasLinkedDesktop=e.bool();break;default:e.skipType(7&t)}}return s},e.getTypeUrl=function(){return"type.googleapis.com/browse_web.BrowseWebPageProps"},e})(n.BrowseWebPageProps||{}),n)})),define("metaserver/static/js/modules/clean/photos/thumbnail_url_util",["require","exports","tslib","lodash","metaserver/static/js/modules/constants/python","metaserver/static/js/modules/core/assert","metaserver/static/js/modules/core/uri"],(function(e,t,i,s,a,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fullSizeUrl=t.thumbnailUrlForSize=t.ThumbnailSizeMode=void 0,s=i.__importStar(s),a=i.__importStar(a),t.ThumbnailSizeMode=a.THUMBNAIL_SIZE_MODE;const l=a.THUMBNAIL_SIZES;t.thumbnailUrlForSize=function(e,i,a,n){o.assert(null!=i==(null!=a),"Width and height must both be specified or neither");const d={};if(null==i)o.assert(n===t.ThumbnailSizeMode.ORIGINAL||null===n,"You must supply width and height");else{const e=`${i}x${a}`;o.assert(l.indexOf(e)>-1,`Invalid thumbnail size (${e})`),d.size=e}return null!=n&&(o.assert(s.values(t.ThumbnailSizeMode).indexOf(n)>-1,`Invalid thumbnail size mode (${n})`),d.size_mode=n.toString()),r.URI.parse(e).updateQuery(d).toString()},t.fullSizeUrl=function(e){return r.URI.parse(e).updateQuery({size_mode:t.ThumbnailSizeMode.ORIGINAL.toString(),fv_content:"true"}).toString()}})),define("metaserver/static/js/modules/clean/react/browse/browse_right_rail/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_BROWSE_BLADE=void 0,t.DEFAULT_BROWSE_BLADE="info"})),define("metaserver/static/js/modules/clean/react/browse/data/helpers",["require","exports","tslib","lodash","metaserver/static/js/modules/clean/filepath/filepath","metaserver/static/js/modules/clean/react/snackbar","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/clean/sync_everything/constants"],(function(e,t,i,s,a,o,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isBackupFolder=t.getPathForNewMountPoint=t.getMountPointUpdateForCurrentPath=t.showUserNotificationForPathChange=void 0,s=i.__importStar(s),a=i.__importStar(a),t.showUserNotificationForPathChange=(e,t)=>{switch(null!=t.change_type?t.change_type.toLowerCase():null){case"moved":o.Snackbar.complete(r.intl.formatMessage({id:"dte+6z",defaultMessage:"This folder has been moved"}),"browse-notification");break;case"renamed":o.Snackbar.complete(r.intl.formatMessage({id:"y/ubfn",defaultMessage:"This folder has been renamed to “{folder_name}”"},{folder_name:i(t.change_to_fq_path)}),"browse-notification");break;case"deleted":o.Snackbar.fail(r.intl.formatMessage({id:"MK7bBv",defaultMessage:"The folder “{folder_name}” has been deleted"},{folder_name:i(t.old_fq_path)}),"browse-notification")}function i(e){return s.escape(a.filename(e))}},t.getMountPointUpdateForCurrentPath=(e,t,i)=>{const a=e=>t===e;let o,r;return i&&i.find(a)?(r=i.find(a)||null,o=e[i.findKey(a)]||null):(r=null,o=s.find(e,a)||null),[r,o]},t.getPathForNewMountPoint=(e,t,i)=>e&&!t?i:e&&t?a.paths_are_equal(e,t)?null:t:!e&&t?i:null,t.isBackupFolder=e=>{var t;return l.BACKUP_ICONS.includes(null!==(t=null==e?void 0:e.icon)&&void 0!==t?t:"")}})),define("metaserver/static/js/modules/clean/react/browse/data/types",["require","exports","tslib","immutable","metaserver/static/js/dropbox/proto/js_init_data/browse_web/browse_web","metaserver/static/js/modules/clean/react/browse/models","metaserver/static/js/modules/clean/react/files_view/types","metaserver/static/js/modules/clean/react/selection","metaserver/static/js/modules/clean/react/browse/browse_right_rail/types","metaserver/static/js/modules/clean/react/flows/types"],(function(e,t,i,s,a,o,r,l,n,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultBrowseState=t.ActionTypes=void 0,s=i.__importStar(s),(function(e){e.APP_INIT="BROWSE/APP_INIT",e.PUSH_BOLT_IGNORE="BROWSE/PUSH_BOLT_IGNORE",e.POP_BOLT_IGNORE="BROWSE/POP_BOLT_IGNORE",e.SELECT_FILES_BY_FQ_PATH="BROWSE/SELECT_FILES_BY_FQ_PATH",e.SHOW_TIMELINE="BROWSE/SHOW_TIMELINE",e.HIDE_TIMELINE="BROWSE/HIDE_TIMELINE",e.SHOW_FOLDER_HISTORY_PANEL="BROWSE/SHOW_FOLDER_HISTORY_PANEL",e.HIDE_FOLDER_HISTORY_PANEL="BROWSE/HIDE_FOLDER_HISTORY_PANEL",e.SET_IS_REWIND_ENABLED="BROWSE/SET_IS_REWIND_ENABLED",e.SET_BROWSE_POST_TTI_EXPERIMENTS="BROWSE/SET_BROWSE_POST_TTI_EXPERIMENTS",e.SET_BROWSE_POST_TTI_DATA="BROWSE/SET_BROWSE_POST_TTI_DATA",e.SET_CAN_DISPLAY_FOLDER_SIZES="BROWSE/SET_CAN_DISPLAY_FOLDER_SIZES",e.SET_CLIPBOARD_FILES="BROWSE/SET_CLIPBOARD_FILES",e.SET_CONTEXT="BROWSE/SET_CONTEXT",e.SET_CURRENT_FOLDER_INFO="BROWSE/SET_CURRENT_FOLDER_INFO",e.SET_FILE_HAS_AUTOMATED_RULE_MAP="BROWSE/SET_FILE_HAS_AUTOMATED_RULE_MAP",e.SET_FILE_JUMP_FILTER="BROWSE/SET_FILE_JUMP_FILTER",e.SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE="BROWSE/SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE",e.SET_FILE_RENAME="BROWSE/SET_FILE_RENAME",e.SET_FOLDER_SIZES="BROWSE/SET_FOLDER_SIZES",e.SET_LOADING_STATE="BROWSE/SET_LOADING_STATE",e.SET_MOUNT_POINTS="BROWSE/SET_MOUNT_POINTS",e.SET_NEW_FOLDER_CREATION_STATE="BROWSE/SET_NEW_FOLDER_CREATION_STATE",e.SET_PAGINATED_TOTAL_NUM_FILES="BROWSE/SET_PAGINATED_TOTAL_NUM_FILES",e.SET_PATH="BROWSE/SET_PATH",e.SET_SELECTION="BROWSE/SET_SELECTION",e.SET_SHOULD_SHOW_DELETED_FILES="BROWSE/SET_SHOULD_SHOW_DELETED_FILES",e.SET_SORT_ORDER="BROWSE/SET_SORT_ORDER",e.SET_UNSORTED_FILES="BROWSE/SET_UNSORTED_FILES",e.SET_IS_FILE_VIEWER_SHOWN="BROWSE/IS_FILE_VIEWER_SHOWN",e.SET_IS_SEARCH_MODE="BROWSE/SET_IS_SEARCH_MODE",e.REQUEST_FOLDER_SIZES="BROWSE/REQUEST_FOLDER_SIZES",e.SET_FOLDER_SIZES_PENDING="BROWSE/SET_FOLDER_SIZES_PENDING",e.COMPLETE_FOLDER_SIZES="BROWSE/COMPLETE_FOLDER_SIZES",e.SET_ARE_POST_TTI_MODULES_LOADED="BROWSE/SET_ARE_POST_TTI_MODULES_LOADED",e.SET_VIEW_SCOPE="BROWSE/SET_VIEW_SCOPE",e.SET_HIDE_FILES_AND_SIDEBAR="BROWSE/SET_HIDE_FILES_AND_SIDEBAR",e.SET_IS_CREATING_SHARED_LINK="BROWSE/SET_IS_CREATING_SHARED_LINK",e.SET_RIGHTRAIL_IS_COLLAPSED="BROWSE/SET_RIGHTRAIL_COLLAPSED",e.SET_EXPANDED_BLADE="BROWSE/SET_EXPANDED_BLADE",e.SET_HAS_USER_UPLOADED_FILES="BROWSE/SET_HAS_USER_UPLOADED_FILES",e.SET_OVERFLOW_MENU_OPEN_REQUEST="BROWSE/SET_OVERFLOW_MENU_OPEN_REQUEST",e.SET_INLINE_OVERFLOW_MENU_OPEN_REQUEST="BROWSE/SET_INLINE_OVERFLOW_MENU_OPEN_REQUEST",e.SET_OVERFLOW_MENU_COORDINATES="BROWSE/SET_OVERFLOW_MENU_COORDINATES",e.SET_OVERFLOW_MENU_CLOSE_REQUEST="BROWSE/SET_OVERFLOW_MENU_CLOSE_REQUEST",e.SET_FOLDER_MEMBER_COUNTS="BROWSE/SET_FOLDER_MEMBER_COUNTS",e.TOGGLE_SPACES_ENTRY_POINT="BROWSE/TOGGLE_SPACES_ENTRY_POINT",e.SET_CREATE_MENU_OPEN_REQUEST="BROWSE/SET_CREATE_MENU_OPEN_REQUEST",e.HANDLE_APP_CLEANUP="BROWSE/HANDLE_APP_CLEANUP",e.SHOW_PERSONALIZATION_SUGGESTED_FOLDERS="BROWSE/SHOW_PERSONALIZATION_SUGGESTED_FOLDERS",e.SHOW_ONBOARDING_CHECKLIST_SHARE_BUTTON_TOOLTIP="BROWSE/SHOW_ONBOARDING_CHECKLIST_SHARE_BUTTON_TOOLTIP",e.SET_BACKUP_FOLDERS="BROWSE/SET_BACKUP_FOLDERS",e.SET_FULL_FUNNEL_M2_OVERRIDES="BROWSE/SET_FULL_FUNNEL_M2_OVERRIDES"})(t.ActionTypes||(t.ActionTypes={})),t.defaultBrowseState={boltIgnore:{added:new Set,moved:new Set,removed:new Set},canDisplayFolderSizes:!1,clipboard:{files:[]},context:new o.BrowseContext,isRewindButtonEnabled:!1,experiments:a.browse_web.BrowseExperiments.create(),browsePostTTIExperiments:{},browsePostTTIExperimentsOverrides:{},fileJumpFilter:"",filePathsToSelectOnNextUpdate:s.Set(),folderSizes:s.Map(),isRewindVisible:!1,isFolderHistoryVisible:!1,clickRewindTimestamp:void 0,clickFolderHistoryTimestamp:void 0,loadingState:r.LoadingState.LOADING_FIRST_PAGE,mountPoints:null,newFolderCreationState:r.NewFolderCreationState.CREATE_FOLDER_INACTIVE,paginatedTotalNumFiles:0,path:"",selection:l.createSelection(),shouldShowDeletedFiles:!1,user:null,unsortedFiles:s.Map(),viewer:null,currentFolderSizesQuery:s.Set(),isQueryingFolderSizes:!1,isSearchMode:!1,hasLinkedMobile:!1,hasLinkedDesktop:!1,autoTeamGroupId:"",browsePostTTIData:{isOverFreeQuota:!1,hasExcludedNsIds:!1,uploaderPostTTIExperiments:{},preferredEditors:{},mobileWebInvites:!1,firstTaskProps:{is_eligible_team:!1,is_subtitle:!1,member_info:{tiered_admin:!1,users:[],evh_max_days:0,team_available_roles:[]},needs_pairing_token:!1,seen_desktop_tooltip:!1},familyMemberCount:0},arePostTTIModulesLoaded:!1,shouldHideFilesAndSidebar:!1,isCreatingSharedLinkMap:s.Map(),isRightRailCollapsed:!1,fileHasAutomatedRuleMap:d.FlowsMap({}),expandedBlade:n.DEFAULT_BROWSE_BLADE,folderMemberCounts:0,isSpacesEntryPointEnabled:!0,backupFolders:null}})),define("metaserver/static/js/modules/clean/react/browse/sort_helpers",["require","exports"],(function(e,t){"use strict";function i(e,t,i){const s="=ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(let a=0;a<Math.max(e.length,t.length);a++){const o=e.charAt(a),r=t.charAt(a);if(!o)return-i;if(!r)return i;const l=s.indexOf(o),n=s.indexOf(r);if(l<n)return-i;if(n<l)return i}return 0}Object.defineProperty(t,"__esModule",{value:!0}),t.compare=void 0,t.compare=function(e,t,s,a){if(Array.isArray(e)&&Array.isArray(t)){for(let a=0;a<Math.max(e.length,t.length);a++){const o=e[a],r=t[a];if(null==o)return-s;if(null==r)return s;if("number"==typeof o&&"string"==typeof r)return-s;if("number"==typeof r&&"string"==typeof o)return s;if("string"==typeof o&&"string"==typeof r){const e=i(o,r,s);if(0!==e)return e}else{if(o<r)return-s;if(r<o)return s}}return 0}return e===t?0:a&&"string"==typeof e&&"string"==typeof t?a(e,t)<0?-s:s:e<t?-s:s}})),define("metaserver/static/js/modules/clean/react/browse/util",["require","exports","tslib","metaserver/static/js/modules/clean/filepath/filepath","metaserver/static/js/modules/clean/react/browse/models","metaserver/static/js/modules/clean/react/browse/sort_helpers","metaserver/static/js/modules/clean/browse_uri_interface","metaserver/static/js/modules/clean/react/files_view/sort_types","metaserver/static/js/modules/core/exception","metaserver/static/js/modules/core/i18n"],(function(e,t,i,s,a,o,r,l,n,d){"use strict";function c(e,t){return{isFolder:e.is_dir,value:t,isAlwaysFirst:u(e)}}function u(e){return a.File.isTeamMemberFolder(e)||a.File.isFamilySharedFolder(e)}function g(e,t){return e&&t?0:e?-1:t?1:0}Object.defineProperty(t,"__esModule",{value:!0}),t.getUrlForBackupPath=t.sortFiles=t.getSelectedFilesText=void 0,s=i.__importStar(s),t.getSelectedFilesText=function(e,t){const i=e.count(),s=d.intl.formatMessage({id:"v+fiz1",defaultMessage:"You only have partial access"});return i>0?1!==i||a.File.canViewFileMembers(e.first(),t)?d.intl.formatMessage({id:"cruh0p",defaultMessage:"{count, plural, one{{count} item selected} other{{count} items selected}}"},{count:i}):a.File.isNoAccessSharedFolder(e.first())?d.intl.formatMessage({id:"5Uq4ka",defaultMessage:"You don’t have access to this folder"}):s:t&&!t.canViewContainingNSMembers?s:""},t.sortFiles=function(e,{sortField:t,sortDirection:i},s){const r=(function(e,t){switch(e){case l.SortField.FILENAME:case l.SortField.SHARED_WITH:case l.SortField.TAGS:return e=>c(e,a.File.getFilename(e));case l.SortField.MODIFIED:return e=>c(e,e.ts);case l.SortField.CATEGORY:return e=>c(e,a.File.getCategoryDescription(e));case l.SortField.EXTENSION:return e=>c(e,a.File.getExtension(e));case l.SortField.SIZE:return e=>c(e,e.is_dir&&(null==t?void 0:t.has(e.fq_path))?t.get(e.fq_path).size:e.bytes);default:return}})(t,s),u=(function(e,t){const i=d.case_insensitive_comparator(!0),s=t===l.SortDirection.ASCENDING?1:-1;switch(e){case l.SortField.FILENAME:case l.SortField.SHARED_WITH:case l.SortField.SIZE:case l.SortField.TAGS:return(function(e,t){return function({isFolder:i,value:s,isAlwaysFirst:a},{isFolder:r,value:l,isAlwaysFirst:n}){const d=g(a,n);return 0!==d?d:(s||(s=1/0*e),l||(l=1/0*e),i&&r?o.compare(s,l,e,t):i?-e:r?e:o.compare(s,l,e,t))}})(s,i);case l.SortField.MODIFIED:case l.SortField.CATEGORY:case l.SortField.EXTENSION:return(function(e,t){return function({isFolder:i,value:s,isAlwaysFirst:a},{isFolder:r,value:l,isAlwaysFirst:n}){const d=g(a,n);return 0!==d?d:i&&r?o.compare(s,l,e,t):i?1:r?-1:""===s?1:""===l?-1:o.compare(s,l,e,t)}})(s,i);default:return}})(t,i);return r&&u?e.sortBy(r,u):(n.reportException({err:new Error("sortFiles was called with an unsupported sort field"),tags:["browse_sort_invalid_field"],severity:n.SEVERITY.CRITICAL,exc_extra:{sort_field:t}}),e)},t.getUrlForBackupPath=(e,t,i)=>e===s.parent_dir(i)?"/backup":r.browse_uri_for_fq_path(t,e).toString()})),define("metaserver/static/js/modules/clean/react/files_view/constants",["require","exports","tslib","react","metaserver/static/js/modules/clean/react/files_view/types","metaserver/static/js/modules/clean/react/files_view/sort_types","metaserver/static/js/modules/clean/react/files_view/view_type","metaserver/static/js/modules/core/i18n"],(function(e,t,i,s,a,o,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultViewTypes=t.IMAGE_THUMBNAIL_EXTENSIONS=t.VIEW_TYPE_SCOPE_IMAGE_SEARCH=t.VIEW_TYPE_SCOPE_TEXT_SEARCH=t.VIEW_TYPE_GLOBAL_SCOPE=t.VIEW_TYPE_COOKIE_NAME=t.OverflowMenuConstants=t.CulledListConstants=t.ViewTypeGridSizes=t.ViewTypeThumbnailSizes=t.AllSortDirections=t.AllLoadingStates=t.SortIsFilename=t.AllSortFields=t.AllDropTargetHighlightModes=t.AllViewTypes=t.AllRenameStates=t.AllNewFolderCreationStates=t.FilesViewTileGridConstants=t.SEARCH_LIST_VIEW_COLUMNS_DELETED=t.SEARCH_GRID_VIEW_SORT_ENABLED_COLUMNS=t.SEARCH_LIST_VIEW_SORT_ENABLED_COLUMNS=t.SEARCH_LIST_VIEW_COLUMNS=t.GRID_VIEW_COLUMNS=t.LIST_VIEW_COLUMNS=t.ClientPortalClientAccessLabel=t.SharedWithLabel=t.GRID_VIEW_COLUMN_FLEX_RIGHT_RAIL=t.GRID_VIEW_COLUMN_FLEX=t.COLUMN_MAX_WIDTHS=t.COLUMN_MIN_WIDTHS=t.COLUMN_DEFAULT_WIDTHS=t.LIST_VIEW_SEARCH_MODE_COLUMN_FLEX=t.FILE_NAME_CELL_SEARCH_FLEX_BASIS=t.LIST_VIEW_COLUMN_FLEX=t.FILE_NAME_TOOLTIP_MAX_LINE_LENGTH=t.CHECKBOX_CELL_FLEX_RIGHT_RAIL=t.CHECKBOX_CELL_FLEX=t.COMPACT_COLUMN_HEADER_HEIGHT=t.DEFAULT_ROW_HEIGHT_WITH_SNIPPETS=t.MEDIA_INFO_ITEM_HEIGHT=t.TAGS_HEIGHT=t.MEDIA_CELL_ICON_WIDTH=t.SNIPPET_HORIZONTAL_PADDING=t.SNIPPET_HEIGHT_PER_ROW=t.ROW_SNIPPET_VERTICAL_MARGIN=t.ROW_VERTICAL_PADDING=t.ROW_SUBTITLE_HEIGHT=t.ROW_TITLE_HEIGHT=t.DEFAULT_ROW_HEIGHT_CONDENSED_LIST=t.DEFAULT_ROW_HEIGHT_DENSE=t.DEFAULT_ROW_HEIGHT=t.DEFAULT_COLUMN_HEADER_HEIGHT=void 0,s=i.__importDefault(s);const n=l.intl.formatMessage({id:"P+XAua",defaultMessage:"Name"});t.DEFAULT_COLUMN_HEADER_HEIGHT=40,t.DEFAULT_ROW_HEIGHT=72,t.DEFAULT_ROW_HEIGHT_DENSE=60,t.DEFAULT_ROW_HEIGHT_CONDENSED_LIST=40,t.ROW_TITLE_HEIGHT=24,t.ROW_SUBTITLE_HEIGHT=16,t.ROW_VERTICAL_PADDING=16,t.ROW_SNIPPET_VERTICAL_MARGIN=8,t.SNIPPET_HEIGHT_PER_ROW=16,t.SNIPPET_HORIZONTAL_PADDING=16,t.MEDIA_CELL_ICON_WIDTH=64,t.TAGS_HEIGHT=22,t.MEDIA_INFO_ITEM_HEIGHT=16,t.DEFAULT_ROW_HEIGHT_WITH_SNIPPETS=t.ROW_VERTICAL_PADDING+t.ROW_TITLE_HEIGHT+t.ROW_SUBTITLE_HEIGHT+t.ROW_SNIPPET_VERTICAL_MARGIN+3*t.SNIPPET_HEIGHT_PER_ROW,t.COMPACT_COLUMN_HEADER_HEIGHT=48,t.CHECKBOX_CELL_FLEX="0 0 36px",t.CHECKBOX_CELL_FLEX_RIGHT_RAIL="0 0 44px",t.FILE_NAME_TOOLTIP_MAX_LINE_LENGTH=65,t.LIST_VIEW_COLUMN_FLEX={3:[t.CHECKBOX_CELL_FLEX,"1 1 50%","0 0 25%","0 0 25%"],2:[t.CHECKBOX_CELL_FLEX,"1 1 60%","0 0 40%"],1:[t.CHECKBOX_CELL_FLEX,"1 1 100%"]},t.FILE_NAME_CELL_SEARCH_FLEX_BASIS={3:50,2:65,1:100},t.LIST_VIEW_SEARCH_MODE_COLUMN_FLEX={3:[t.CHECKBOX_CELL_FLEX,`1 1 ${t.FILE_NAME_CELL_SEARCH_FLEX_BASIS[3]}%`,"0 0 25%","0 0 25%"],2:[t.CHECKBOX_CELL_FLEX,`1 1 ${t.FILE_NAME_CELL_SEARCH_FLEX_BASIS[2]}%`,"0 0 35%"],1:[t.CHECKBOX_CELL_FLEX,`1 1 ${t.FILE_NAME_CELL_SEARCH_FLEX_BASIS[1]}%`]},t.COLUMN_DEFAULT_WIDTHS={FILENAME:300,MODIFIED:160,CATEGORY:160,EXTENSION:160,SIZE:130,SHARED_WITH:160,SYNC_SETTING:160,FILE_COUNTS:160,RELEVANCE:160,LOCKED_FILES:160,POLICY:160,TAGS:160,CLIENT_ACCESS:160},t.COLUMN_MIN_WIDTHS={FILENAME:200,MODIFIED:140,CATEGORY:120,EXTENSION:160,SIZE:120,SHARED_WITH:120,SYNC_SETTING:120,FILE_COUNTS:120,RELEVANCE:150,LOCKED_FILES:120,POLICY:120,TAGS:120,CLIENT_ACCESS:360},t.COLUMN_MAX_WIDTHS={FILENAME:1200,MODIFIED:200,CATEGORY:300,EXTENSION:300,SIZE:200,SHARED_WITH:300,SYNC_SETTING:300,FILE_COUNTS:300,RELEVANCE:300,LOCKED_FILES:300,POLICY:300,TAGS:300,CLIENT_ACCESS:360},t.GRID_VIEW_COLUMN_FLEX=[t.CHECKBOX_CELL_FLEX,"1 1"],t.GRID_VIEW_COLUMN_FLEX_RIGHT_RAIL=[t.CHECKBOX_CELL_FLEX_RIGHT_RAIL,"1 1"],t.SharedWithLabel=()=>s.default.createElement(s.default.Fragment,null,l.intl.formatMessage({id:"kGg5/N",defaultMessage:"Who can access"})),t.ClientPortalClientAccessLabel=()=>s.default.createElement(s.default.Fragment,null,l.intl.formatMessage({id:"oXDivo",defaultMessage:"Privacy"})),t.LIST_VIEW_COLUMNS=[{sortField:o.SortField.FILENAME,label:n,popoverTriggerLabel:n,isLocked:!0},{sortField:o.SortField.MODIFIED,label:l.intl.formatMessage({id:"GaUyyL",defaultMessage:"Modified"}),popoverTriggerLabel:l.intl.formatMessage({id:"GaUyyL",defaultMessage:"Modified"}),loggingLabel:"Modified"},{sortField:o.SortField.CLIENT_ACCESS,label:s.default.createElement(t.ClientPortalClientAccessLabel,null),popoverTriggerLabel:l.intl.formatMessage({id:"8ICd+C",defaultMessage:"Clients"}),loggingLabel:"Clients",isSortOrderOptionDisabled:!0},{sortField:o.SortField.SHARED_WITH,label:s.default.createElement(t.SharedWithLabel,null),popoverTriggerLabel:l.intl.formatMessage({id:"HLRJwR",defaultMessage:"Members"}),loggingLabel:"Members",isSortOrderOptionDisabled:!0},{sortField:o.SortField.CATEGORY,label:l.intl.formatMessage({id:"Pet0Vl",defaultMessage:"Type"}),popoverTriggerLabel:l.intl.formatMessage({id:"Pet0Vl",defaultMessage:"Type"}),loggingLabel:"Type"},{sortField:o.SortField.EXTENSION,label:l.intl.formatMessage({id:"ZZCH08",defaultMessage:"Extension"}),popoverTriggerLabel:l.intl.formatMessage({id:"ZZCH08",defaultMessage:"Extension"}),loggingLabel:"Extension"},{sortField:o.SortField.SIZE,label:l.intl.formatMessage({id:"txUjQq",defaultMessage:"Size"}),popoverTriggerLabel:l.intl.formatMessage({id:"txUjQq",defaultMessage:"Size"}),loggingLabel:"Size"},{sortField:o.SortField.TAGS,label:l.intl.formatMessage({id:"hI7tD7",defaultMessage:"Tags"}),popoverTriggerLabel:l.intl.formatMessage({id:"hI7tD7",defaultMessage:"Tags"}),isSortOrderOptionDisabled:!0,loggingLabel:"Tags"}],t.GRID_VIEW_COLUMNS=[{sortField:o.SortField.FILENAME,label:n,popoverTriggerLabel:n},{sortField:o.SortField.MODIFIED,label:l.intl.formatMessage({id:"GaUyyL",defaultMessage:"Modified"}),popoverTriggerLabel:l.intl.formatMessage({id:"GaUyyL",defaultMessage:"Modified"}),loggingLabel:"Modified"},{sortField:o.SortField.CATEGORY,label:l.intl.formatMessage({id:"Pet0Vl",defaultMessage:"Type"}),popoverTriggerLabel:l.intl.formatMessage({id:"Pet0Vl",defaultMessage:"Type"}),loggingLabel:"Type"},{sortField:o.SortField.EXTENSION,label:l.intl.formatMessage({id:"ZZCH08",defaultMessage:"Extension"}),popoverTriggerLabel:l.intl.formatMessage({id:"ZZCH08",defaultMessage:"Extension"}),loggingLabel:"Extension"},{sortField:o.SortField.SIZE,label:l.intl.formatMessage({id:"txUjQq",defaultMessage:"Size"}),popoverTriggerLabel:l.intl.formatMessage({id:"txUjQq",defaultMessage:"Size"}),loggingLabel:"Size"}],t.SEARCH_LIST_VIEW_COLUMNS=[{sortField:o.SortField.FILENAME,label:n,popoverTriggerLabel:n,isLocked:!0,isSortDisabled:!0},{sortField:o.SortField.MODIFIED,label:l.intl.formatMessage({id:"GaUyyL",defaultMessage:"Modified"}),popoverTriggerLabel:l.intl.formatMessage({id:"GaUyyL",defaultMessage:"Modified"}),loggingLabel:"Modified",isLocked:!0,isSortDisabled:!0},{sortField:o.SortField.SIZE,label:l.intl.formatMessage({id:"txUjQq",defaultMessage:"Size"}),popoverTriggerLabel:l.intl.formatMessage({id:"txUjQq",defaultMessage:"Size"}),loggingLabel:"Size",isLocked:!0,isSortDisabled:!0}],t.SEARCH_LIST_VIEW_SORT_ENABLED_COLUMNS=[{sortField:o.SortField.FILENAME,label:n,popoverTriggerLabel:n,isLocked:!0,isSortDisabled:!0},{sortField:o.SortField.RELEVANCE,label:l.intl.formatMessage({id:"3LcPUk",defaultMessage:"Relevance"}),popoverTriggerLabel:l.intl.formatMessage({id:"3LcPUk",defaultMessage:"Relevance"}),loggingLabel:"Relevance",isLocked:!1,isSortDisabled:!1},{sortField:o.SortField.SIZE,label:l.intl.formatMessage({id:"txUjQq",defaultMessage:"Size"}),popoverTriggerLabel:l.intl.formatMessage({id:"txUjQq",defaultMessage:"Size"}),loggingLabel:"Size",isLocked:!0,isSortDisabled:!0},{sortField:o.SortField.MODIFIED,label:l.intl.formatMessage({id:"QqPUpX",defaultMessage:"Last modified"}),popoverTriggerLabel:l.intl.formatMessage({id:"QqPUpX",defaultMessage:"Last modified"}),loggingLabel:"Last modified",isLocked:!1,isSortDisabled:!1}],t.SEARCH_GRID_VIEW_SORT_ENABLED_COLUMNS=[{sortField:o.SortField.RELEVANCE,label:l.intl.formatMessage({id:"3LcPUk",defaultMessage:"Relevance"}),popoverTriggerLabel:l.intl.formatMessage({id:"3LcPUk",defaultMessage:"Relevance"}),loggingLabel:"Relevance",isLocked:!1,isSortDisabled:!1},{sortField:o.SortField.MODIFIED,label:l.intl.formatMessage({id:"QqPUpX",defaultMessage:"Last modified"}),popoverTriggerLabel:l.intl.formatMessage({id:"QqPUpX",defaultMessage:"Last modified"}),loggingLabel:"Last modified",isLocked:!1,isSortDisabled:!1}],t.SEARCH_LIST_VIEW_COLUMNS_DELETED=[{sortField:o.SortField.FILENAME,label:n,popoverTriggerLabel:n,isLocked:!0,isSortDisabled:!0},{sortField:o.SortField.MODIFIED,label:l.intl.formatMessage({id:"RBvabN",defaultMessage:"Deleted"}),popoverTriggerLabel:l.intl.formatMessage({id:"RBvabN",defaultMessage:"Deleted"}),loggingLabel:"Deleted",isLocked:!0,isSortDisabled:!0}],t.FilesViewTileGridConstants={NUM_THRESHOLD_ROWS:10,SCROLL_DELTA_THRESHOLD:1},t.AllNewFolderCreationStates=[a.NewFolderCreationState.CREATE_FOLDER_INACTIVE,a.NewFolderCreationState.PENDING_INPUT,a.NewFolderCreationState.SAVING_INPUT],t.AllRenameStates=[a.RenameState.PENDING_INPUT,a.RenameState.SAVING_INPUT],t.AllViewTypes=[r.ViewType.Grid,r.ViewType.LargeGrid,r.ViewType.List,r.ViewType.CondensedList,r.ViewType.SmallGrid],t.AllDropTargetHighlightModes=[a.DropTargetHighlightMode.NONE,a.DropTargetHighlightMode.ALL_FOLDERS,a.DropTargetHighlightMode.NONSHARED_FOLDERS,a.DropTargetHighlightMode.NONSHARED_NONTEAM_FOLDERS],t.AllSortFields=[o.SortField.FILENAME,o.SortField.MODIFIED,o.SortField.CATEGORY,o.SortField.EXTENSION,o.SortField.SIZE,o.SortField.SHARED_WITH,o.SortField.SYNC_SETTING,o.SortField.FILE_COUNTS,o.SortField.TAGS],t.SortIsFilename=[o.SortField.FILENAME,o.SortField.CATEGORY,o.SortField.EXTENSION,o.SortField.SHARED_WITH,o.SortField.SYNC_SETTING],t.AllLoadingStates=[a.LoadingState.LOADED,a.LoadingState.LOADING_FIRST_PAGE,a.LoadingState.LOADING_REMAINING_PAGES,a.LoadingState.LOAD_ERROR],t.AllSortDirections=[o.SortDirection.ASCENDING,o.SortDirection.DESCENDING],t.ViewTypeThumbnailSizes={[r.ViewType.Grid]:256,[r.ViewType.LargeGrid]:512,[r.ViewType.List]:32,[r.ViewType.SmallGrid]:128},t.ViewTypeGridSizes={[r.ViewType.Grid]:160,[r.ViewType.LargeGrid]:480,[r.ViewType.List]:0,[r.ViewType.SmallGrid]:80},t.CulledListConstants={ITEM_ROW_HEIGHT_PX:46,MAESTRO_ITEM_ROW_HEIGHT_PX:57,SEARCH_ROW_HEIGHT_PX:53,MAESTRO_SEARCH_ROW_HEIGHT_PX:66,DEFAULT_HEADER_HEIGHT_PX:142,ITEM_BUFFER_SIZE:5},t.OverflowMenuConstants={MENU_ITEM_HEIGHT_PX:32,MENU_MARGIN_PX:8,MENU_POPOVER_ITEM_GROUP_SEPARATOR_HEIGHT_PX:17},t.VIEW_TYPE_COOKIE_NAME="browse_view_type",t.VIEW_TYPE_GLOBAL_SCOPE="*",t.VIEW_TYPE_SCOPE_TEXT_SEARCH=":search/text",t.VIEW_TYPE_SCOPE_IMAGE_SEARCH=":search/image",t.IMAGE_THUMBNAIL_EXTENSIONS=["3fr","arw","bmp","cr2","crw","dcr","dcs","dng","erf","gif","heic","j2c","j2k","jp2","jpc","jpeg","jpf","jpg","jpg2","jpm","jpx","kdc","mef","mos","mrw","nef","nrw","orf","pef","png","ppm","psd","r3d","raf","rw2","rwl","sr2","svg","svgz","tga","tif","tiff","wbmp","web","webp","x3f","ai","eps","otf","ttf","3gp","3gpp","3gpp2","asf","avi","dv","flv","m2t","m4v","mkv","mov","mp4","mpeg","mpg","mts","mxf","oggtheora","ogv","rm","ts","vob","webm","wmv","indd"],t.defaultViewTypes={[t.VIEW_TYPE_GLOBAL_SCOPE]:r.ViewType.List,[t.VIEW_TYPE_SCOPE_TEXT_SEARCH]:r.ViewType.List,[t.VIEW_TYPE_SCOPE_IMAGE_SEARCH]:r.ViewType.LargeGrid}})),define("metaserver/static/js/modules/clean/react/files_view/contexts/callback_context",["require","exports","tslib","react"],(function(e,t,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilesViewCallbackContextProvider=t.FilesViewCallbackContext=void 0,s=i.__importStar(s),t.FilesViewCallbackContext=s.createContext(void 0),t.FilesViewCallbackContextProvider=({props:{onDelete:e,onShowRename:i,onNewFolderSubmit:a,onNewFolderCancel:o,onRenameSubmit:r,onRenameCancel:l,onSetClipboard:n,onPasteFromClipboard:d,onSwitchViewType:c,onColumnsChanged:u,onCanDisplayFolderSizesChanged:g,onAddFileJumpKeyCode:_,onResetFileJump:m,onShowShare:h,onPresentInZoom:p,onLocationLinkClick:f,onNavigateToFileOrFolder:T,onNavigateToParentFolder:E,onOpenFileSharedWithMe:S,onOpenPaper:b,onSelectionChange:v,onSortChange:w,onStarClick:I,onComponentTTI:O,onFocusSearchBar:L},children:y})=>{const F=s.useMemo(()=>({onDelete:e,onShowRename:i,onNewFolderSubmit:a,onNewFolderCancel:o,onRenameSubmit:r,onRenameCancel:l,onSetClipboard:n,onPasteFromClipboard:d,onSwitchViewType:c,onColumnsChanged:u,onCanDisplayFolderSizesChanged:g,onAddFileJumpKeyCode:_,onResetFileJump:m,onShowShare:h,onPresentInZoom:p,onLocationLinkClick:f,onNavigateToFileOrFolder:T,onNavigateToParentFolder:E,onOpenFileSharedWithMe:S,onOpenPaper:b,onSelectionChange:v,onSortChange:w,onStarClick:I,onComponentTTI:O,onFocusSearchBar:L}),[e,i,a,o,r,l,n,d,c,u,g,_,m,h,p,f,T,E,S,b,v,w,I,O,L]);return s.createElement(t.FilesViewCallbackContext.Provider,{value:F},y)},t.FilesViewCallbackContextProvider.displayName="FilesViewCallbackContextProvider"})),define("metaserver/static/js/modules/clean/react/files_view/contexts/file_thumb_store",["require","exports","tslib","react","metaserver/static/js/modules/clean/photos/thumb_loading/buffered_thumb_store","metaserver/static/js/modules/clean/photos/thumb_loading/generic_thumb_store","metaserver/static/js/modules/clean/react/files_view/view_type","metaserver/static/js/modules/clean/react/browse/models","metaserver/static/js/modules/clean/react/files_view/files_view_hooks","metaserver/static/js/modules/clean/react/icon/file_folder_icon","metaserver/static/js/modules/clean/react/files_view/constants"],(function(e,t,i,s,a,o,r,l,n,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.withThumbStore=t.ThumbStoreContext=t.ThumbStoreProvider=void 0,s=i.__importDefault(s),t.ThumbStoreProvider=({shouldPrewarm:e,path:i,children:u,items:g})=>{const _=n.useIsPostTTI(),m=s.default.useMemo(()=>_?new o.GenericThumbStore:new a.BufferedThumbStore,[i]);return s.default.useEffect(()=>{if(!e)return;const t=[];return null==g||g.slice(0,100).forEach(e=>{if(e instanceof l.File||e instanceof l.FileSharedWithMe){const i=d.getThumbnailUrlForItem(e.thumbnail_url_tmpl,c.ViewTypeThumbnailSizes[r.ViewType.Grid]);if(i){const e=m.bind_url(i,{onSuccess:()=>{}});e&&t.push(e)}}}),()=>t.forEach(e=>m.unbind_url(e))},[i,g,m,e]),s.default.createElement(t.ThumbStoreContext.Provider,{value:m},u)},t.ThumbStoreProvider.displayName="ThumbStoreProvider",t.ThumbStoreContext=s.default.createContext(new o.GenericThumbStore),t.withThumbStore=e=>i=>s.default.createElement(t.ThumbStoreContext.Consumer,null,t=>s.default.createElement(e,Object.assign({},i,{thumbStore:t})))})),define("metaserver/static/js/modules/clean/react/files_view/drag_drop/drag_and_drop",["require","exports","metaserver/static/js/modules/clean/react/browse/models","metaserver/static/js/modules/clean/react/files_view/util","metaserver/static/js/modules/clean/react/browse/data/helpers"],(function(e,t,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onFileDragEnterItem=t.cleanupExternalDragHandler=t.setupExternalDragHandler=void 0;const o=new s.ScopedEventHandlers(document);t.setupExternalDragHandler=function(e,t,i,s,a,r,l){o.add(e,"dragenter",e=>{(t()||i())&&!e.target.closest(a)&&r()&&(l(null),s())})},t.cleanupExternalDragHandler=function(e){o.remove(e,"dragenter")},t.onFileDragEnterItem=function(e,t,s,o,r,l,n,d){if(!t&&!s)return;if(e.is_dir&&!(o&&s)&&!a.isBackupFolder(e)){if(r)return;const t=l.isCurrentPathWriteable()&&!i.File.isReadOnlySharedFolder(e);n(e),d({path:e.fq_path,hasPermissionToUploadToFolder:t,isMovingIntoVault:Boolean(e.is_in_vault_folder)})}else n(null),d()}})),define("metaserver/static/js/modules/clean/react/files_view/drag_drop/drag_to_select",["require","exports","tslib","react","metaserver/static/js/modules/clean/react/components/css","metaserver/static/js/modules/clean/react/files_view/types","metaserver/static/js/modules/clean/react/selectable_list","lodash"],(function(e,t,i,s,a,o,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DragToSelectController=t.shouldMouseDownInitiateDragToSelect=t.isItemInSelectArea=void 0,s=i.__importDefault(s),t.isItemInSelectArea=(e,t)=>!(e.top+e.height<t.top||e.top>t.top+t.height||e.left+e.width<t.left||e.left>t.left+t.width),t.shouldMouseDownInitiateDragToSelect=(e,i,s,a)=>!d(e)&&(e.target===e.currentTarget||(null==s||!s.selected||!s.selected.some(e=>a[e]&&t.isItemInSelectArea(a[e],Object.assign(Object.assign({},i),{height:0,width:0})))));const n=l.throttle((function(e,i,s,a,l){Object.keys(e).forEach(n=>{t.isItemInSelectArea(e[n],i)?(null==l?void 0:l.selected.has(n))||s(n,r.SelectOptions.DEFAULT,o.FilesViewActionSource.DRAG_TO_SELECT):(null==l?void 0:l.selected.has(n))&&a(n,!1,o.FilesViewActionSource.DRAG_TO_SELECT)})}),25),d=e=>{let t=e.target;for(;t instanceof Node&&t!==e.currentTarget;){if(!0===t.draggable)return!0;t=t.parentElement}return!1};t.DragToSelectController=a.requireCssWithComponent(e=>{const[i,a]=s.default.useState(!1),[r,d]=s.default.useState(!1),[c,u]=s.default.useState(0),g=s.default.useRef(null),_=s.default.useRef({}),[m,h]=s.default.useState({top:0,left:0}),[p,f]=s.default.useState({top:0,left:0,width:0,height:0});s.default.useEffect(()=>{const e=l.throttle(T,8);return r&&(window.document.addEventListener("mouseup",E),window.document.addEventListener("mousemove",e)),()=>{window.document.removeEventListener("mousemove",e),window.document.removeEventListener("mouseup",E)}},[r,i]),s.default.useEffect(()=>(window.document.addEventListener("click",S,!0),()=>{window.document.removeEventListener("click",S,!0)}),[c]),s.default.useEffect(()=>{i&&n(_.current,p,e.handleSelect,e.handleDeselect,e.selection)},[i,p,e.selection]);const T=t=>{var s;if(r){if(1!==t.buttons)return d(!1),void a(!1);const r=null===(s=g.current)||void 0===s?void 0:s.getBoundingClientRect();let l=t.clientX-((null==r?void 0:r.left)||0),n=t.clientY-((null==r?void 0:r.top)||0);n<0&&(n=0),l<0&&(l=0),r&&l-10>r.width&&(l=r.width-10),r&&n-20>r.height&&(n=r.height-20);const c={top:Math.min(m.top,n),left:Math.min(m.left,l),height:Math.abs(m.top-n),width:Math.abs(m.left-l)};!i&&c.width<=5&&c.height<=5||(i?i&&f(c):(t.preventDefault(),e.updateSelection([],o.FilesViewActionSource.DRAG_TO_SELECT,!0),f(c),a(!0)))}},E=e=>{r&&(i&&u(Date.now()),a(!1),d(!1),f({top:0,left:0,width:0,height:0}),h({top:0,left:0}),e.preventDefault())},S=e=>{Date.now()-c<50&&e.preventDefault(),window.document.removeEventListener("click",S,!0)};if(!e.isDragToSelectEnabled){const t=(e,t)=>{};return s.default.createElement("div",null,e.children({registerSelectableItem:t}))}return s.default.createElement("div",{className:"files-view_drag-to-select",onMouseDown:i=>{var s;if(!i.isDefaultPrevented()&&!r&&1===i.buttons){const a=null===(s=g.current)||void 0===s?void 0:s.getBoundingClientRect(),o=i.clientX-((null==a?void 0:a.left)||0),r=i.clientY-((null==a?void 0:a.top)||0);t.shouldMouseDownInitiateDragToSelect(i,{top:r,left:o},e.selection,_.current)&&(h({top:r,left:o}),f({top:r,left:o,width:0,height:0}),d(!0))}},ref:g},s.default.createElement("div",{className:"files-view_drag-to-select-removal"},e.children({registerSelectableItem:(e,t)=>{var i;const s=t.top+40,a=null===(i=g.current)||void 0===i?void 0:i.getBoundingClientRect();if(a){const i=t.width||a.width;_.current[e]={top:s,width:i,left:t.left,height:t.height}}}})),i&&s.default.createElement("div",{className:"files-view_select-box",style:{top:p.top+"px",left:p.left+"px",width:p.width+"px",height:p.height+"px"}}))},["/static/css/files_view/drag_to_select-vfl1pMR5V.css"])})),define("metaserver/static/js/modules/clean/react/files_view/file_jump",["require","exports","tslib","ts-key-enum","metaserver/static/js/modules/core/dom"],(function(e,t,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleKeyPress=void 0,a=i.__importStar(a);const o=["/","\\",":","?","*","<",">","|"];let r=null;t.handleKeyPress=function(e,t,i,l){const n=e.key;Object.values(s.Key).includes(n)||o.includes(n)||!document.activeElement.closest(".brws-checkbox-cell")&&a.focus_in_input()||e.metaKey||e.altKey||e.altGraphKey||e.ctrlKey||" "===n&&!t()||(" "===n&&t()&&e.preventDefault(),i(n),null!=r&&clearTimeout(r),r=setTimeout(()=>{l()},1e3))}})),define("metaserver/static/js/modules/clean/react/files_view/file_list_empty_folder_table",["require","exports","tslib","immutable","lodash","react","dig-experimental/table/table","dig-components/combinations","metaserver/static/js/modules/clean/react/files_view/keyboard_shortcuts","metaserver/static/js/modules/clean/react/files_view/view_type"],(function(e,t,i,s,a,o,r,l,n,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyFolderTable=void 0,s=i.__importStar(s),a=i.__importStar(a),o=i.__importDefault(o);t.EmptyFolderTable=({subtitle:e,subtitleLink:t,subtitleOnClick:i,numRowsAbove:c=2,totalRows:u=14,title:g,onTTI:_,onFocusSearchBar:m=a.noop,onNavigateToParentFolder:h=a.noop,onOpenKeyboardShortcutModal:p=a.noop,onPasteFromClipboard:f=a.noop})=>{const T=o.default.useRef(null);o.default.useEffect(()=>(null==_||_(),n.setupFilesViewKeyboardShortcuts({viewType:d.ViewType.List,getIsGlobalEvent:n.generateGetIsGlobalEventForRef(T),getIsItemEvent:()=>!1,getSelectedFiles:()=>s.OrderedMap(),isCurrentPathWriteable:()=>!1,selectAllAction:a.noop,deselectAllAction:a.noop,onCopyToClipboard:a.noop,onCutToClipboard:a.noop,onDelete:a.noop,onFocusSearchBar:m,onNavigateToFileOrFolder:a.noop,onNavigateToParentFolder:h,onPasteFromClipboard:f,onShowRename:a.noop,scope:"EmptyFolderTable",onShowHelpMenu:()=>p()}),()=>{n.resetFilesViewKeyboardShortcuts("EmptyFolderTable")}),[]);const E=[];for(let e=0;e<c;e++)E.push(o.default.createElement(r.Table.Row,{key:-e-1},o.default.createElement(r.Table.Cell,null)));const S=[],b=Math.max(u-c-1,0);for(let e=0;e<b;e++)S.push(o.default.createElement(r.Table.Row,{key:e+1},o.default.createElement(r.Table.Cell,null)));const v=o.default.createElement("h3",{className:"u-font-strong empty-folder-table-title"},g);return o.default.createElement("div",{className:"empty-folder-container"},o.default.createElement(r.Table,{"aria-atomic":"true","aria-live":"polite"},o.default.createElement(r.Table.Header,null),o.default.createElement(r.Table.Body,null,E,o.default.createElement(r.Table.Row,{key:0},o.default.createElement(r.Table.Cell,null,o.default.createElement(l.LabelGroup,{withText:v,withSubtext:e&&t?o.default.createElement("a",{className:"empty-folder-table-subtitle empty-folder-table-link",href:t,onClick:i},e):e?o.default.createElement("span",{className:"empty-folder-table-subtitle"},e):void 0}))),S)))},t.EmptyFolderTable.displayName="EmptyFolderTable"})),define("metaserver/static/js/modules/clean/react/files_view/file_list_utils",["require","exports","metaserver/static/js/modules/clean/filetypes","metaserver/static/js/modules/clean/react/files_view/types","metaserver/static/js/modules/clean/react/browse/models","metaserver/static/js/modules/clean/sharing/browse_exports"],(function(e,t,i,s,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSharingDisabledForFile=t.canFileBeHighlightedDropTarget=void 0,t.canFileBeHighlightedDropTarget=function({file:e,dropTargetHighlightMode:t}){if(t===s.DropTargetHighlightMode.NONE)return!1;if(!e.is_dir)return!1;if(a.File.isReadOnlySharedFolder(e))return!1;if(e.isDeleted)return!1;switch(t){case s.DropTargetHighlightMode.ALL_FOLDERS:return!0;case s.DropTargetHighlightMode.NONSHARED_FOLDERS:return e.type!==i.FileTypes.SHARED_FOLDER;case s.DropTargetHighlightMode.NONSHARED_NONTEAM_FOLDERS:return![i.FileTypes.SHARED_FOLDER,i.FileTypes.TEAM_SHARED_FOLDER].includes(e.type)}return!1},t.isSharingDisabledForFile=function({context:e,file:t,user:s,expVaultEnableViewOnlySharing:r=!1}){const l=t.per_node_metadata,n=!!((null==l?void 0:l.link_node)||(null==l?void 0:l.suppress_ns_partition)||(null==l?void 0:l.suppress_shared_link));return t.isDeleted||t.is_dir&&o.shouldUsePublicFolderSharing(e.config,t.fq_path)||a.File.isTeamMemberFolder(t)||!a.File.canViewFileMembers(t,e)||e.isInsideVaultFolder&&!r||t.type===i.FileTypes.VAULT_FOLDER||t.type===i.FileTypes.SANDBOX||n}})),define("metaserver/static/js/modules/clean/react/files_view/file_thumbnail",["require","exports","tslib","classnames","react","spectrum/file_icon/get_extension","metaserver/static/js/modules/clean/react/files_view/constants","metaserver/static/js/modules/clean/react/files_view/view_type","metaserver/static/js/modules/clean/react/icon/file_folder_icon","metaserver/static/js/modules/clean/react/icon/lock_badge","metaserver/static/js/modules/clean/user_education/react/user_education_effect","metaserver/static/js/modules/clean/react/files_view/contexts/file_thumb_store"],(function(e,t,i,s,a,o,r,l,n,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileThumbnail=t.FileThumbnailComponentForTests=void 0,s=i.__importDefault(s),a=i.__importDefault(a);class g extends a.default.PureComponent{constructor(e){super(e),this._thumbRequestId=null,this.handleThumbnailError=()=>{this.setState({thumbnailSrc:null})};const{thumbStore:t,file:{thumbnail_url_tmpl:i}}=e;this.state={thumbnailSrc:i?t.get_thumb(i):null}}componentDidMount(){this.fetchThumbnail(this.props)}UNSAFE_componentWillReceiveProps(e){e.file.thumbnail_url_tmpl!==this.props.file.thumbnail_url_tmpl&&(this.unbindThumbnailIfNeeded(),this.fetchThumbnail(e))}componentWillUnmount(){this.unbindThumbnailIfNeeded()}fetchThumbnail({file:e,thumbStore:t}){const i=e.fq_path||e.filename||"",s=o.getExtension(i);if(!s||!r.IMAGE_THUMBNAIL_EXTENSIONS.includes(s))return;const a=n.getThumbnailUrlForItem(e.thumbnail_url_tmpl,this.props.thumbnailSize?this.props.thumbnailSize:r.ViewTypeThumbnailSizes[l.ViewType.List]);a&&(this._thumbRequestId=t.bind_url(a,{onSuccess:()=>{this.setState({thumbnailSrc:t.get_thumb(a)})},onError:()=>{this.handleThumbnailError()}}))}unbindThumbnailIfNeeded(){const{thumbStore:e}=this.props;this._thumbRequestId&&(e.unbind_url(this._thumbRequestId),this._thumbRequestId=null),this.setState({thumbnailSrc:null})}render(){const{file:e,showCDMUserEducationEffects:t,iconSize:i}=this.props,{thumbnailSrc:o}=this.state,r=e.fq_path||e.filename;return o?a.default.createElement(d.LockBadge,{file:this.props.file,variant:"preview-small"},a.default.createElement("img",{alt:r,draggable:!1,className:s.default("brws-file-name-cell-icon","brws-file-name-cell-thumb"),src:o,onError:this.handleThumbnailError})):a.default.createElement(_,{file:e,showCDMUserEducationEffects:t,iconSize:i})}}t.FileThumbnailComponentForTests=g,g.displayName="FileThumbnailComponentForTests",t.FileThumbnail=u.withThumbStore(g);const _=({file:e,showCDMUserEducationEffects:t,iconSize:i})=>{const s=i?{height:i.toString(),width:i.toString()}:{},o=a.default.createElement(n.FileOrFolderIcon,Object.assign({className:"brws-file-name-cell-icon",file:e,showPreview:!1},s));return t?a.default.createElement(c.UserEducationEffect,{containerName:"FileItemRow",name:"TMFIcon",useSpan:!0},o):o};_.displayName="FileThumbnailFallback"})),define("metaserver/static/js/modules/clean/react/files_view/keyboard_shortcuts",["require","exports","tslib","keymaster","react-dom","metaserver/static/js/modules/clean/react/browse/action_logger","metaserver/static/js/modules/clean/react/files_view/file_jump","metaserver/static/js/modules/clean/react/files_view/view_type","metaserver/static/js/modules/clean/react/files_view/util","metaserver/static/js/modules/clean/undo","metaserver/static/js/modules/core/browser_detection","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/core/notify"],(function(e,t,i,s,a,o,r,l,n,d,c,u,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetFileJumpKeyboardShortcuts=t.setupFileJumpKeyboardShortcuts=t.setupFilesViewKeyboardShortcuts=t.getActionsAndAttachLogging=t.resetFilesViewKeyboardShortcuts=t.generateGetIsGlobalEventForRef=t.generateGetIsGlobalEvent=t.FILES_VIEW_TILE_GRID_SHORTCUTS=t.FILES_VIEW_LIST_SHORTCUTS=t.FILES_VIEW_SHORTCUTS=void 0,s=i.__importDefault(s),a=i.__importStar(a),r=i.__importStar(r),d=i.__importStar(d),c=i.__importStar(c),t.FILES_VIEW_SHORTCUTS=[{key:u.intl.formatMessage({id:"kOb587",defaultMessage:"/"}),desc:u.intl.formatMessage({id:"vOBkFB",defaultMessage:"Search"})},{windowsKey:u.intl.formatMessage({id:"JD6thv",defaultMessage:"Ctrl + a"}),macKey:u.intl.formatMessage({id:"vXQEej",defaultMessage:"⌘ + a"}),desc:u.intl.formatMessage({id:"n7drWm",defaultMessage:"Select all files"})},{windowsKey:u.intl.formatMessage({id:"yY9fAj",defaultMessage:"Esc"}),macKey:u.intl.formatMessage({id:"yIq4Am",defaultMessage:"esc"}),desc:u.intl.formatMessage({id:"m7zp3J",defaultMessage:"Deselect all files"})},{windowsKey:u.intl.formatMessage({id:"BmNZ7+",defaultMessage:"Ctrl + c"}),macKey:u.intl.formatMessage({id:"L/3I1a",defaultMessage:"⌘ + c"}),desc:u.intl.formatMessage({id:"jD02CF",defaultMessage:"Copy selected file(s)"})},{windowsKey:u.intl.formatMessage({id:"TeH7ne",defaultMessage:"Ctrl + x"}),macKey:u.intl.formatMessage({id:"Hjoc2x",defaultMessage:"⌘ + x"}),desc:u.intl.formatMessage({id:"JvfueH",defaultMessage:"Cut selected file(s)"})},{windowsKey:u.intl.formatMessage({id:"pApXZD",defaultMessage:"Ctrl + v"}),macKey:u.intl.formatMessage({id:"1MiQRb",defaultMessage:"⌘ + v"}),desc:u.intl.formatMessage({id:"ORvNm9",defaultMessage:"Paste selected file(s) into the current folder"})},{key:u.intl.formatMessage({id:"u3d9dU",defaultMessage:"F2"}),desc:u.intl.formatMessage({id:"GrOPDo",defaultMessage:"Rename selected file"})},{windowsKey:u.intl.formatMessage({id:"kHlg2I",defaultMessage:"Delete"}),macKey:u.intl.formatMessage({id:"ZZU2Yr",defaultMessage:"delete"}),desc:u.intl.formatMessage({id:"45XRF8",defaultMessage:"Delete selected file(s)"})},{windowsKey:u.intl.formatMessage({id:"8X8aMD",defaultMessage:"Ctrl + z"}),macKey:u.intl.formatMessage({id:"10+RMZ",defaultMessage:"⌘ + z"}),desc:u.intl.formatMessage({id:"HGnEOI",defaultMessage:"Undo recent move/copy/rename/delete"})},{key:u.intl.formatMessage({id:"YQJt5v",defaultMessage:"?"}),desc:u.intl.formatMessage({id:"mFXmY0",defaultMessage:"Show keyboard shortcuts"})}],t.FILES_VIEW_LIST_SHORTCUTS=[{key:u.intl.formatMessage({id:"lkVLik",defaultMessage:"↑"}),desc:u.intl.formatMessage({id:"Riu+zT",defaultMessage:"Select previous file (hold shift to select range)"})},{key:u.intl.formatMessage({id:"5ojTma",defaultMessage:"↓"}),desc:u.intl.formatMessage({id:"li5upG",defaultMessage:"Select next file (hold shift to select range)"})},{key:u.intl.formatMessage({id:"u6AlvH",defaultMessage:"←"}),desc:u.intl.formatMessage({id:"rJHa1d",defaultMessage:"Go up a folder"})},{key:u.intl.formatMessage({id:"LJ+WGg",defaultMessage:"→"}),desc:u.intl.formatMessage({id:"+WMBQW",defaultMessage:"Open folder"})},...t.FILES_VIEW_SHORTCUTS],t.FILES_VIEW_TILE_GRID_SHORTCUTS=[{key:u.intl.formatMessage({id:"lkVLik",defaultMessage:"↑"}),desc:u.intl.formatMessage({id:"Xg+zFf",defaultMessage:"Select file in previous row (hold shift to select range)"})},{key:u.intl.formatMessage({id:"5ojTma",defaultMessage:"↓"}),desc:u.intl.formatMessage({id:"erVlBC",defaultMessage:"Select file in next row (hold shift to select range)"})},{key:u.intl.formatMessage({id:"u6AlvH",defaultMessage:"←"}),desc:u.intl.formatMessage({id:"Riu+zT",defaultMessage:"Select previous file (hold shift to select range)"})},{key:u.intl.formatMessage({id:"LJ+WGg",defaultMessage:"→"}),desc:u.intl.formatMessage({id:"li5upG",defaultMessage:"Select next file (hold shift to select range)"})},...t.FILES_VIEW_SHORTCUTS];let _="";const m=new n.ScopedEventHandlers(document);function h(e,t){return i=>{e(i)&&(i.preventDefault(),"function"==typeof t&&t(i))}}function p({user:e,viewType:t,getSelectedFiles:i,isCurrentPathWriteable:s,onShowHelpMenu:a,onDelete:r,onShowRename:l,onFocusSearchBar:n,onNavigateToFileOrFolder:c,onNavigateToParentFolder:_,selectAllAction:m,onCopyToClipboard:h,onCutToClipboard:p,onPasteFromClipboard:f,deselectAllAction:T}){const E=()=>{const e=i(),t=e.some(e=>e.read_only);if(1===e.size)if(s()&&!t){const t=e.first();t.isDeleted?g.Notify.error(u.intl.formatMessage({id:"CCUrto",defaultMessage:"Deleted files can’t be renamed."})):l(t)}else g.Notify.warning(u.intl.formatMessage({id:"jXim1P",defaultMessage:"You don’t have permission to rename files in this folder."}))},S=()=>{const e=i();e.size&&r(e)},b=()=>{d.performUndo()},v=()=>{const e=i();1===e.size&&c(e.first())},w=()=>{const e=i(),t=e.first();1===e.size&&t.is_dir&&c(t)},I=(i,s)=>{o.logKeyboardShortcutUsage({user_id:e?e.id:null,view_type:t,keyboard_shortcut_type:i}),s()};return{renameFile:()=>{I("rename",E)},focusSearchBar:()=>{I("search",n)},showHelpMenu:()=>{I("help",a)},selectAll:()=>{I("select-all",m)},copyToClipboard:()=>{I("copy",h)},cutToClipboard:()=>{I("cut",p)},deleteFiles:()=>{I("delete",S)},pasteFromClipboard:()=>{I("paste",f)},undoAction:()=>{I("undo",b)},deselectFiles:()=>{I("deselect",T)},navigateToFileOrFolder:()=>{I("navigate-file-folder",v)},navigateToFolder:()=>{I("navigate-folder",w)},navigateToParent:()=>{I("navigate-parent",_)}}}t.generateGetIsGlobalEvent=function(e){return t=>!document.activeElement||document.activeElement===document.body||t.target instanceof Element&&a.findDOMNode(e).contains(t.target)},t.generateGetIsGlobalEventForRef=function(e){return t=>{var i;return!document.activeElement||document.activeElement===document.body||t.target instanceof Element&&(null===(i=e.current)||void 0===i?void 0:i.contains(t.target))||!1}},t.resetFilesViewKeyboardShortcuts=function(e){var t;t=e,s.default.clearScope(t),s.default.setScope(_),m.remove(e,"keydown"),m.remove(e,"keyup")},t.getActionsAndAttachLogging=p,t.setupFilesViewKeyboardShortcuts=function(e){const{scope:t,getIsItemEvent:i,getIsGlobalEvent:a}=e;_=s.default.getScope(),_!==t&&s.default.setScope(t);const o=p(e);s.default("f2",t,h(i,o.renameFile)),s.default("/",t,h(a,o.focusSearchBar)),s.default("shift+/",t,h(a,o.showHelpMenu)),s.default("escape",t,h(a,o.deselectFiles)),c.mac?(s.default("command+a",t,h(a,o.selectAll)),s.default("command+c",t,h(i,o.copyToClipboard)),s.default("backspace",t,h(i,o.deleteFiles)),s.default("command+v",t,h(a,o.pasteFromClipboard)),s.default("command+x",t,h(i,o.cutToClipboard)),s.default("command+z",t,h(a,o.undoAction))):(s.default("ctrl+a",t,h(a,o.selectAll)),s.default("ctrl+c",t,h(i,o.copyToClipboard)),s.default("delete",t,h(i,o.deleteFiles)),s.default("ctrl+v",t,h(a,o.pasteFromClipboard)),s.default("ctrl+x",t,h(i,o.cutToClipboard)),s.default("ctrl+z",t,h(a,o.undoAction))),e.viewType===l.ViewType.List&&(s.default("right",t,h(i,o.navigateToFolder)),s.default("left",t,h(a,o.navigateToParent)))},t.setupFileJumpKeyboardShortcuts=function({scope:e,getIsFileJumping:t,onAddFileJumpKeyCode:i,onResetFileJump:a}){m.add(e,"keypress",o=>{s.default.getScope()===e&&r.handleKeyPress(o,t,i,a)})},t.resetFileJumpKeyboardShortcuts=function(e){m.remove(e,"keypress")}})),define("metaserver/static/js/modules/clean/react/files_view/overflow_menu",["require","exports","tslib","react","classnames","dig-components/buttons","dig-components/icons","dig-components/icons/src","dig-components/menu","metaserver/static/js/modules/clean/react/async/loadable","metaserver/static/js/modules/core/browser_detection","metaserver/static/js/modules/core/i18n"],(function(e,t,i,s,a,o,r,l,n,d,c,u){"use strict";var g;Object.defineProperty(t,"__esModule",{value:!0}),t.FilesViewOverflowMenu=t.OverflowMenuSize=t.AsyncFilesViewMobileOverflowMenu=void 0,s=i.__importDefault(s),a=i.__importDefault(a),l=i.__importStar(l),t.AsyncFilesViewMobileOverflowMenu=d.Loadable({loader:()=>new Promise((t,i)=>{e(["metaserver/static/js/modules/clean/react/files_view/mobile_overflow_menu"],t,i)}).then(i.__importStar).then(({FilesViewMobileOverflowMenu:e})=>e)}),(function(e){e[e.Normal=0]="Normal",e[e.Small=1]="Small"})(g=t.OverflowMenuSize||(t.OverflowMenuSize={}));class _ extends s.default.Component{constructor(e){super(e),this.handleSelection=e=>{e.performAction()},this.handleMenuToggle=({isOpen:e})=>{if(e&&this.props.onMenuOpen&&this.props.onMenuOpen(),_.isDynamicProps(this.props)&&e){const e=this.props.getOverflowMenuActions(this.props.file,!!this.props.canDisplayFolderSizes);this.setState({actionSection:e})}},this.handlePreventMouseDown=e=>{e.preventDefault(),e.stopPropagation()},this.handleMobileMenuOpen=e=>t=>{this.handlePreventMouseDown(t),this.handleMenuToggle({isOpen:!0}),e()},this.handleClick=e=>t=>{this.handlePreventMouseDown(t),e({})},this.state={actionSection:_.isDynamicProps(e)?[]:e.actionSection}}render(){const{isResponsive:e,size:i,showBorders:o,ariaHidden:r}=this.props,{file:l}=_.isDynamicProps(this.props)?this.props:{},d=e&&c.is_mobile_or_tablet(),u=i===g.Small?"small":"standard";return s.default.createElement("div",{"aria-hidden":r?"true":void 0,className:"browse-overflow-menu"},d?s.default.createElement(t.AsyncFilesViewMobileOverflowMenu,{trigger:({openMobileMenu:e})=>s.default.createElement(m,{onClick:this.handleMobileMenuOpen(e),showBorders:o,size:u}),file:l,actionSection:this.state.actionSection}):s.default.createElement(n.Menu.Wrapper,{onSelection:this.handleSelection,onToggle:this.handleMenuToggle,onClick:this.handlePreventMouseDown,onDoubleClick:this.handlePreventMouseDown,isPortaled:!1},({getTriggerProps:e,getContentProps:t,openMenu:i})=>s.default.createElement(s.default.Fragment,null,s.default.createElement(m,{triggerProps:e(),onClick:this.handleClick(i),showBorders:o,size:u,tabIndex:r?-1:0}),s.default.createElement(n.Menu.Content,Object.assign({placement:"bottom-end"},t(),{className:"browse-overflow-menu-content"}),this.state.actionSection.map((e,t)=>s.default.createElement(n.Menu.Segment,{key:`action-group-${t}`},e.map((e,t)=>s.default.createElement(n.Menu.ActionItem,{key:`${t}-${e.label}`,value:e,disabled:e.disabled,className:a.default("browse-overflow-menu-item",e.className)},e.label))))))))}}t.FilesViewOverflowMenu=_,_.isDynamicProps=e=>"file"in e,_.defaultProps={onMenuToggle:()=>{},isResponsive:!0},_.displayName="FilesViewOverflowMenu";const m=({size:e,showBorders:t,onClick:i,tabIndex:a,triggerProps:n})=>{const d=u.intl.formatMessage({id:"oeNPkV",defaultMessage:"More actions"});return s.default.createElement(o.IconButton,Object.assign({},n,{"aria-label":d,onClick:i,size:e,variant:t?"outline":"transparent",tabIndex:a}),s.default.createElement(r.UIIcon,{src:l.MoreHorizontalLine,size:e}))};m.displayName="MenuTrigger"})),define("metaserver/static/js/modules/clean/react/files_view/star",["require","exports","tslib","react","metaserver/static/js/modules/clean/react/async/loadable","metaserver/static/js/modules/clean/react/files_view/contexts/callback_context","metaserver/static/js/modules/clean/react/browse/models"],(function(e,t,i,s,a,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarContainer=void 0,s=i.__importDefault(s),t.StarContainer=a.Loadable({loader:()=>i.__awaiter(void 0,void 0,void 0,(function*(){const{idTypePairFromStarrableItem:t,itemNameFromStarrableItem:a,Star:l,StarredSource:n}=yield new Promise((t,i)=>{e(["metaserver/static/js/modules/clean/react/starred/browse_exports"],t,i)}).then(i.__importStar);return e=>{const{item:i,user:d,className:c,isReadOnly:u,tabIndex:g,starButtonClassName:_,alwaysShowUnstarred:m}=e,{id:h,type:p}=t(i),f=a(i),{onStarClick:T}=s.default.useContext(o.FilesViewCallbackContext)||{};return s.default.createElement("div",{className:c},s.default.createElement(l,{id:h,key:"star",idType:p,isDir:Boolean(i.is_dir),user:d,onStarClick:e=>{i instanceof r.File&&(null==T||T(i,e))},source:n.BROWSE,isReadOnly:u,tabIndex:g,starButtonClassName:_,alwaysShowUnstarred:m,itemName:f}))}}))})})),define("metaserver/static/js/modules/clean/react/files_view/types",["require","exports","metaserver/static/js/modules/clean/web_user_action_events"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilesViewActionSource=t.DropTargetHighlightMode=t.LoadingState=t.RenameState=t.NewFolderCreationState=t.NameInputActionSource=void 0,Object.defineProperty(t,"FilesViewActionSource",{enumerable:!0,get:function(){return i.ActionSourceValue}}),(function(e){e.ESC="ESC",e.SUBMIT="SUBMIT",e.BLUR="BLUR"})(t.NameInputActionSource||(t.NameInputActionSource={})),(function(e){e.CREATE_FOLDER_INACTIVE="CREATE_FOLDER_INACTIVE",e.PENDING_INPUT="PENDING_INPUT",e.SAVING_INPUT="SAVING_INPUT"})(t.NewFolderCreationState||(t.NewFolderCreationState={})),(function(e){e.PENDING_INPUT="pending-input",e.SAVING_INPUT="saving-input"})(t.RenameState||(t.RenameState={})),(function(e){e.LOADED="LOADED",e.LOADING_FIRST_PAGE="LOADING_FIRST_PAGE",e.LOADING_REMAINING_PAGES="LOADING_REMAINING_PAGES",e.LOAD_ERROR="LOAD_ERROR"})(t.LoadingState||(t.LoadingState={})),(function(e){e.NONE="NONE",e.ALL_FOLDERS="ALL_FOLDERS",e.NONSHARED_FOLDERS="NONSHARED_FOLDERS",e.NONSHARED_NONTEAM_FOLDERS="NONSHARED_NONTEAM_FOLDERS"})(t.DropTargetHighlightMode||(t.DropTargetHighlightMode={}))})),define("metaserver/static/js/modules/clean/react/flows/types",["require","exports","immutable","typescript/component_libraries/flows/src/common/types"],(function(e,t,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlowsMap=t.FolderActionType=t.FolderActionData=void 0,Object.defineProperty(t,"FolderActionData",{enumerable:!0,get:function(){return s.FolderActionData}}),Object.defineProperty(t,"FolderActionType",{enumerable:!0,get:function(){return s.FolderActionType}}),t.FlowsMap=function(e){return i.Map(e)}})),define("metaserver/static/js/modules/clean/react/files_view/tile_element",["require","exports","tslib","classnames","react","dig-components/controls","ts-key-enum","metaserver/static/js/modules/clean/paper_formatting_utils","metaserver/static/js/modules/clean/react/files_view/double_click","metaserver/static/js/modules/clean/react/icon/file_folder_icon","metaserver/static/js/modules/clean/react/icon/lock_badge","metaserver/static/js/modules/clean/react/files_view/tile_grid_logger","metaserver/static/js/modules/clean/user_education/react/user_education_effect","metaserver/static/js/modules/clean/react/files_view/contexts/file_thumb_store"],(function(e,t,i,s,a,o,r,l,n,d,c,u,g,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileElement=t.TileElementComponentForTests=t.TilePlaceholder=t.TileLabel=void 0,s=i.__importDefault(s),a=i.__importDefault(a),l=i.__importStar(l);const m=()=>null;t.TileLabel=({ariaLabel:e,children:t,onClick:i})=>{if(!t)return null;const s=a.default.createElement("div",{className:"tile-label","aria-hidden":"true"},t);return i?a.default.createElement("a",{onClick:i,tabIndex:-1,"aria-label":e},s):s},t.TileLabel.displayName="TileLabel",t.TilePlaceholder=({leftOffset:e,tileHeight:i,tileWidth:s,thumbNode:o,labelNode:r})=>a.default.createElement("div",{className:"tile",style:{left:e,height:i,width:s,pointerEvents:"none"}},a.default.createElement("div",{className:"tile__thumb-container",style:{height:s,width:s}},o||a.default.createElement("div",{className:"tile__preview--placeholder"})),a.default.createElement(t.TileLabel,null,r)),t.TilePlaceholder.displayName="TilePlaceholder";class h extends a.default.PureComponent{constructor(e){super(e),this.thumbRequestId=null,this.animationRequestIds=[],this.handleThumbnailError=()=>{const{onThumbnailError:e,tileIndex:t}=this.props;this.setState({thumbLoaded:!1}),e&&e(t)},this.logTileInteractive=()=>{const e=!!this.props.thumbnailUrl,t=this.state.thumbLoaded;if(this.props.onThumbnailLoad){const i=window.requestAnimationFrame(()=>{const i=window.requestAnimationFrame(()=>{this.props.onThumbnailLoad(this.props.tileIndex,e,t)});this.animationRequestIds.push(i)});this.animationRequestIds.push(i)}},this.toggleSelect=e=>{e.stopPropagation(),this.props.handleToggleSelect(e)},this.handleKeyDown=e=>{const t=e.key;e.currentTarget!==e.target||" "!==t&&t!==r.Key.Enter||(e.preventDefault(),this.props.onClick(e))},this.handleCheckboxChange=()=>{},this.state=Object.assign({thumbLoaded:h.isThumbLoaded(e)},this.calcPaperTitleState(e))}componentDidMount(){this.props.delayRenderFullTile?this.renderCompleteTileTimeout=setTimeout(()=>{this.renderCompleteTileTimeout=0,this.fetchThumbnail(this.props)},100):this.fetchThumbnail(this.props),this.logTileInteractive()}componentDidUpdate(e,t){if(!e.isFocused&&this.props.isFocused){const e=this.refs.tileContainer;e&&e.focus()}}UNSAFE_componentWillReceiveProps(e){if(e.thumbnailUrl!==this.props.thumbnailUrl&&(this.unbindThumbnailIfNeeded(),this.fetchThumbnail(e)),h.getPaperTitle(this.props)!==h.getPaperTitle(e)){const t=this.calcPaperTitleState(e);this.setState(t)}}static getPaperTitle(e){return e.paper?e.paper.title:null}calcPaperTitleState(e){return e.paper?{paperTitleParts:l.getPaperDocTitleParts(e.paper,"brws-file-name-grid-icon","brws-file-name-grid-icon-emoji",!0)}:{}}componentWillUnmount(){this.unbindThumbnailIfNeeded(),this.renderCompleteTileTimeout&&clearTimeout(this.renderCompleteTileTimeout),this.animationRequestIds.forEach(e=>{window.cancelAnimationFrame(e)}),this.animationRequestIds=[]}fetchThumbnail(e){const{thumbnailUrl:t,thumbStore:i}=e;if(t){const e=Date.now();this.thumbRequestId=i.bind_url(t,{onSuccess:()=>{this.setState({thumbLoaded:!0}),u.InfiniteTileGridLogger.logThumbRTT(Date.now()-e)},onError:()=>{this.handleThumbnailError()}})}}unbindThumbnailIfNeeded(){const{thumbStore:e}=this.props;this.thumbRequestId&&(e.unbind_url(this.thumbRequestId),this.thumbRequestId=null),this.setState({thumbLoaded:!1})}static isThumbLoaded(e){const{thumbStore:t,thumbnailUrl:i}=e;return!(!i||!t.get_thumb(i))}renderCheckbox(){let e=a.default.createElement(o.Checkbox,{className:"tile-checkbox","aria-label":this.props.checkboxAriaText,onClick:this.toggleSelect,onChange:this.handleCheckboxChange,tabIndex:this.props.checkboxTabIndex,checked:this.props.isSelected});return 0===this.props.tileIndex&&(e=a.default.createElement(g.UserEducationEffect,{containerName:"FileItemRow",name:"FirstFileSelectCheckbox"},e)),a.default.createElement("div",{key:"tile-select-checkbox",className:"tile-select-checkbox"},e)}renderActionNode(){return a.default.createElement("div",{key:"tile-action-node",className:"tile__action-button"},this.props.actionNode)}renderThumbnail(){const{thumbnailUrl:e,thumbStore:t,height:i,width:s,isSelected:o}=this.props;if(this.state.thumbLoaded){const r=t.get_thumb(e);if(r){const e=o?s-24:s,t=i||e;return a.default.createElement(c.LockBadge,{file:this.props.file,variant:"preview-large"},a.default.createElement("img",{className:"tile__preview tile__preview--thumb",draggable:!1,src:r,style:{maxHeight:t,maxWidth:e},onError:this.handleThumbnailError,alt:""}))}}return this.renderFileIcon()}renderFileIcon(){const{file:e,paper:t}=this.props;return t?this.state.paperTitleParts.icon:e?a.default.createElement(d.FileOrFolderIcon,Object.assign({className:"tile__preview tile__preview--icon brws-file-name-grid-icon",file:e,variant:"large",showPreview:!1},{"aria-hidden":!0})):a.default.createElement("div",{className:"tile__preview--placeholder"})}render(){const{altText:e,file:i,height:o,href:r,isActiveDropTarget:l,isAvailableDropTarget:d,isCutToClipboard:c,isDraggable:u,isFocused:g,isSelectable:_,isSelected:m,isViewOnly:h,labelHeight:p,labelNode:f,leftOffset:T,onClick:E,onRightClick:S,onDoubleClick:b,onLabelClick:v,onDragEnter:w,onDragStart:I,onDragEnd:O,overrideTabIndex:L,width:y,className:F}=this.props,M=o||y,P=M+p;if(h)return a.default.createElement(t.TilePlaceholder,{leftOffset:T,tileHeight:P,tileWidth:y,thumbNode:this.renderThumbnail(),labelNode:f});const C={left:T,height:P,width:y},A={height:M,width:y},R={className:s.default("tile",F,{"tile--is-selected":m,"tile--is-dragover":l,"tile--is-droppable":d&&!l,"tile--is-cut":c}),"data-filename":i&&i.name,style:C,draggable:u,href:r,onDragEnter:w,onDragStart:I,onDragEnd:O,"aria-label":i&&i.name,role:"gridcell"},N=a.default.createElement("div",{className:"tile__thumb-container",style:A},this.renderThumbnail());return a.default.createElement("div",{role:"row",ref:"tileContainer",className:"tile__container",onKeyDown:this.handleKeyDown,tabIndex:L||g?0:-1,"aria-label":e,"aria-selected":m},a.default.createElement(n.WithDoubleClick,{onClick:E,onDoubleClick:b},e=>a.default.createElement("div",Object.assign({},R,{onClick:e.onClick,onContextMenu:S}),N,_&&this.renderCheckbox(),this.renderActionNode(),a.default.createElement(t.TileLabel,{onClick:v,ariaLabel:i&&i.name},f))))}}t.TileElementComponentForTests=h,h.defaultProps={checkboxAriaText:"",checkboxTabIndex:-1,delayRenderFullTile:!0,handleToggleSelect:m,isFocused:!1,isSelected:!1,isViewOnly:!1,onDragEnter:m,onDragStart:m,onClick:m,onRightClick:m},h.displayName="TileElementComponentForTests",t.TileElement=_.withThumbStore(h)})),define("metaserver/static/js/modules/clean/react/files_view/base_tile_grid",["require","exports","tslib","classnames","react","resize-observer-polyfill","react-dom","spectrum/culled_list/index","metaserver/static/js/modules/clean/filepath/filepath","metaserver/static/js/modules/clean/js_client_stopwatch","metaserver/static/js/modules/clean/react/files_view/tile_element","metaserver/static/js/modules/clean/react/files_view/tile_grid_logger"],(function(e,t,i,s,a,o,r,l,n,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InfiniteTileGrid=t.TileItemLabelText=t.memoizeCallback=void 0,s=i.__importDefault(s),a=i.__importDefault(a),o=i.__importDefault(o),r=i.__importStar(r),n=i.__importStar(n);function g(e){let t=null;return(...i)=>{if(!t||t.length!==i.length||!t.every((e,t)=>e===i[t]))return t=i,e(...i)}}t.memoizeCallback=g,t.TileItemLabelText=function({className:e,label:t}){return e=s.default("tile-label__text",e),a.default.createElement("div",{className:e},t)};class _ extends a.default.PureComponent{constructor(e){if(super(e),this.tileIndexToRowIndex=[],this.rowHeights=[],this.ttiReported=!1,this.itemRangeByRow=[],this.tileLoadLogger=null,this.updateLayout=()=>{this.animationFrameRequestId=window.requestAnimationFrame(()=>{const e=this.getAndUpdateTileLayout();this.props.logTileLoading&&!this.tileLoadLogger&&this.setupTileLogging(this.getRowHeight(),e.tilesPerRow)})},this.updateScroll=e=>{const{scrollToIndex:t,scrollIntoView:i,scrollPositionOffset:s}=this.props;if(void 0!==t&&i){const a=this.tileIndexToRowIndex[t],o=this.rowHeights.slice(0,a).reduce((e,t)=>e+t,s);i({top:o,bottom:o+this.rowHeights[a]},e)}},this.getAndUpdateTileLayout=()=>{const e=this.props.maxTileWidth+this.props.tilePadding,t=r.findDOMNode(this);if(!t||0===t.clientWidth)return{tileWidth:this.state.tileWidth,tilesPerRow:this.props.tilesPerRow};const i=t.clientWidth;let s=Math.max(1,Math.floor(i/e)),a=this.props.maxTileWidth;return i%e>1&&(s++,a=i/s-this.props.tilePadding),this.state.tileWidth!==a&&this.setState({tileWidth:a}),this.props.tilesPerRow!==s&&this.props.onTilesPerRowChange(s),{tileWidth:a,tilesPerRow:s}},this.handleTTI=()=>{this.ttiReported=!0;const{handleTTI:e}=this.props;e&&e()},this.setLastViewedPage=e=>{if(!this.tileLoadLogger)return;const t=document.documentElement.scrollTop||document.body.scrollTop,i=Math.round(t/e);if(this.tileLoadLogger.pruneTrackedPages(),this.tileLoadLogger.logCompletedPages(),!this.tileLoadLogger.pagesCompletedLogging.has(i)&&!this.tileLoadLogger.pagesToLog.has(i))if(i!==this.tileLoadLogger.lastViewedPage){if(this.tileLoadLogger.lastViewedPage=i,this.tileLoadLogger.pageChangeTime=this.tileLoadLogger.getTimeNow(),!this.tileLoadLogger.startTimeByPage.get(i)){const e=this.tileLoadLogger.getTimeNow();this.tileLoadLogger.startTimeByPage.set(i,e)}}else{this.tileLoadLogger.getTimeNow()-this.tileLoadLogger.pageChangeTime>1e3&&this.tileLoadLogger.pagesToLog.add(i)}},this.logTileError=e=>{this.tileLoadLogger&&this.tileLoadLogger.recordTileError(e),this.props.logTileLoading&&u.InfiniteTileGridLogger.logThumbLoadError()},this.logTileLoaded=(e,t,i)=>{this.tileLoadLogger&&this.tileLoadLogger.recordTileLoaded(e,t,i)},this.renderTileElement=(e,t,i,s)=>{var o,r;if(e<0||e>this.props.totalNumItems)return null;const l=this.props.getTileItem(e,i);if(!l)return a.default.createElement(c.TilePlaceholder,{leftOffset:t,tileHeight:this.state.tileWidth,tileWidth:this.state.tileWidth});const d=this.ttiReported&&this.props.delayRenderFullTile,u=l.isSelectable&&!!this.props.selectedIds&&this.props.selectedIds.has(l.id),g=l.file&&this.props.shouldFileBeHighlightedDropTarget(l.file,u),_=g&&l.file===this.props.activeDropTarget;let m,h="";l.fileSharedWithMe?(h=l.fileSharedWithMe.file_id,m={type:l.fileSharedWithMe.type,icon:l.fileSharedWithMe.icon,fq_path:`/${l.fileSharedWithMe.filename}`,thumbnail_url_tmpl:l.fileSharedWithMe.thumbnail_url_tmpl,name:l.fileSharedWithMe.filename}):l.file&&(h=l.file.fq_path,m={type:l.file.type,icon:l.file.icon,fq_path:l.file.fq_path,thumbnail_url_tmpl:l.file.thumbnail_url_tmpl,name:n.filename(l.file.fq_path),isDeleted:l.file.isDeleted,is_locked:l.file.is_locked,is_lockholder:l.file.is_lockholder,lockholder_name:l.file.lockholder_name,lock_info:l.file.lock_info});const p=l.labelNode?this.props.labelHeight:0;null===(r=(o=this.props).registerSelectableTile)||void 0===r||r.call(o,h,{top:s,left:t,width:this.state.tileWidth,height:p+this.state.tileWidth});const f=0===e&&this.props.selectedIds&&0===this.props.selectedIds.size;return a.default.createElement(c.TileElement,{file:m,paper:l.paper,key:l.id,onClick:l.onClick,onRightClick:l.onRightClick,onDoubleClick:l.onDoubleClick,onLabelClick:l.onLabelClick,width:this.state.tileWidth,leftOffset:t,tileIndex:e,labelHeight:p,delayRenderFullTile:d,actionNode:l.actionNode,thumbnailUrl:l.thumbnailUrl,labelNode:l.labelNode,altText:l.altText,onThumbnailError:this.props.logTileLoading?this.logTileError:void 0,onThumbnailLoad:this.props.logTileLoading?this.logTileLoaded:void 0,isDraggable:l.isDraggable,onDragEnter:l.onDragEnter,onDragStart:l.onDragStart,onDragEnd:l.onDragEnd,isFocused:l.isFocused,isSelectable:l.isSelectable,isSelected:u,isViewOnly:l.isViewOnly,isActiveDropTarget:_,isAvailableDropTarget:g,handleToggleSelect:l.handleToggleSelect,checkboxAriaText:l.checkboxAriaText,checkboxTabIndex:l.isCheckboxFocusable?0:-1,href:l.href,overrideTabIndex:f,isCutToClipboard:l.isCutToClipboard,className:l.className})},this.renderRow=(e,t,i)=>{const s=this.getRowHeight(t);if(!e)return a.default.createElement(l.CulledItem,{className:this.props.rowClass,height:s,key:t,tagName:"div",topOffset:i});if(!Array.isArray(e))return a.default.createElement(l.CulledItem,{className:this.props.rowClass,height:s,key:t,tagName:"div",topOffset:i},e);const[o,r]=e,n=this.state.tileWidth+this.props.tilePadding,d=[];let c=4;for(let e=o;e<r;e++)d.push(this.renderTileElement(e,c,d.length,i)),c+=n;return a.default.createElement(l.CulledItem,{className:this.props.rowClass,height:s,key:t,tagName:"div",topOffset:i},d)},this.handleRangeInView=g((e,t)=>{const{onRangeInView:i}=this.props;if(!i)return;if(0===this.props.totalNumItems)return;const[s,a]=this.translateRowRangeToItemRange(e,t);isNaN(s)||isNaN(a)||i(s,a)}),this.props.sectionLabels||this.props.sectionStartIndices){if(!this.props.sectionLabels||!this.props.sectionStartIndices)throw new Error("Included only one of `sectionLabels` or `sectionStartIndices`.");if(this.props.sectionLabels.length!==this.props.sectionStartIndices.length)throw new Error("sectionLabels and sectionStartIndices must be of same length.")}this.state={tileWidth:this.props.maxTileWidth},d.JSStopwatch.create_stopwatch_if_not_exist("infinite_tile_grid_logging"),this.resizeObserver=new o.default(this.updateLayout)}componentDidMount(){window.addEventListener("resize",this.updateLayout),this.updateLayout(),this.updateScroll(!0);const e=document.querySelector(".maestro-secondary-sidebar-v2");e&&this.resizeObserver.observe(e)}componentDidUpdate(e){this.tileLoadLogger&&this.tileLoadLogger.updateNumTiles(this.props.totalNumItems),e.scrollToIndex!==this.props.scrollToIndex&&this.updateScroll(void 0===e.scrollToIndex||e.scrollToIndex<0),e.maxTileWidth!==this.props.maxTileWidth&&this.updateLayout()}componentWillUnmount(){this.resizeObserver.disconnect(),window.removeEventListener("resize",this.updateLayout),this.animationFrameRequestId&&window.cancelAnimationFrame(this.animationFrameRequestId),this.tileLoadLogger&&(clearInterval(this.logTrackingInterval),this.tileLoadLogger=null)}getRowHeight(e){if(void 0!==e&&this.rowHeights)return this.rowHeights[e];let t=this.state.tileWidth+this.props.tilePadding;return this.props.showLabels&&(t+=this.props.labelHeight+4),t}getPageHeight(){const e=(document.documentElement.clientHeight||window.outerHeight)-(this.props.contentOffset||0),t=this.getRowHeight(),i=t*Math.ceil(e/t);return Math.max(i,t)}setupTileLogging(e,t){const i=this.getPageHeight(),s=t*Math.ceil(i/e);this.tileLoadLogger=new u.InfiniteTileGridLogger(this.props.totalNumItems,s,t,this.handleTTI),this.tileLoadLogger.pagesToLog.add(0);const a=this.tileLoadLogger.getTimeNow();this.tileLoadLogger.startTimeByPage.set(0,a),this.logTrackingInterval=setInterval(this.setLastViewedPage,200,i)}translateRowRangeToItemRange(e,t){const{itemRangeByRow:i}=this;return[i[e][0],i[t][1]]}render(){this.itemRangeByRow=[],this.rowHeights=[],this.tileIndexToRowIndex=[];const e=[],t=this.getRowHeight(),{containerClass:i,enableMaxHeightGrouping:s,numThresholdRows:o,scrollDeltaThreshold:r,sectionStartIndices:n,sectionLabels:d,totalNumItems:c,window:u}=this.props;if(n&&n.length>0)n.forEach((i,s)=>{let o=c;s!==n.length-1&&(o=n[s+1]),this.rowHeights.push(32);const r=o-i,l=Math.ceil(r/this.props.tilesPerRow),u=d[s],g=a.default.createElement("div",{className:"tile-section-header",role:"heading","aria-level":2},u);e.push(g),this.itemRangeByRow.push([i,i]);for(let s=0;s<l;s++){const a=i+s*this.props.tilesPerRow,r=Math.min(a+this.props.tilesPerRow,o),l=[a,r];e.push(l),this.itemRangeByRow.push(l);for(let e=a;e<r;e++)this.tileIndexToRowIndex.push(this.rowHeights.length);this.rowHeights.push(t)}});else{const i=Math.ceil(c/this.props.tilesPerRow);for(let s=0;s<i;s++){const i=s*this.props.tilesPerRow,a=Math.min(i+this.props.tilesPerRow,c),o=[i,a];e.push(o),this.itemRangeByRow.push(o);for(let e=i;e<a;e++)this.tileIndexToRowIndex.push(this.rowHeights.length);this.rowHeights.push(t)}}return a.default.createElement(l.CulledList,{enableMaxHeightGrouping:s,items:e,listItemHeight:this.rowHeights,itemBuffer:o,className:i,renderRow:this.renderRow,scrollThreshold:r,shouldUseWindowAsScrollContainer:!0,onRangeInView:this.handleRangeInView,tagName:"div",window:u})}}t.InfiniteTileGrid=_,_.defaultProps={enableMaxHeightGrouping:!1,numThresholdRows:10,tilePadding:16,tileHeight:160,maxTileWidth:160,labelHeight:40,logTileLoading:!1,scrollDeltaThreshold:1,showLabels:!0,getTileItem:()=>null,handleTTI:()=>{}},_.displayName="InfiniteTileGrid"})),define("metaserver/static/js/modules/clean/react/files_view/tile_grid_logger",["require","exports","metaserver/static/js/modules/clean/js_client_stopwatch"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InfiniteTileGridLogger=void 0;t.InfiniteTileGridLogger=class{constructor(e,t,i,s){this.recordTileError=e=>{const t=Math.floor(e/this.numTilesPerPage);this.pagesWithThumbErrors.has(t)||this.pagesWithThumbErrors.add(t)},this.recordTileLoaded=(e,t,i)=>{if(i){if(this.thumbsLoaded.has(e))return;this.thumbsLoaded.add(e)}else{if(this.iconsLoaded.has(e))return;this.iconsLoaded.add(e)}let s=!1;s=this.numTiles%this.numTilesPerPage==0?e>=this.numTiles-this.numTilesPerPage:e>=this.numTiles-this.numTiles%this.numTilesPerPage;let a=this.numTilesPerPage;if(s){const e=this.numTiles%this.numTilesPerPage;0!==e&&(a=e)}const o=Math.floor(e/this.numTilesPerPage);if(i||!t){const e=this.numTilesFinalizedByPage[o]||0;this.numTilesFinalizedByPage[o]=e+1}if(0===o&&this.handleTTI){!(this.iconsLoaded.has(e)&&this.thumbsLoaded.has(e))&&(this.numTilesLoadedOnFirstPage++,this.numTilesLoadedOnFirstPage===a&&this.handleTTI())}i&&(this.pagesWithThumbs.has(o)||this.pagesWithThumbs.add(o),this.anyThumbLoadedTimeByPage.get(o)||this.anyThumbLoadedTimeByPage.set(o,this.getTimeNow()),this.numTilesFinalizedByPage[o]===a&&this.allThumbsLoadedTimeByPage.set(o,this.getTimeNow()))},this.pruneTrackedPages=()=>{this.startTimeByPage.forEach((e,t)=>{!this.pagesToLog.has(t)&&!this.pagesCompletedLogging.has(t)&&this.getTimeNow()-e>2e3&&this.startTimeByPage.delete(t)})},this.logCompletedPages=()=>{this.pagesToLog.forEach(e=>{const t=this.startTimeByPage.get(e),i=Math.max(this.allThumbsLoadedTimeByPage.get(e),t),s=Math.max(this.anyThumbLoadedTimeByPage.get(e),t);!i||this.pagesWithThumbs.has(e)?this.pagesWithThumbErrors.has(e)?this.handlePageCompletedLogging(e):t&&i&&s&&(this.logPerfStats(e,t,s,i),this.handlePageCompletedLogging(e)):this.handlePageCompletedLogging(e)})},this.numTiles=e,this.numTilesPerPage=t,this.numTilesFinalizedByPage=[],this.numTilesLoadedOnFirstPage=0,this.iconsLoaded=new Set,this.thumbsLoaded=new Set,this.startTimeByPage=new Map,this.allThumbsLoadedTimeByPage=new Map,this.anyThumbLoadedTimeByPage=new Map,this.pagesWithThumbErrors=new Set,this.pagesWithThumbs=new Set,this.pagesCompletedLogging=new Set,this.pagesToLog=new Set,this.handleTTI=s}getTimeNow(){return window.performance.now()}updateNumTiles(e){this.numTiles>=e||(this.numTiles=e)}handlePageCompletedLogging(e){this.pagesCompletedLogging.add(e),this.pagesToLog.delete(e),this.startTimeByPage.delete(e),this.anyThumbLoadedTimeByPage.delete(e),this.allThumbsLoadedTimeByPage.delete(e)}static logThumbLoadError(){i.JSStopwatch.recordTrace("visual_browse_thumb_load_error",{stopwatchName:"infinite_tile_grid_logging",traceTime:0})}static logThumbRTT(e){i.JSStopwatch.recordTrace("visual_browse_thumb_rtt",{stopwatchName:"infinite_tile_grid_logging",traceTime:e})}logPerfStats(e,t,s,a){i.JSStopwatch.recordTrace(`loaded_any_thumbs_page_${e}`,{stopwatchName:"infinite_tile_grid_logging",traceTime:s-t}),i.JSStopwatch.recordTrace(`loaded_all_thumbs_page_${e}`,{stopwatchName:"infinite_tile_grid_logging",traceTime:a-t})}}})),define("metaserver/static/js/modules/clean/tagging/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_TAGS_PER_ITEM=void 0,t.MAX_TAGS_PER_ITEM=20})),define("metaserver/static/js/modules/clean/tagging/data/action_creators",["require","exports","tslib","lodash","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/clean/filepath/filepath","metaserver/static/js/modules/clean/react/snackbar","metaserver/static/js/modules/clean/tagging/data/selectors/index","metaserver/static/js/modules/clean/tagging/data/types","metaserver/static/js/modules/clean/tagging/api","metaserver/static/js/modules/clean/tagging/constants","metaserver/static/js/modules/clean/tagging/logger","metaserver/static/js/modules/clean/tagging/utils"],(function(e,t,i,s,a,o,r,l,n,d,c,u,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchAllTagsSuggestions=t.fetchTagsForFiles=t.setAllTags=t.fileRename=t.removeTagFromFiles=t.addTagToFiles=void 0,o=i.__importStar(o),l=i.__importStar(l),u=i.__importStar(u);const _=({fileToTags:e,override:t})=>({type:n.ActionTypes.SET_FILE_TO_TAGS_MAP,payload:{fileToTags:e,override:t}});t.addTagToFiles=function({user:e,files:t,tag:n,onPartialError:m,onSuccess:h,autoTagFolderContents:p,actionSurface:f}){return(T,E)=>i.__awaiter(this,void 0,void 0,(function*(){const i=l.selectTagsByFile(E()),S=g.tagTextToTagUserGeneratedTag(n),b=t[0];if(1!==t.length||p)try{r.Snackbar.sync(a.intl.formatMessage({id:"U2RxSG",defaultMessage:"Tagging…"}),!0,"add-tag-bulk");let i=!1;if(p){const s=yield d.tagsApiClient.listFolder(g.getFileObjectNsIdAndPath(b).nsPath,e);t=s.files,i=s.reachedLimit}const v=yield d.tagsApiClient.addTagBulk(e,n,t),w=t.filter(e=>-1===v.findIndex(t=>{const i=g.getFileObjectNsIdAndPath(e);return i.nsId===t.ns_id&&i.nsPath===t.ns_path})),I=v.length,O=w.length,L=t.filter(e=>{var t;return(null===(t=e.tags)||void 0===t?void 0:t.length)===c.MAX_TAGS_PER_ITEM}).length,y=t.filter(e=>!g.fileHasEditPermissions(e)).length,F=w.reduce((e,t)=>{const i=g.getFileMapKey(t),a=l.selectTagsByFile(E())[i],o=s.uniq([S,...null!=a?a:[]]);return Object.assign(Object.assign({},e),{[i]:o})},{});if(u.logAddTag(e,w,n,f),T(_({fileToTags:F})),0===v.length&&!i)return r.Snackbar.close(),void h(!0,O,p);if(m(w),i)return void r.Snackbar.complete(a.intl.formatMessage({id:"Y9TAaz",defaultMessage:"Tagged {numOfSuccesses} of the files in {folderName}."},{numOfSuccesses:O,folderName:o.filename(b.fq_path)}),"add-tag-bulk");if(L>0&&y>0)return void r.Snackbar.complete(a.intl.formatMessage({id:"Evli0B",defaultMessage:"Tagged {numOfSuccesses} items #{tag}. Couldn’t tag {numOfFailures} files or folders."},{numOfSuccesses:O,tag:n,numOfFailures:I}),"add-tag-bulk");if(L>0)return void r.Snackbar.complete(a.intl.formatMessage({id:"jk4Wg3",defaultMessage:"Tagged {numOfSuccesses} items #{tag}. Couldn’t tag {numOfFailures} items that don’t have room for more tags."},{numOfSuccesses:O,tag:n,numOfFailures:I}),"add-tag-bulk");r.Snackbar.complete(a.intl.formatMessage({id:"JmcOdr",defaultMessage:"Tagged {numOfSuccesses} items #{tag}. Couldn’t tag {numOfFailures} files or folders without editing access."},{numOfSuccesses:O,tag:n,numOfFailures:I}),"add-tag-bulk")}catch(s){T(_({fileToTags:i,override:!0})),u.logFailTag(e,t,n,f),r.Snackbar.fail(a.intl.formatMessage({id:"8bKaBW",defaultMessage:"Couldn’t tag these files or folders."}),"add-tag-bulk")}else{const c=g.getFileMapKey(b),m=l.selectTagsByFile(E())[c],v=s.uniq([S,...null!=m?m:[]]);T(_({fileToTags:{[c]:v}}));try{yield d.tagsApiClient.addTag(e,n,b),u.logAddTag(e,t,n,f)}catch(s){return T(_({fileToTags:i,override:!0})),u.logFailTag(e,t,n,f),void r.Snackbar.fail(a.intl.formatMessage({id:"IibVuC",defaultMessage:"Couldn’t add #{tag} to {fileName}."},{tag:n,fileName:o.filename(b.fq_path)}))}h(!1,1,p)}}))},t.removeTagFromFiles=function({user:t,files:s,tag:n,actionSurface:c}){return(m,h)=>i.__awaiter(this,void 0,void 0,(function*(){var p;const f=n.tag_text,T=l.selectTagsByFile(h());if(1===s.length){const e=g.getFileMapKey(s[0]),i=l.selectTagsByFile(h())[e],E=null!==(p=null==i?void 0:i.filter(e=>e.tag_text!==f))&&void 0!==p?p:[];m(_({fileToTags:{[e]:E}}));try{yield d.tagsApiClient.removeTag(t,f,s[0]),u.logRemoveTag(t,s,n,c)}catch(e){m(_({fileToTags:T,override:!0})),r.Snackbar.fail(a.intl.formatMessage({id:"zXNhaY",defaultMessage:"Couldn’t remove #{tag} from {fileName}."},{tag:f,fileName:o.filename(s[0].fq_path)}))}return}const{showRemoveTagsModal:E}=yield new Promise((t,i)=>{e(["metaserver/static/js/modules/clean/tagging/components/remove_tags_modal"],t,i)}).then(i.__importStar);E({numOfFiles:s.length,tag:f,onRemoveClick:()=>i.__awaiter(this,void 0,void 0,(function*(){try{r.Snackbar.sync(a.intl.formatMessage({id:"FAj93H",defaultMessage:"Removing tags…"}),!0,"remove-tag-bulk");const e=yield d.tagsApiClient.removeTagBulk(t,f,s),i=s.filter(t=>-1===e.findIndex(e=>{const i=g.getFileObjectNsIdAndPath(t);return i.nsId===e.ns_id&&i.nsPath===e.ns_path})),o=i.reduce((e,t)=>{var i;const s=g.getFileMapKey(t),a=l.selectTagsByFile(h())[s],o=null!==(i=null==a?void 0:a.filter(e=>e.tag_text!==f))&&void 0!==i?i:[];return Object.assign(Object.assign({},e),{[s]:o})},{});u.logRemoveTag(t,i,n,c),m(_({fileToTags:o})),r.Snackbar.complete(a.intl.formatMessage({id:"fXEVtA",defaultMessage:"Removed #{tag} from {numOfFiles} files."},{numOfFiles:i.length,tag:f}),"remove-tag-bulk")}catch(e){m(_({fileToTags:T,override:!0})),r.Snackbar.fail(a.intl.formatMessage({id:"YV4k+f",defaultMessage:"Couldn’t remove #{tag}."},{tag:f}),"remove-tag-bulk")}}))})}))},t.fileRename=({file:e,newFile:t})=>({type:n.ActionTypes.FILE_RENAME,payload:{file:e,newFile:t}}),t.setAllTags=({tags:e})=>({type:n.ActionTypes.SET_ALL_TAGS,payload:{tags:e}}),t.fetchTagsForFiles=function({user:e,files:t,override:i=!1}){return(s,a)=>{0!==t.length&&d.tagsApiClient.getTags(e,t).then(e=>{s(_({fileToTags:e,override:i}))})}},t.fetchAllTagsSuggestions=function({user:e,onSuccess:i}){return(s,a)=>{void 0===l.selectAllTagsSuggestions(a())&&d.tagsApiClient.getAllTags(e).then(e=>{s(t.setAllTags({tags:e})),null==i||i()})}}})),define("metaserver/static/js/modules/clean/tagging/data/reducer",["require","exports","lodash","metaserver/static/js/modules/clean/tagging/data/types","metaserver/static/js/modules/clean/tagging/utils"],(function(e,t,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.taggingReducer=t.defaultTaggingState=void 0,t.defaultTaggingState={tagsByFile:{},tags:void 0};const o=(e,t)=>{const i=[...e,...t],s=new Map(i.map(e=>[e.tag_text,e]));return[...Array.from(s.values())]};t.taggingReducer=function(e=t.defaultTaggingState,r){switch(r.type){case s.ActionTypes.SET_FILE_TO_TAGS_MAP:return((e,{fileToTags:t,override:s})=>{const a=Object.keys(t).reduce((s,a)=>{const o=e.tagsByFile[a],r=t[a];return void 0===o?(s[a]=r,s):(i.isEqual(i.sortBy(o,e=>e.tag_text),i.sortBy(r,e=>e.tag_text))?s[a]=o:s[a]=r,s)},{});let r=void 0;if(void 0!==e.tags){const t=Object.entries(a).map(([e,t])=>t).reduce((e,t)=>[...t,...e],[]);r=o(e.tags,t)}return Object.assign(Object.assign({},e),{tagsByFile:Object.assign(Object.assign({},s?{}:e.tagsByFile),a),tags:null!=r?r:e.tags})})(e,r.payload);case s.ActionTypes.FILE_RENAME:return((e,{file:t,newFile:i})=>{const s=a.getFileMapKey(t),o=a.getFileMapKey(i),r=e.tagsByFile[s];if(!r)return e;const l=e.tagsByFile;return delete l[s],l[o]=r,Object.assign(Object.assign({},e),{tagsByFile:l})})(e,r.payload);case s.ActionTypes.SET_ALL_TAGS:return((e,{tags:t})=>Object.assign(Object.assign({},e),{tags:t}))(e,r.payload);default:return e}}})),define("metaserver/static/js/modules/clean/tagging/data/selectors/index",["require","exports","metaserver/static/js/modules/clean/redux/namespaces","metaserver/static/js/modules/clean/redux/selectors"],(function(e,t,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectAllTagsSuggestions=t.selectTagsByFile=void 0;const a=e=>s.getStateAtNamespace(e,i.TAGGING_NAMESPACE_KEY);t.selectTagsByFile=e=>a(e).tagsByFile,t.selectAllTagsSuggestions=e=>a(e).tags})),define("metaserver/static/js/modules/clean/tagging/data/store",["require","exports","metaserver/static/js/modules/clean/tagging/data/reducer","metaserver/static/js/modules/clean/redux/namespaces","metaserver/static/js/modules/clean/redux/store"],(function(e,t,i,s,a){"use strict";let o;Object.defineProperty(t,"__esModule",{value:!0}),t.getStoreForTagging=void 0,t.getStoreForTagging=()=>(o||(o=a.getStoreAndRegisterReducers({[s.TAGGING_NAMESPACE_KEY]:i.taggingReducer})),o)})),define("metaserver/static/js/modules/clean/tagging/data/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionTypes=void 0,(function(e){e.SET_FILE_TO_TAGS_MAP="TAGGING/SET_FILE_TO_TAGS_MAP",e.ADD_TAG_TO_FILE="TAGGING/ADD_TAG_TO_FILE",e.REMOVE_TAG_FROM_FILE="TAGGING/REMOVE_TAG_FROM_FILE",e.FILE_RENAME="TAGGING/FILE_RENAME",e.SET_ALL_TAGS="TAGGING/SET_ALL_TAGS"})(t.ActionTypes||(t.ActionTypes={}))})),define("metaserver/static/js/modules/clean/tagging/logger",["require","exports","tslib","metaserver/static/js/modules/clean/logging/telemetry","metaserver/static/js/modules/clean/logging/hive/schemas/server-tag_actions","metaserver/static/js/modules/clean/tagging/utils"],(function(e,t,i,s,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logTagsOnPreviewsExposure=t.logAutoTagSnackbarAction=t.logTagClick=t.logFailTag=t.logAddTag=t.logStartTypingTag=t.logSelectTagBar=t.logRemoveTag=void 0,s=i.__importStar(s);const r=new s.HiveLogger;function l(t){return i.__awaiter(this,void 0,void 0,(function*(){const{LOGGING_ALLOWED_EXTS:s,LOGGING_UNALLOWED_EXT_PLACEHOLDER:a}=yield new Promise((t,i)=>{e(["typescript/libraries/file-viewer/src/file_extension/extension_constants"],t,i)}).then(i.__importStar);return s.includes(t.ext)?t.ext:a}))}t.logRemoveTag=function(e,t,s,n){return i.__awaiter(this,void 0,void 0,(function*(){yield Promise.all(t.map(t=>i.__awaiter(this,void 0,void 0,(function*(){r.log(new a.ServerTagActionsRow({tag_name:null,tag_type:o.getTagType(s),event_name:"remove_tag",action_surface:n,file_ext:yield l(t),file_nsid:t.ns_id.toString(),file_sjid:t.sjid.toString(),platform:"web",user_id:e.id,file_id:t.file_id}))}))))}))},t.logSelectTagBar=function(e,t,s){return i.__awaiter(this,void 0,void 0,(function*(){yield Promise.all(t.map(t=>i.__awaiter(this,void 0,void 0,(function*(){r.log(new a.ServerTagActionsRow({tag_name:null,tag_type:"na",event_name:"select_tag_bar",action_surface:s,file_ext:yield l(t),file_nsid:t.ns_id.toString(),file_sjid:t.sjid.toString(),platform:"web",user_id:e.id,file_id:t.file_id}))}))))}))},t.logStartTypingTag=function(e,t,s){return i.__awaiter(this,void 0,void 0,(function*(){yield Promise.all(t.map(t=>i.__awaiter(this,void 0,void 0,(function*(){r.log(new a.ServerTagActionsRow({tag_name:null,tag_type:"na",event_name:"start_typing_tag",action_surface:s,file_ext:yield l(t),file_nsid:t.ns_id.toString(),file_sjid:t.sjid.toString(),platform:"web",user_id:e.id,file_id:t.file_id}))}))))}))},t.logAddTag=function(e,t,s,o){return i.__awaiter(this,void 0,void 0,(function*(){yield Promise.all(t.map(t=>i.__awaiter(this,void 0,void 0,(function*(){r.log(new a.ServerTagActionsRow({tag_name:null,tag_type:"user_generated_tag",event_name:"add_tag",action_surface:o,file_ext:yield l(t),file_nsid:t.ns_id.toString(),file_sjid:t.sjid.toString(),platform:"web",user_id:e.id,file_id:t.file_id}))}))))}))},t.logFailTag=function(e,t,s,o){return i.__awaiter(this,void 0,void 0,(function*(){yield Promise.all(t.map(t=>i.__awaiter(this,void 0,void 0,(function*(){r.log(new a.ServerTagActionsRow({tag_name:null,tag_type:"user_generated_tag",event_name:"fail_tag",action_surface:o,file_ext:yield l(t),file_nsid:t.ns_id.toString(),file_sjid:t.sjid.toString(),platform:"web",user_id:e.id,file_id:t.file_id}))}))))}))},t.logTagClick=function(e,t,s,n){return i.__awaiter(this,void 0,void 0,(function*(){yield Promise.all(t.map(t=>i.__awaiter(this,void 0,void 0,(function*(){r.log(new a.ServerTagActionsRow({tag_name:null,tag_type:o.getTagType(n),event_name:"select_tag",action_surface:s,file_ext:yield l(t),file_nsid:t.ns_id.toString(),file_sjid:t.sjid.toString(),platform:"web",user_id:e.id,file_id:t.file_id}))}))))}))},t.logAutoTagSnackbarAction=function(e,t,s,o,n,d){return i.__awaiter(this,void 0,void 0,(function*(){r.log(new a.ServerTagActionsRow({tag_name:null,tag_type:"user_generated_tag",event_name:"auto_tag_snackbar_action",action_surface:d,file_ext:yield l(t),file_nsid:t.ns_id.toString(),file_sjid:t.sjid.toString(),platform:"web",user_id:e,file_id:t.file_id,snackbar_action:o,tagging_type:n}))}))},t.logTagsOnPreviewsExposure=function(e){return i.__awaiter(this,void 0,void 0,(function*(){r.log(new a.ServerTagActionsRow({tag_name:null,tag_type:"user_generated_tag",event_name:"tags_on_previews_exposure",action_surface:"previews",file_ext:"",file_nsid:"",file_sjid:"",platform:"web",user_id:e,file_id:""}))}))}})),define("metaserver/static/js/modules/clean/logging/hive/schemas/server-tag_actions",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServerTagActionsRow=void 0;t.ServerTagActionsRow=class{constructor(e){this.category="server-tag_actions",this.file_oid=0,this.session_id=null,this.team_id=null,this.user_id=e.user_id,this.tag_name=e.tag_name,this.tag_type=e.tag_type,this.platform=e.platform,this.event_name=e.event_name,this.file_ext=e.file_ext,this.file_nsid=e.file_nsid,this.file_sjid=e.file_sjid,e.hasOwnProperty("file_oid")&&void 0!==e.file_oid&&(this.file_oid=e.file_oid),this.action_surface=e.action_surface,e.hasOwnProperty("session_id")&&void 0!==e.session_id&&(this.session_id=e.session_id),e.hasOwnProperty("team_id")&&void 0!==e.team_id&&(this.team_id=e.team_id),e.hasOwnProperty("snackbar_action")&&void 0!==e.snackbar_action&&(this.snackbar_action=e.snackbar_action),e.hasOwnProperty("tagging_type")&&void 0!==e.tagging_type&&(this.tagging_type=e.tagging_type),this.file_id=e.file_id,Object.seal(this)}}})),define("metaserver/static/js/modules/clean/teams/components/item_truncation_container/item_truncation_container",["require","exports","tslib","react","classnames","dig-components/chips","dig-components/tooltips","metaserver/static/js/modules/clean/react/components/css","dig-components/typography","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/clean/react/hooks/resize_observer"],(function(e,t,i,s,a,o,r,l,n,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ItemTruncationContainer=t.ItemTruncationContainerWithoutCss=t.renderMoreButton=t.createChipsDefault=t.createMoreTooltipDefault=void 0,s=i.__importStar(s),a=i.__importDefault(a),t.createMoreTooltipDefault=e=>e.map(e=>`#${e}`).join(" "),t.createChipsDefault=(e,t,i,a)=>({item:r,ref:l})=>{const n=t?o.InputChip:o.ChoiceChip;return s.default.createElement(n,{key:r,ref:l,className:a,onClick:t=>null==e?void 0:e(r,t),onDelete:()=>null==t?void 0:t(r),size:i||"small"},"#"+r)},t.renderMoreButton=(e,t,i)=>s.default.createElement(n.Text,{size:"small",className:a.default("itc-show-more-button",{clickable:void 0!==t},i),onClick:t},"+",e),t.ItemTruncationContainerWithoutCss=function(e){const{showMoreWidth:i=60,containerMaxRows:o=2,itemsToMoreTooltipString:l,expandable:u=!0,renderItem:g,items:_,className:m,showMoreClassName:h}=e,[p,f]=s.default.useState(_.length),[T,E]=s.default.useState(!1),S=s.default.useMemo(()=>Array(_.length).fill(0).map(e=>s.createRef()),[_]),[b,v]=s.useState(),w=[];if(_.map((e,t)=>{(t<=p||T)&&w.push(g({item:e,ref:S[t],index:t}))}),S.length>p&&!T){const e=l(_.slice(p+1));w.push(s.default.createElement(r.Tooltip,{id:"more-button-tooltip",title:e},t.renderMoreButton(S.length-(p+1),u?()=>E(!0):void 0,h)))}const[I,O]=c.useResizeObserver();return s.default.useEffect(()=>{b&&(f(_.length),v(null))},[null==O?void 0:O.contentRect.width]),s.default.useLayoutEffect(()=>{var e,t;if(!S||!S[0]||!b||0===b.clientWidth)return void(p!==_.length&&f(_.length));const s=((null===(t=null===(e=S[0])||void 0===e?void 0:e.current)||void 0===t?void 0:t.offsetHeight)||1)-1,a=(o-1)*s,r=S.findIndex(e=>{const t=e.current;if(t){const e=b.offsetLeft+b.clientWidth-(t.offsetLeft+t.clientWidth),r=t.offsetTop-b.offsetTop;if(e<i&&r>=a||r>=o*s)return!0}return!1});E(!1),f(r<0?_.length:r-1)},[_.length,b]),s.default.createElement("div",{ref:I,className:a.default("itc-container",m)},s.default.createElement("div",{key:_.length,className:"itc-items-container",ref:e=>v(e)},w),T&&s.default.createElement(n.Text,{size:"small",key:"show_less",id:"show-less",onClick:()=>E(!1),className:a.default("itc-show-more-button clickable",h)},d.intl.formatMessage({id:"QSkw6O",defaultMessage:"show less"})))},t.ItemTruncationContainer=l.requireCssWithComponent(t.ItemTruncationContainerWithoutCss,["/static/css/teams/admin/components/item_truncation_container-vflnj951-.css"])})),define("metaserver/static/js/modules/clean/tagging/api",["require","exports","tslib","metaserver/static/js/api_v2/default_user_client","metaserver/static/js/modules/clean/tagging/utils","metaserver/static/js/modules/clean/react/browse/models"],(function(e,t,i,s,a,o){"use strict";function r(e){const t=a.getFileObjectNsIdAndPath(e);return{ns_id:t.nsId,ns_path:t.nsPath}}Object.defineProperty(t,"__esModule",{value:!0}),t.tagsApiClient=t.TagsApiClient=void 0;const l=e=>new Promise(t=>setTimeout(t,e));class n{getTags(e,t){return i.__awaiter(this,void 0,void 0,(function*(){const i=new s.DefaultUserApiV2Client(e),o={content_ids:t.map(r)};return(yield i.ns("manual_tagging").rpc("tags/get",o,{})).tags_by_content_id.reduce((e,{content_id:{ns_id:t,ns_path:i},tags:s,typed_tags:o})=>(e[a.getFileObjectNsIdAndPathKey({nsId:t,nsPath:i})]=((e,t)=>t?t.filter(a.isTextTag):e.map(e=>({".tag":"user_generated_tag",tag_text:e})))(s,o),e),{})}))}getAllTags(e){return i.__awaiter(this,void 0,void 0,(function*(){const t=new s.DefaultUserApiV2Client(e);return(yield t.ns("manual_tagging").rpc("tags/get_viewable_tags",void 0,{})).tag_and_counts.map(e=>e.typed_tag).filter(a.isTextTag)}))}addTag(e,t,a){return i.__awaiter(this,void 0,void 0,(function*(){const i=new s.DefaultUserApiV2Client(e),o={tag:t,content_id:r(a)};return(yield i.ns("manual_tagging").rpc("tag/add",o,{})).hlc}))}addTagBulk(e,t,a){return i.__awaiter(this,void 0,void 0,(function*(){const o=new s.DefaultUserApiV2Client(e),n={tag:t,content_ids:a.map(r)},d=yield o.ns("manual_tagging").rpc("tag/add_bulk",n,{});if("complete"===d[".tag"])return d.failed;if("failed"===d[".tag"])throw new Error("tag/add_bulk failed");const{async_job_id:c}=d,u=()=>i.__awaiter(this,void 0,void 0,(function*(){return yield o.ns("manual_tagging").rpc("tag/add_bulk/check",{async_job_id:c},{})}));let g=yield u();for(;"in_progress"===g[".tag"];)yield l(1e3),g=yield u();if("failed"===g[".tag"]||"other"===g[".tag"])throw new Error("tag/add_bulk failed");return g.failed}))}removeTag(e,t,a){return i.__awaiter(this,void 0,void 0,(function*(){const i=new s.DefaultUserApiV2Client(e),o={tag:t,content_id:r(a)};return(yield i.ns("manual_tagging").rpc("tag/remove",o,{})).hlc}))}removeTagBulk(e,t,a){return i.__awaiter(this,void 0,void 0,(function*(){const o=new s.DefaultUserApiV2Client(e),n={tag:t,content_ids:a.map(r)},d=yield o.ns("manual_tagging").rpc("tag/remove_bulk",n,{});if("complete"===d[".tag"])return d.failed;if("failed"===d[".tag"])throw new Error("tag/remove_bulk failed");const{async_job_id:c}=d,u=()=>i.__awaiter(this,void 0,void 0,(function*(){return yield o.ns("manual_tagging").rpc("tag/remove_bulk/check",{async_job_id:c},{})}));let g=yield u();for(;"in_progress"===g[".tag"];)yield l(1e3),g=yield u();if("failed"===g[".tag"]||"other"===g[".tag"])throw new Error("tag/remove_bulk failed");return g.failed}))}listFolder(e,t){var a,r;return i.__awaiter(this,void 0,void 0,(function*(){try{"/"===e&&(e="");const i={fq_path:e,include_deleted:!1,sort_is_ascending:!1,sort_folders_first:!1,include_xattrs:!1,include_folder_overview:!1};let l=!1;const n=[],d=new s.DefaultUserApiV2Client(t);let c=yield d.ns("files").rpc("browse",i,{});for(null===(a=c.paginated_file_info)||void 0===a||a.forEach(e=>e.file_info&&n.push(e.file_info));c.has_more;){if(n.length>700){l=!0;break}c=yield d.ns("files").rpc("browse_continue",{cursor:c.next_request_voucher},{}),null===(r=c.paginated_file_info)||void 0===r||r.forEach(e=>e.file_info&&n.push(e.file_info))}return{files:n.map(e=>o.File.fromAnyFileObject(e)),reachedLimit:l}}catch(e){throw new Error("list_folder API error")}}))}}t.TagsApiClient=n,t.tagsApiClient=new n})),define("metaserver/static/js/modules/clean/tagging/utils",["require","exports","tslib","lodash","metaserver/static/js/modules/core/browser","metaserver/static/js/modules/clean/search/search_helpers","metaserver/static/js/modules/clean/fuzzy","metaserver/static/js/modules/clean/history_helper"],(function(e,t,i,s,a,o,r,l){"use strict";function n(e){for(;e.startsWith("#");)e=e.substr(1);return e}function d(e){return`#${n(e)}`}function c(e){const t=!e.is_unmounted&&e.target_ns;return{nsId:t?e.target_ns:e.ns_id,nsPath:t?"":e.ns_path}}function u(e){return`${e.nsId},${e.nsPath.toLowerCase()}`}function g(){let e="";for(let t=0;t<32;t++){const t=Math.floor(10*Math.random());e+=String(t)}return e}function _(e){return t.isUserGeneratedTag(e)?e[".tag"]:t.isSuggestedTag(e)?e.classifier[".tag"]:"unknown"}Object.defineProperty(t,"__esModule",{value:!0}),t.getTagsInQuery=t.getTagType=t.textTagsToUserGeneratedTags=t.fileHasEditPermissions=t.getTagsSuggestions=t.redirectToSearchByTag=t.queryContainsTag=t.isUserGeneratedTag=t.isSuggestedTag=t.isTextTag=t.tagTextToTagUserGeneratedTag=t.getFileMapKey=t.getFileObjectNsIdAndPathKey=t.getFileObjectNsIdAndPath=t.formatTypedTag=t.formatTag=t.trimHashtags=void 0,a=i.__importStar(a),o=i.__importStar(o),r=i.__importDefault(r),t.trimHashtags=n,t.formatTag=d,t.formatTypedTag=function(e){return t.isUserGeneratedTag(e)?d(e.tag_text):n(e.tag_text)},t.getFileObjectNsIdAndPath=c,t.getFileObjectNsIdAndPathKey=u,t.getFileMapKey=function(e){return u(c(e))},t.tagTextToTagUserGeneratedTag=e=>({".tag":"user_generated_tag",tag_text:e}),t.isTextTag=e=>"user_generated_tag"===e[".tag"]||"suggested_tag"===e[".tag"],t.isSuggestedTag=e=>"suggested_tag"===e[".tag"],t.isUserGeneratedTag=e=>"user_generated_tag"===e[".tag"],t.queryContainsTag=function(e,t){if(e.toLowerCase().replace(/,/g,"").split(" ").filter(e=>e.startsWith("#")).includes(`#${t}`))return!0;const i=e.toLowerCase().replace(/[.,\/!$%\^&\*;:{}=\-`~()]/g,"").split(" ").filter(e=>!e.startsWith("#")).join(" ").replace("_"," ").split(" "),a=t.split("_");return s.intersection(i,a).length>0},t.redirectToSearchByTag=function(e,t){a.redirect(o.buildSearchURL({user:e,searchPath:"/",normalizedQuery:`${d(t)}, `,searchSessionId:g(),searchToken:o.getSearchCsrfToken(),qargs:{search_from:l.deconstructUrl().path}}).toString())},t.getTagsSuggestions=function(e,t){return r.default.filter(e,t,{extract:e=>e.tag_text}).map(e=>e.original).sort((e,t)=>e.tag_text.localeCompare(t.tag_text))},t.fileHasEditPermissions=e=>(!e.is_dir||!e.isDeleted)&&(e.target_ns?!e._mount_access_perms||!(!e._mount_access_perms||!e._mount_access_perms.includes("can_edit")):!e.read_only),t.textTagsToUserGeneratedTags=e=>e.map(t.tagTextToTagUserGeneratedTag),t.getTagType=_,t.getTagsInQuery=function(e,t){const i={},s=e.toLowerCase().replace(/,/g," ").split(" ").filter(e=>e.startsWith("#")).map(e=>n(e)),a=s.length;return s.forEach(e=>{var s;const a=t&&t.find(t=>e===t.tag_text),o=a?_(a):"unknown";i[o]=(null!==(s=i[o])&&void 0!==s?s:0)+1}),{numOfTags:a,typeOfTagToCount:i}}})),define("metaserver/static/js/modules/clean/tagging/components/tags_container",["require","exports","tslib","react","classnames","dig-components/chips","metaserver/static/js/modules/clean/react/components/css","metaserver/static/js/modules/clean/teams/components/item_truncation_container/item_truncation_container","metaserver/static/js/modules/clean/tagging/utils","dig-components/icons","dig-components/icons/src","dig-components/tooltips","metaserver/static/js/modules/core/i18n"],(function(e,t,i,s,a,o,r,l,n,d,c,u,g){"use strict";function _(e){return e.map(e=>n.formatTag(e.tag_text)).join(" ")}Object.defineProperty(t,"__esModule",{value:!0}),t.TagsContainer=void 0,s=i.__importDefault(s),a=i.__importDefault(a);const m=e=>{const{tags:t,highlightedIndexes:i=[],onTagClick:r,onTagDelete:m,containerClassName:h,chipClassName:p,chipSize:f}=e;if(0===t.length)return null;const T=t.filter((e,t)=>!i.includes(t)),E=t.filter((e,t)=>i.includes(t));return s.default.createElement(l.ItemTruncationContainer,Object.assign({items:[...E,...T],itemsToMoreTooltipString:_,renderItem:({item:e,ref:t,index:i})=>{const l=i<E.length,_=m?o.InputChip:o.FilterChip,h=n.isSuggestedTag(e),T=h?{withIconLeft:s.default.createElement(d.UIIcon,{src:c.Twinkle2Line,size:"small"})}:{},S=s.default.createElement(_,Object.assign({},T,{key:e.tag_text,ref:t,className:a.default("tag-chip",{highlighted:l},p),onClick:t=>null==r?void 0:r(e,t),onDelete:()=>null==m?void 0:m(e),size:f||"small"}),n.formatTypedTag(e));return h?s.default.createElement(u.Tooltip,{title:g.intl.formatMessage({id:"NXiDuW",defaultMessage:"Dropbox added this tag"})},S):S},className:a.default("tags-container",h)},e))};m.displayName="TagsContainerWithoutCss",t.TagsContainer=r.requireCssWithComponent(m,["/static/css/tagging/tags_container-vfl_m11fQ.css"])})),define("metaserver/static/js/modules/clean/react/files_view/files_view_hooks",["require","exports","tslib","react","metaserver/static/js/modules/core/cancelable_promise","metaserver/static/js/modules/clean/web_timing_logger"],(function(e,t,i,s,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useIsPostTTI=void 0,s=i.__importDefault(s),o=i.__importStar(o),t.useIsPostTTI=()=>{const[e,t]=s.default.useState(!!o.time_to_interactive);return s.default.useEffect(()=>{const e=a.makeCancelable(o.waitForTTI().then(()=>{t(!0)}));return()=>e.cancel()},[]),e}})),define("metaserver/static/js/modules/clean/photos/thumb_loading/buffered_thumb_store",["require","exports","tslib","metaserver/static/js/modules/clean/photos/thumb_loading/generic_thumb_store","metaserver/static/js/modules/clean/web_timing_logger","metaserver/static/js/modules/core/assert"],(function(e,t,i,s,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BufferedThumbStore=void 0,a=i.__importStar(a);t.BufferedThumbStore=class{constructor(e,t){this.isTTI=!1,this.postTTISuccesses=[],this.postTTIErrors=[],this.postTTIRequests=[],this.wrapHandlers=e=>({onSuccess:t=>{this.isTTI?e.onSuccess(t):this.bufferCallbacks(this.postTTISuccesses,e,t)},onRequest:t=>{e.onRequest&&(this.isTTI?e.onRequest(t):this.bufferCallbacks(this.postTTIRequests,e,t))},onError:()=>{e.onError&&(this.isTTI?e.onError():this.bufferErrorCallback(e))}}),this.innerStore=new s.GenericThumbStore(e,t),a.waitForTTI().then(()=>{this.isTTI=!0,this.postTTIRequests.forEach(e=>{const{onRequest:t}=e[0];t&&t(e[1])}),this.postTTIErrors.forEach(e=>e.onError&&e.onError()),this.postTTISuccesses.forEach(e=>e[0].onSuccess(e[1])),this.postTTIRequests=[],this.postTTIErrors=[],this.postTTISuccesses=[]})}get_thumb(e){return this.isTTI?this.innerStore.get_thumb(e):null}is_batching(){return this.innerStore.is_batching()}bind_url(e,t){const i=this.isTTI?t:this.wrapHandlers(t);return this.innerStore.bind_url(e,i)}bufferCallbacks(e,t,i){o.assert(!this.isTTI,"Should not buffer callback after TTI"),e.push([t,i])}bufferErrorCallback(e){o.assert(!this.isTTI,"Should not buffer error callback after TTI"),this.postTTIErrors.push(e)}unbind_url(e){this.innerStore.unbind_url(e)}}})),define("metaserver/static/js/modules/clean/react/selection",["require","exports","tslib","immutable"],(function(e,t,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createSelection=t.Selection=void 0,s=i.__importStar(s);class a extends(s.Record({selected:null,anchor:null},"Selection")){}t.Selection=a,t.createSelection=function(e,t){return new a({selected:e?s.OrderedSet(e):s.OrderedSet(),anchor:t||(e?e[0]:null)})}}));var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,i,s){void 0===s&&(s=i),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,s){void 0===s&&(s=i),e[s]=t[i]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&__createBinding(t,e,i);return __setModuleDefault(t,e),t};define("metaserver/static/js/modules/clean/sharing/public_folder/public_folder",["require","exports","metaserver/static/js/modules/core/uri"],(function(e,t,i){"use strict";function s(e,t){if(e.publicAppToken)return t;if(!e.isPublicFolderEnabled)return null;const i=(e.publicFolderFqPath||"/public").toLowerCase(),s=t.toLowerCase();return s===i?"/":s.startsWith(i+"/")?t.substring(i.length):null}Object.defineProperty(t,"__esModule",{value:!0}),t.showPublicFolderLinkModal=t.makePublicFolderLink=t.shouldUsePublicFolderSharing=void 0,t.shouldUsePublicFolderSharing=function(e,t){return null!=s(e,t)},t.makePublicFolderLink=function(e,t,a,o){if(o)return null;const r=s(t,a);if(null!=r){const s=new i.URI({scheme:"https",authority:"dl.dropboxusercontent.com"});return t.publicAppToken?(s.setPath(`/spa/${t.publicAppToken}${r}/data`),s.toString()):(s.setPath(`/u/${e}${r}`),s.toString())}return null},t.showPublicFolderLinkModal=function(t){return new Promise((i,s)=>{Promise.all([new Promise((t,i)=>{e(["react"],t,i)}).then(__importStar),new Promise((t,i)=>{e(["metaserver/static/js/modules/clean/react/components/modal"],t,i)}).then(__importStar),new Promise((t,i)=>{e(["metaserver/static/js/modules/clean/sharing/public_folder/modal"],t,i)}).then(__importStar)]).then(([e,{Modal:s},{CopyPublicLinkModal:a}])=>{s.showInstance(e.createElement(a,{publicLink:t})),i()})})}})),define("metaserver/static/js/modules/clean/emoji_utils",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFirstEmojiFromTitle=void 0;let i;t.getFirstEmojiFromTitle=function(e){const t=(function(){i||(i=/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|\ud83c[\ude32-\ude3a]|\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]\ufe0f?|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])/g);return i})();t.lastIndex=0;const s=t.exec(e);if(s&&0===s.index){const i=s[0];if("‍"===e[i.length])return"";const a=t.exec(e);return a&&a.index===i.length?"":i||""}return""}})),define("metaserver/static/js/modules/clean/filename_highlights",["require","exports","tslib","classnames","react"],(function(e,t,i,s,a){"use strict";function o(e,t,i,s){if(!t)return[{text:e,isHighlighted:!1}];i||(i=0),s||(s=e.length),t=(function(e,t){if(!t||!t.length)return[];const i=[];let s=0;return t.forEach(t=>{const a=t.pos;a>s&&(s=a);const o=e.indexOf(t.string,s);o>=0&&i.push({pos:o,len:t.string.length,string:t.string})}),i})(e,t);let a=0,o=0;const r=[];for(;a<e.length;){let l,n;const d=t[o];if(o>=t.length?(n=!1,l=a+e.length):d.pos>a?(n=!1,l=d.pos):(n=!0,l=d.pos+d.len),!(a<i&&l<=i||a>=s&&l>=s)){const t=e.substring(Math.max(a,i),Math.min(l,s));r.push({text:t,isHighlighted:n})}a=l,n&&o++}return r}function r(e,t,i,s){if(i||(i=0),s||(s=e.length),!t||!(function(e,t){const i=t.map(e=>e.highlight_str).join("");return e===i})(e,t))return[{text:e.substring(i,s),isHighlighted:!1}];const a=[];let o=0;for(const r of t){const t=e.indexOf(r.highlight_str,o),l=t+r.highlight_str.length;if(o=l,!(t<i&&l<=i||t>=s)){let e=r.highlight_str;t<i&&(e=e.slice(i-t)),s<l&&(e=e.slice(0,-(l-s))),a.push({text:e,isHighlighted:r.is_highlighted})}}return a}function l(e){return a.createElement("span",null,e.map((e,t)=>a.createElement("span",{className:s.default({highlighted:e.isHighlighted,"is-highlighted":e.isHighlighted}),key:t},e.text)))}Object.defineProperty(t,"__esModule",{value:!0}),t.highlightReactFromAllHighlightSpans=t.highlightReactFromHighlightSpans=t.highlightSectionsFromHighlightSpans=t.highlightMatchReact=t.highlightMatchSections=void 0,s=i.__importDefault(s),a=i.__importStar(a),t.highlightMatchSections=o,t.highlightMatchReact=function(e,t,i,s){return l(o(e,t,i,s))},t.highlightSectionsFromHighlightSpans=r,t.highlightReactFromHighlightSpans=function(e,t,i,s){return l(r(e,t,i,s))},t.highlightReactFromAllHighlightSpans=function(e){return l(e.map(({highlight_str:e,is_highlighted:t})=>({text:e,isHighlighted:t})))}})),define("metaserver/static/js/modules/clean/paper_formatting_utils",["require","exports","tslib","metaserver/static/js/modules/clean/emoji_utils","react","metaserver/static/js/modules/clean/filename_highlights","spectrum/icon_content/index"],(function(e,t,i,s,a,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPaperDocTitleParts=void 0,s=i.__importStar(s),a=i.__importDefault(a),o=i.__importStar(o),t.getPaperDocTitleParts=function(e,t,i,l){let{title:n,highlight_spans:d,title_highlights:c}=e;const u=d&&d.length>0,g=s.getFirstEmojiFromTitle(n);if(g)if(n=n.substr(g.length),u){const e={highlight_str:d[0].highlight_str.substr(g.length),is_highlighted:d[0].is_highlighted};d=[e,...d.slice(1)]}else if(c){const e=g.length/2;c=c.slice().map(t=>({pos:t.pos-e,len:t.string.length,string:t.string}))}let _;return _=u?o.highlightReactFromHighlightSpans(n,d):o.highlightMatchReact(n,c),{title:n,highlightedTitle:_,icon:(function(e,t,i,s){return e?a.default.createElement("div",{className:"mc-media-cell-icon brws-file-name-icon-emoji-container"},a.default.createElement(r.IconContent,{name:s?"blank-large":"blank-small",className:t}),a.default.createElement("span",{className:i},e)):a.default.createElement(r.IconContent,{name:s?"paper-large":"paper-small",className:t})})(g,t,i,l)}}})),define("metaserver/static/js/modules/clean/sharing/browse_exports",["require","exports","tslib","metaserver/static/js/modules/clean/sharing/access_level","metaserver/static/js/modules/clean/sharing/async_share_modal_util","metaserver/static/js/modules/clean/sharing/public_folder/public_folder","metaserver/static/js/modules/clean/sharing/wizard/async_wizard_modals"],(function(e,t,i,s,a,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.asyncShowShareAFolderWizardModal=t.showPublicFolderLinkModal=t.shouldUsePublicFolderSharing=t.makePublicFolderLink=t.asyncShowPrefilledShareModal=t.asyncShowNewFolderShareModal=t.asyncShowShareModal=t.asyncShowAppropriateNewFolderModalForCdmUser=t.asyncShowMultiFolderPermissionsAtUploadModal=t.asyncShowCdmNewFolderViaUploadModal=t.asyncShowCdmNewFolderModal=t.asyncMountSharedFolder=void 0,t.asyncMountSharedFolder=function(...t){new Promise((t,i)=>{e(["metaserver/static/js/modules/clean/sharing/shared_content_link_mount_folder"],t,i)}).then(i.__importStar).then(({mountSharedFolder:e})=>{e(...t)})},t.asyncShowCdmNewFolderModal=function({handleCreateFolder:t,user:s,context:a,shouldSyncDefault:o,shouldDisplaySyncSettings:r,shouldDisplayAudienceInput:l,defaultInputFolderName:n,autoTeamGroupDefaultAccessLevel:d,redirectOnCancel:c,useDigModal:u=!0,isConfidential:g=!1}){new Promise((t,i)=>{e(["metaserver/static/js/modules/clean/sharing/cdm_new_folder_modal"],t,i)}).then(i.__importStar).then(e=>{e.showCdmNewFolderModal(t,s,a,o,r,l,d,n,c,u,g)})},t.asyncShowCdmNewFolderViaUploadModal=function(t,a,o,r,l,n,d){return i.__awaiter(this,void 0,void 0,(function*(){(yield new Promise((t,i)=>{e(["metaserver/static/js/modules/clean/sharing/cdm_new_folder_modal"],t,i)}).then(i.__importStar)).showCdmNewFolderViaUploadModal(t,a,o,!0,s.ACCESS_LEVEL.WRITER,r,l,n,d)}))},t.asyncShowMultiFolderPermissionsAtUploadModal=function(t){return i.__awaiter(this,void 0,void 0,(function*(){(yield new Promise((t,i)=>{e(["metaserver/static/js/modules/clean/sharing/multifolder_permissions_at_upload/modal"],t,i)}).then(i.__importStar)).showMultiFolderPermissionsAtUploadModal(t)}))},t.asyncShowAppropriateNewFolderModalForCdmUser=function(t){return i.__awaiter(this,void 0,void 0,(function*(){(yield new Promise((t,i)=>{e(["metaserver/static/js/modules/clean/sharing/cdm_new_folder_modal_util"],t,i)}).then(i.__importStar)).showAppropriateNewFolderModalForCdmUser(t)}))},Object.defineProperty(t,"asyncShowShareModal",{enumerable:!0,get:function(){return a.asyncShowShareModal}}),Object.defineProperty(t,"asyncShowNewFolderShareModal",{enumerable:!0,get:function(){return a.asyncShowNewFolderShareModal}}),Object.defineProperty(t,"asyncShowPrefilledShareModal",{enumerable:!0,get:function(){return a.asyncShowPrefilledShareModal}}),Object.defineProperty(t,"makePublicFolderLink",{enumerable:!0,get:function(){return o.makePublicFolderLink}}),Object.defineProperty(t,"shouldUsePublicFolderSharing",{enumerable:!0,get:function(){return o.shouldUsePublicFolderSharing}}),Object.defineProperty(t,"showPublicFolderLinkModal",{enumerable:!0,get:function(){return o.showPublicFolderLinkModal}}),Object.defineProperty(t,"asyncShowShareAFolderWizardModal",{enumerable:!0,get:function(){return r.asyncShowShareAFolderWizardModal}})})),define("metaserver/static/js/modules/clean/sharing/content_manager",["require","exports","tslib","metaserver/static/js/modules/core/uri","metaserver/static/js/modules/clean/filepath/filepath","metaserver/static/js/modules/core/browser"],(function(e,t,i,s,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.goToContentManagerForPath=t.genContentManagerBridgeUri=void 0,o=i.__importStar(o),t.genContentManagerBridgeUri=function({containingFolder:e,filenameToSelect:t}){let i;return e=a.normalize(e)||"",t&&(i=[e,t].join("/")),new s.URI({path:`/team/admin/content/home${e}`,query:i?{select:i}:void 0})},t.goToContentManagerForPath=function(e){const i=t.genContentManagerBridgeUri(e);o.open_tab(i.toString())}})),define("metaserver/static/js/modules/clean/react/path_filter_button",["require","exports","tslib","react","spectrum/dropdown_button/index","metaserver/static/js/modules/clean/react/title_bubble","metaserver/static/js/modules/clean/em_string","metaserver/static/js/modules/clean/filepath/filepath","dig-components/tooltips","metaserver/static/js/modules/clean/react/sticky_position","dig-components/buttons","dig-components/chips"],(function(e,t,i,s,a,o,r,l,n,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PathFilterButton=void 0,s=i.__importDefault(s),l=i.__importStar(l),t.PathFilterButton=({path:e,defaultText:t,dropdownClasses:i,disabled:g,onClick:_,useDigComponents:m,id:h,label:p,useButtonComponent:f})=>{const T=e&&!l.paths_are_equal(e,"/")?r.Emstring.em_snippet(l.filename(e),10,.6):null;if(m){const a=f?s.default.createElement(c.Button,{variant:"outline",className:i,disabled:g,onClick:_,id:h,"aria-labelledby":`${p} ${h}`,withDropdownIcon:!0},T||t):s.default.createElement(u.FilterChip,{className:i,disabled:g,onClick:_,id:h,"aria-labelledby":`${p} ${h}`,isSelected:!!T},T||t);return e&&T?s.default.createElement(n.Tooltip,{title:e,placement:"bottom"},a):a}const E=s.default.createElement(a.DropdownButton,{className:i,disabled:g,onClick:_,id:h,"aria-labelledby":`${p} ${h}`},T||t);return T?s.default.createElement(o.TitleBubble,{content:e,position:d.StickyPosition.BOTTOM},E):E}})),define("typescript/component_libraries/flows/src/common/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})),define("metaserver/static/js/modules/clean/react/files_view/file_name/renaming_bar_api_v2",["require","exports","tslib","metaserver/static/js/api_v2/user_client"],(function(e,t,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRules=t.namingConventionsFilePreview=t.dismissRenamingBar=t.shouldShowRenamingBar=void 0,t.shouldShowRenamingBar=e=>i.__awaiter(void 0,void 0,void 0,(function*(){return(new s.UserApiV2Client).ns("naming_conventions").rpc("feature_adoption/should_show",void 0,{subjectUserId:e})})),t.dismissRenamingBar=e=>i.__awaiter(void 0,void 0,void 0,(function*(){const t=new s.UserApiV2Client;yield t.ns("naming_conventions").rpc("feature_adoption/dismiss",{reset:!1},{subjectUserId:e})})),t.namingConventionsFilePreview=(e,t,a)=>i.__awaiter(void 0,void 0,void 0,(function*(){const i=new s.UserApiV2Client,o={rules_struct:{component_list:[{".tag":"upload_date",ml_identification:!1,date_format:{".tag":"yyyy_mm_dd"}},{".tag":"original_snippet",original_snippet:{".tag":"original_snippet"}}],capitalize_all_initials:{".tag":"capitalize_all_initials"},change_all_separators:{".tag":"spaces"}},original_source_path:t,user_typed_filename:a};return i.ns("naming_conventions").rpc("file_preview",o,{subjectUserId:e})})),t.getRules=(e,t)=>i.__awaiter(void 0,void 0,void 0,(function*(){return t=a(t),(new s.UserApiV2Client).ns("naming_conventions").rpc("get_rules",{source_path:t},{subjectUserId:e})}));const a=e=>"/"===e?"":e})),define("metaserver/static/js/modules/clean/business_space/browse/data/store",["require","exports","metaserver/static/js/modules/clean/business_space/browse/data/reducer","metaserver/static/js/modules/clean/redux/namespaces","metaserver/static/js/modules/clean/redux/store"],(function(e,t,i,s,a){"use strict";let o;Object.defineProperty(t,"__esModule",{value:!0}),t.getStoreForClientPortal=void 0,t.getStoreForClientPortal=()=>(o||(o=a.getStoreAndRegisterReducers({[s.CLIENT_PORTAL_NAMESPACE_KEY]:i.clientPortalReducer})),o)})),define("metaserver/static/js/modules/clean/business_space/browse/data/reducer",["require","exports","metaserver/static/js/modules/clean/business_space/browse/data/types"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clientPortalReducer=t.defaultClientPortalState=void 0,t.defaultClientPortalState={businessSpaceInfo:{found:!1,business_space_xgid:"",is_business_space_root:!1,business_space_name:"",space_xid:"",client_portal_url:"",visibilities:new Map},selectedFileBusinessSpaceInfo:{found:!1,business_space_xgid:"",is_business_space_root:!1,business_space_name:"",space_xid:"",client_portal_url:""}};t.clientPortalReducer=function(e=t.defaultClientPortalState,s){switch(s.type){case i.ActionTypes.SET_BUSINESS_SPACE_INFO:return((e,{found:t,business_space_xgid:i,is_business_space_root:s,business_space_name:a,space_xid:o=""})=>Object.assign(Object.assign({},e),{businessSpaceInfo:Object.assign(Object.assign({},e.businessSpaceInfo),{found:t,business_space_xgid:i,is_business_space_root:s,business_space_name:a,space_xid:o})}))(e,s.payload);case i.ActionTypes.SET_LOGINLESS_LINK:return((e,{client_portal_url:t,space_xid:i})=>Object.assign(Object.assign({},e),{businessSpaceInfo:Object.assign(Object.assign({},e.businessSpaceInfo),{client_portal_url:t,space_xid:i})}))(e,s.payload);case i.ActionTypes.SET_VISIBILITIES:return((e,{objects_visibility:t})=>{const i=e.businessSpaceInfo.visibilities||new Map;return t&&t.forEach(e=>{e.full_path&&e.visibility&&e.visibility[".tag"]&&i.set(e.full_path,e.visibility[".tag"])}),Object.assign(Object.assign({},e),{businessSpaceInfo:Object.assign(Object.assign({},e.businessSpaceInfo),{visibilities:i})})})(e,s.payload);case i.ActionTypes.SET_SELECTED_FILE_BUSINESS_SPACE_INFO:return((e,{found:t,business_space_xgid:i,is_business_space_root:s,business_space_name:a,space_xid:o="",client_portal_url:r=""})=>Object.assign(Object.assign({},e),{selectedFileBusinessSpaceInfo:Object.assign(Object.assign({},e.selectedFileBusinessSpaceInfo),{found:t,business_space_xgid:i,business_space_name:a,is_business_space_root:s,space_xid:o,client_portal_url:r})}))(e,s.payload);case i.ActionTypes.SET_SELECTED_FILE_LOGINLESS_LINK:return((e,{client_portal_url:t,space_xid:i})=>Object.assign(Object.assign({},e),{selectedFileBusinessSpaceInfo:Object.assign(Object.assign({},e.selectedFileBusinessSpaceInfo),{client_portal_url:t,space_xid:i})}))(e,s.payload);default:return e}}})),define("metaserver/static/js/modules/clean/business_space/browse/data/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionTypes=void 0,(function(e){e.SET_BUSINESS_SPACE_INFO="BUSINESS_SPACE/SET_BUSINESS_SPACE_INFO",e.SET_LOGINLESS_LINK="BUSINESS_SPACE/SET_LOGINLESS_LINK",e.SET_VISIBILITIES="BUSINESS_SPACE/SET_VISIBILITIES",e.SET_SELECTED_FILE_BUSINESS_SPACE_INFO="BUSINESS_SPACE/SET_SELECTED_FILE_BUSINESS_SPACE_INFO",e.SET_SELECTED_FILE_LOGINLESS_LINK="BUSINESS_SPACE/SET_SELECTED_FILE_LOGINLESS_LINK"})(t.ActionTypes||(t.ActionTypes={}))}));
//# sourceMappingURL=pkg-browse-utils.min.js-vflYgRTSY.map