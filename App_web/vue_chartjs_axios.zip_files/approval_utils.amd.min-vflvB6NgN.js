define(["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getApprovers=t.canRespondToApproval=t.findActionableApprovalCommentId=t.getApprovalRequestsSubtext=t.getApprovalRequestCounts=t.isApprovalRequester=t.isApprovalThread=t.getApprovalMetadata=void 0,t.getApprovalMetadata=e=>{for(const t of e)if("approval"===t.type)return t},t.isApprovalThread=e=>!!t.getApprovalMetadata(e.comments[e.comments.length-1].content.metadata),t.isApprovalRequester=e=>{const a=t.getApprovalMetadata(e.comments[e.comments.length-1].content.metadata);return"requester"===(null==a?void 0:a.actor)};const a=e=>{const a=t.getApprovalMetadata(e.comments[e.comments.length-1].content.metadata),o=null==a?void 0:a.approvers,r=null==a?void 0:a.requires_all;let n=0;if(!o)return 0;for(const e of o)if("approved"!==e.overall_status)n++;else if(!r)return 0;return r?n:1};t.getApprovalRequestCounts=e=>{let o=0,r=0;for(const n of e){const e=a(n);0!==e&&(o+=e),t.isApprovalThread(n)&&r++}return[o,r]},t.getApprovalRequestsSubtext=(e,t)=>t.formatMessage({id:"sj45d1",defaultMessage:"{openRequestsCount} {openRequestsCount, plural, one {approval request} other {approval requests}} open"},{openRequestsCount:e}),t.findActionableApprovalCommentId=e=>{const a=e.comments.filter(e=>!e.deleted),o=t.getApprovalMetadata(a[0].content.metadata),r=null==o?void 0:o.actor;if("requester"===r){const e=a[a.length-1],o=t.getApprovalMetadata(e.content.metadata);if("request"===(null==o?void 0:o.approval_type))return e.id;for(let e=a.length-1;e>=0;e--){const o=a[e],r=t.getApprovalMetadata(o.content.metadata);if("request"===(null==r?void 0:r.approval_type))return;if("response"===(null==r?void 0:r.approval_type)&&"rejected"===(null==r?void 0:r.status))return o.id}}if("approver"===r)for(let e=a.length-1;e>=0;e--){const o=a[e],r=t.getApprovalMetadata(o.content.metadata),n=a[e].userPermissions.canEdit;if("request"===(null==r?void 0:r.approval_type))return o.id;if("response"===(null==r?void 0:r.approval_type)&&n)return o.id}},t.canRespondToApproval=e=>{const a=t.getApprovalMetadata(e.content.metadata);return"request"===(null==a?void 0:a.approval_type)&&"approver"===(null==a?void 0:a.actor)&&!e.userPermissions.canEdit&&!e.userPermissions.canDelete},t.getApprovers=e=>{const a=t.getApprovalMetadata(e.comments[e.comments.length-1].content.metadata);return null==a?void 0:a.approvers}}));
//# sourceMappingURL=approval_utils.amd.min.js-vfl19995L.map