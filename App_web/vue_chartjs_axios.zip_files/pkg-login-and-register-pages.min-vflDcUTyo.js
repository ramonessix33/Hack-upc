define("metaserver/static/js/modules/clean/abuse/captcha_helper",["require","exports","tslib","metaserver/static/js/modules/constants/login_and_register","metaserver/static/js/modules/constants/page_load","metaserver/static/js/modules/clean/web_timing_logger","metaserver/static/js/modules/core/assert","metaserver/static/js/modules/core/exception","metaserver/static/js/modules/core/uri"],(function(e,t,s,a,r,o,i,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DUMMY_RESPONSE=t.BuildRecaptchaURI=t.isTest=t.LoadRecaptcha=t.ClearCaptchaPromise=t.HasCaptchaLoaded=t.captchaPromise=void 0,a=s.__importStar(a),n=s.__importStar(n);let c=!1;function u(){const e={onload:"recaptchaOnloadCallback",render:"explicit",hl:r.USER_LOCALE.replace("_","-")};return new l.URI({scheme:"https",authority:"www.google.com",path:"/recaptcha/api.js",query:e}).toString()}function m(){return new Promise((r,o)=>{if(window.recaptchaOnloadCallback=function(){r(window.grecaptcha)},a.SHOULD_LOAD_FUNCAPTCHA&&c&&new Promise((t,s)=>{e(["metaserver/static/js/modules/clean/abuse/funcaptcha_modal"],t,s)}).then(s.__importStar).then(({loadFuncaptchaModal:e,recordFunCaptchaLoadingStats:t})=>{const s=performance.now();let a,r="",o=!1;try{e(),o=!0}catch(e){r=e.message}finally{a=performance.now()}t("funcaptcha_modal_loading",a-s,o,r)}),t.isTest())r(f);else{const e=document.createElement("script"),t=u();e.setAttribute("src",t);const s=window.CSP_SCRIPT_NONCE;if(!s)return n.reportException({err:new Error("CSP nonce not set"),severity:n.SEVERITY.CRITICAL,tags:["product-safety-infra","recaptcha"]}),void o();e.setAttribute("nonce",s),document.body.appendChild(e)}})}t.HasCaptchaLoaded=function(){return null!=t.captchaPromise},t.ClearCaptchaPromise=function(){t.captchaPromise=null},t.LoadRecaptcha=function(e,s){return void 0!==s&&(c=s),t.captchaPromise||(t.captchaPromise=e?new Promise((e,t)=>{o.waitForTTI().then(e),setTimeout(e,2500)}).then(m):m()),t.captchaPromise},t.isTest=()=>a.IS_SELENIUM_TEST,t.BuildRecaptchaURI=u;const d={},p={};let g=0;t.DUMMY_RESPONSE="DUMMY-RESPONSE";const h=e=>{e.setAttribute("class","g-recaptcha-response"),e.setAttribute("name","g-recaptcha-response"),e.value=""},f={reset(e){const t=p[e].querySelector(".g-recaptcha-response");return h(t),!0},render(e,s,a){const r=g;g+=1,i.assert(null==e.querySelector(".g-recaptcha-response"),"can't render multiple recaptcha elements in same div");const o=document.createElement("textarea");return o.id=`g-recaptcha-response-${r}`,h(o),e.appendChild(o),p[r]=e,d[r]=()=>{const e=t.DUMMY_RESPONSE;return o.value=e,s.callback&&s.callback(e),e},r},execute:e=>Promise.resolve(d[e]())}})),define("metaserver/static/js/modules/clean/auth/common/captcha",["require","exports","tslib","classnames","react","metaserver/static/js/modules/clean/react/components/css","metaserver/static/js/modules/clean/abuse/captcha_helper"],(function(e,t,s,a,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Captcha=t.CaptchaComponent=t.clear_captcha_response=t.handle_captcha_errors=t.get_captcha_responses=void 0,a=s.__importDefault(a),r=s.__importDefault(r),t.get_captcha_responses=function(e){const t=e.getWrappedComponent();return{"g-recaptcha-response":t.recaptcha_response,"funcaptcha-response":t.funcaptcha_response}},t.handle_captcha_errors=function(e,t,s){return e.getWrappedComponent().handle_captcha_errors(t,s)},t.clear_captcha_response=function(e){return e.getWrappedComponent().clear_captcha_response()};class n extends r.default.Component{constructor(e){super(e)}handle_captcha_errors(t,a){return!(!t||!t.funcaptcha_response)&&(new Promise((t,s)=>{e(["metaserver/static/js/modules/clean/abuse/funcaptcha_modal"],t,s)}).then(s.__importStar).then(({openFuncaptchaModal:e})=>{e(this.props.email||"",a||this.props.source,e=>{this.funcaptcha_response=e,this.props.onSubmit()},this.props.onReady)}),!0)}clear_captcha_response(){this.funcaptcha_response=void 0}componentDidMount(){i.LoadRecaptcha(void 0,!0)}render(){return r.default.createElement("div",{ref:"container_div",className:a.default({"recaptcha-v2-challenge-container":!0,"recaptcha-v2-challenge-container--invisible":!0})},r.default.createElement("div",{ref:"captcha_div",className:"recaptcha_v2_challenge"}))}submit(){this.clear_captcha_response(),this.props.onSubmit()}}t.CaptchaComponent=n,n.displayName="CaptchaComponent",t.Captcha=o.requireCssWithComponent(n,["/static/css/recaptcha-vflIN6j39.css"])})),define("metaserver/static/js/modules/clean/auth/common/utils",["require","exports","tslib","metaserver/static/js/modules/clean/auth/login/types","metaserver/static/js/modules/clean/auth/register/types","metaserver/static/js/modules/constants/page_load","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/core/notify","metaserver/static/js/modules/core/uri","metaserver/static/js/modules/clean/form_util/name_parser","metaserver/static/js/modules/clean/marketing_tracker"],(function(e,t,s,a,r,o,i,n,l,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pushMarketingEvent=t.notifyCaptchaNotLoaded=t.twoFactorRecoveryUrl=t.getFormattedName=t.lastNameGoesFirst=t.genErrorId=t.generateId=void 0,c=s.__importDefault(c),t.generateId=e=>e+Math.random().toString().slice(2),t.genErrorId=e=>`${e}__input-error`;const m=["ja","ko","zh"];t.lastNameGoesFirst=()=>m.includes(o.USER_LOCALE.slice(0,2)),t.getFormattedName=(e,s,a)=>{if(!a)return[e,s];const[r,o]=c.default.splitFullName(e);return t.lastNameGoesFirst()?o?[o,r]:[e,s]:[r,o]},t.twoFactorRecoveryUrl=(e,t)=>{const s=new l.URI({path:"/twofactor_recovery"});return e&&s.updateQuery({remember_me:e.toString()}),t&&!["/",""].includes(t)&&s.updateQuery({cont:t}),s.toString()},t.notifyCaptchaNotLoaded=()=>{n.Notify.warning(i.intl.formatMessage({id:"977N0X",defaultMessage:"Your browser appears to be blocking dropboxcaptcha.com, which is required for authentication. To resolve this issue, please update any anti-virus or ad-blocking software settings to allow connections to dropboxcaptcha.com."}))},t.pushMarketingEvent=(e,t)=>{let s;switch(e){case a.LoginFormEvent.LOGIN_CLICK:case a.LoginFormEvent.GOOGLE_LOGIN_CLICK:case a.LoginFormEvent.APPLE_LOGIN_CLICK:case r.RegisterFormEvent.REGISTER_CLICK:case r.RegisterFormEvent.GOOGLE_REGISTER_CLICK:if(!t)return;s={form_event:e},u.MarketingTracker.tryPushEvent("conversionDataReady",u.EventTypeEnum.Link,s);break;case a.LoginFormEvent.LOGIN_IMMEDIATE_SUCCESS:case a.LoginFormEvent.GOOGLE_LOGIN_SUCCESS:case a.LoginFormEvent.APPLE_LOGIN_SUCCESS:s=u.getGAEventData(u.MARKETING_LOGIN_EVENT,u.MARKETING_LOGIN_EVENT),u.MarketingTracker.tryPushEvent(u.MARKETING_LOGIN_EVENT,u.EventTypeEnum.Link,s);break;case r.RegisterFormEvent.REGISTER_IMMEDIATE_SUCCESS:case r.RegisterFormEvent.GOOGLE_REGISTER_SUCCESS:s=u.getGAViewData(u.MARKETING_REGISTER_EVENT,"ga_register_pageview","/virtual/ga_register_pageview"),u.MarketingTracker.tryPushEvent(u.MARKETING_REGISTER_EVENT,u.EventTypeEnum.View,s)}}})),define("metaserver/static/js/modules/clean/auth/common/error",["require","exports","tslib","dompurify","react"],(function(e,t,s,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthError=void 0,a=s.__importDefault(a),r=s.__importDefault(r);class o extends r.default.Component{shouldComponentUpdate(e){return this.hasNewError(e.error)}hasNewError(e){var t;return!this.hasMatchingErrorMessage(e)||(null==e?void 0:e.clientTimestamp)!==(null===(t=this.props.error)||void 0===t?void 0:t.clientTimestamp)}hasMatchingErrorMessage(e){var t,s;return(null==e?void 0:e.message_html)===(null===(t=this.props.error)||void 0===t?void 0:t.message_html)&&(null==e?void 0:e.message_text)===(null===(s=this.props.error)||void 0===s?void 0:s.message_text)}render(){const{error:e,errorId:t}=this.props;return e&&e.message_html?r.default.createElement("div",{id:t,"aria-live":"polite","aria-atomic":"true",className:"text-input-error-wrapper",dangerouslySetInnerHTML:{__html:a.default.sanitize(e.message_html)}}):e&&e.message_text?r.default.createElement("div",{id:t,"aria-live":"polite","aria-atomic":"true",className:"text-input-error-wrapper"},r.default.createElement("span",{className:"error-message"},e.message_text,r.default.createElement("span",{className:"text-input-error-hidden ax-visually-hidden","aria-hidden":"true",style:{visibility:"hidden"}},e.clientTimestamp))):r.default.createElement("div",{id:t,"aria-live":"polite","aria-atomic":"true",className:"text-input-error-wrapper"})}}t.AuthError=o,o.displayName="AuthError"})),define("metaserver/static/js/modules/clean/auth/common/inputs/checkbox",["require","exports","tslib","dompurify","react","classnames","metaserver/static/js/modules/clean/auth/common/error","metaserver/static/js/modules/clean/auth/common/utils","metaserver/static/js/modules/clean/auth/common/types","dig-components/form_row","dig-components/controls","dig-components/icons","dig-components/icons/src"],(function(e,t,s,a,r,o,i,n,l,c,u,m,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthCheckbox=void 0,a=s.__importDefault(a),r=s.__importStar(r),o=s.__importDefault(o);const p=e=>{const{label:t,htmlFor:s,unsafeLabelHTML:o}=e;return t?r.default.createElement("label",{htmlFor:s,className:"checkbox_label"},r.default.createElement("span",null,t)):o?r.default.createElement("label",{htmlFor:s,className:"checkbox_label"},r.default.createElement("span",{dangerouslySetInnerHTML:{__html:a.default.sanitize(o)}})):null},g=e=>{const{name:t,error:s,label:o,onChange:i,className:n,checked:l,id:g,errorId:h}=e,f=s&&(s.message_text||s.message_html);return r.default.createElement("div",{className:"auth__checkbox-row"},r.default.createElement(c.FormRow,{variant:"control"},r.default.createElement(u.Checkbox,{className:n,name:t,id:g,onChange:i,checked:l,"aria-checked":l,"aria-invalid":f?"true":"false","aria-describedby":h}),r.default.createElement(p,{htmlFor:g,label:o})),r.default.createElement("div",{id:h,"aria-live":"polite","aria-atomic":"true"},f&&r.default.createElement(c.FormHelperText,{isInvalid:!0},r.default.createElement(m.UIIcon,{src:d.FailLine,size:"small"}),(null==s?void 0:s.message_html)?r.default.createElement("span",{dangerouslySetInnerHTML:{__html:a.default.sanitize(s.message_html)}}):r.default.createElement("span",null,null==s?void 0:s.message_text))))};t.AuthCheckbox=e=>{const{checked:t,className:s,disabled:a,error:c,inline:u,label:m,maestroStyle:d,name:h,onChange:f,unsafeLabelHTML:_,variant:E}=e,S=r.useMemo(()=>n.generateId(h),[h]),b=r.useMemo(()=>n.genErrorId(S),[S]),v=c&&(c.message_text||c.message_html);if(E===l.AuthFormVariant.DIG20)return r.default.createElement(g,Object.assign({},e,{id:S,errorId:b}));const y=o.default("checkbox",E,s,{"checkbox-inline":u});let C=r.default.createElement("input",{type:"checkbox",id:S,name:h,checked:t,onChange:f,disabled:a,"aria-invalid":v?"true":"false","aria-describedby":b});d&&(C=r.default.createElement("label",{className:"maestro_checkbox",htmlFor:S},C,r.default.createElement("span",null)));const w=r.default.createElement(i.AuthError,{error:c,errorId:b});return r.default.createElement("div",{className:y},!d&&w,C,r.default.createElement(p,{htmlFor:S,label:m,unsafeLabelHTML:_}),d&&w)},t.AuthCheckbox.displayName="AuthCheckbox"})),define("metaserver/static/js/modules/clean/auth/common/inputs/text",["require","exports","tslib","classnames","react","dompurify","metaserver/static/js/modules/core/i18n","classnames","metaserver/static/js/modules/clean/auth/common/error","metaserver/static/js/modules/clean/auth/common/types","metaserver/static/js/modules/clean/auth/common/utils","metaserver/static/js/modules/clean/components/password_strength_meter","dig-components/text_fields","dig-components/form_row","dig-components/icons","dig-components/icons/src","metaserver/static/js/modules/clean/react/input_dig"],(function(e,t,s,a,r,o,i,n,l,c,u,m,d,p,g,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthTextField=void 0,a=s.__importDefault(a),r=s.__importStar(r),o=s.__importDefault(o),n=s.__importDefault(n);const _=e=>{const t=a.default("text-input-input",e.className,{"input-error":e.hasError,"numeric-input":e.type===c.AuthTextInputType.NUMBER}),s=e.passwordStrengthProps||{},o=i.intl.formatMessage({id:"/uvN/C",defaultMessage:"Good passwords are hard to guess. Use uncommon words or inside jokes, non-standard uPPercasing, creative spelllling, and non-obvious numbers and symbols"});return r.default.createElement("div",{className:"text-input-wrapper"},(!e.value||e.persistLabel)&&r.default.createElement("label",{className:a.default({"persistent-label":e.persistLabel}),htmlFor:e.id},e.placeholder),r.default.createElement("input",{id:e.id,type:e.type,className:t,name:e.name,value:e.value,onChange:e.onChange,disabled:e.disabled,autoFocus:e.autoFocus,autoComplete:e.autoComplete?"on":"off","aria-describedby":e.errorId,"aria-invalid":e.hasError?"true":"false",inputMode:e.type===c.AuthTextInputType.NUMBER?"numeric":"text",onKeyDown:e.type===c.AuthTextInputType.NUMBER?e=>{!0===e.ctrlKey||!0===e.metaKey||8===e.keyCode||46===e.keyCode||9===e.keyCode||13===e.keyCode||e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=105||144===e.keyCode||37===e.keyCode||39===e.keyCode||e.preventDefault()}:void 0}),e.type===c.AuthTextInputType.PASSWORD&&e.measureStrength&&r.default.createElement(m.PasswordStrengthMeter,{password:e.value||"",zxcvbnPostTti:!0,className:e.variant,bubblePosition:s.position,bubbleDescription:s.description||o,bubbleClassName:s.className}))},E=e=>{const{disabled:t,name:s,placeholder:a,error:i,onChange:l,measureStrength:c,type:u,errorId:m}=e,_=!(!i||!i.message_text&&!i.message_html);return r.default.createElement("div",{className:"auth__input-wrapper"},c?r.default.createElement(f.password,{name:"password",className:n.default("auth__password-input",{"is-invalid":_}),measureStrength:!0,placeholder:a,onChange:l,"aria-describedby":m,"aria-invalid":_?"true":"false"}):r.default.createElement(d.TextInput,{disabled:t,isInvalid:_,name:s,onChange:l,placeholder:a,wrapperProps:{className:"auth__input-field"},type:u,"aria-describedby":m,"aria-invalid":_?"true":"false"}),r.default.createElement("div",{id:m,"aria-live":"polite","aria-atomic":"true"},_&&r.default.createElement(p.FormHelperText,{isInvalid:!0},r.default.createElement(g.UIIcon,{src:h.FailLine,size:"small"}),(null==i?void 0:i.message_html)?r.default.createElement("span",{dangerouslySetInnerHTML:{__html:o.default.sanitize(i.message_html)}}):r.default.createElement("span",null,null==i?void 0:i.message_text))))};t.AuthTextField=e=>{const{name:t,variant:s,error:o,maestroStyle:i,onChange:n,value:m,disabled:d,inputClassName:p,type:g,placeholder:h,measureStrength:f,passwordStrengthProps:S,autoComplete:b,autoFocus:v,label:y,className:C}=e,w=r.useMemo(()=>u.generateId(t),[t]),L=r.useMemo(()=>u.genErrorId(w),[w]);if(s===c.AuthFormVariant.DIG20)return r.default.createElement(E,Object.assign({},e,{errorId:L}));const R=i?null:C,T=a.default("text-input",s,R),M=e.styledError,A=M?r.default.createElement(M,{id:L}):r.default.createElement(l.AuthError,{errorId:L,error:o}),N=!!(M||o&&(o.message_html||o.message_text)),I=r.default.createElement("div",{className:T},!i&&A,r.default.createElement(_,{id:w,errorId:L,name:t,onChange:n,value:m,disabled:d,className:p,hasError:N,variant:s,type:g,placeholder:h,measureStrength:f,passwordStrengthProps:S,autoComplete:b||!1,autoFocus:v||!1,persistLabel:!!e.persistLabel}),i&&A);if(!i)return I;const O=a.default(C,{"register-form__name-field":"email"!==g&&"password"!==g,"register-form__field":"email"===g||"password"===g});return r.default.createElement("div",{className:O},y&&r.default.createElement("label",{className:"register-form__field-label",htmlFor:w},y),I)},t.AuthTextField.displayName="AuthTextField"})),define("metaserver/static/js/modules/clean/auth/common/stats",["require","exports","tslib","metaserver/static/js/modules/clean/analytics","metaserver/static/js/modules/core/browser","metaserver/static/js/modules/core/browser_detection","metaserver/static/js/modules/core/exception","metaserver/static/js/modules/clean/auth/login/types","metaserver/static/js/modules/clean/metrics/index"],(function(e,t,s,a,r,o,i,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logUXAnalytics=t.AppleUXAnalyticsLogger=t.GoogleUXAnalyticsLogger=t.EmailAuthUXAnalyticsLogger=t.AuthUXAnalyticsLogger=t.AuthAMPLogger=t.AuthType=void 0,r=s.__importStar(r),o=s.__importStar(o);var c;(function(e){e.CREDENTIALS="email",e.GOOGLE="google_auth",e.APPLE="apple_auth"})(c=t.AuthType||(t.AuthType={}));const u=new Set(["form_error","user_exists","access_denied","tfa_required","sso_required","emails_do_not_match_redirect"]),m=new Set(["enable_twofactor_required","emails_do_not_match","emails_do_not_match_redirect","not_verified","email_not_verified","google_login_not_allowed","access_denied","disabled_account","tos_required","sso_required","no_email_in_response","requires_password_on_first_link","apple_login_not_allowed","apple_login_not_allowed_for_teams","user_cancelled_authorize"]);function d(e){return{url:r.get_href(),status:e.status?e.status:void 0}}function p(e){return{url:r.get_href(),remember_me:e.remember_me?e.remember_me.toString():void 0,pair_user:e.pair_user?e.pair_user.toString():void 0,err_msg:e.err_msg?e.err_msg:void 0}}function g(e,t){return e&&t.has(e)?e:"unknown"}function h(){const e=[[o.chrome,"chrome"],[o.edge,"edge"],[o.mozilla,"firefox"],[o.msie,"msie"],[o.safari,"safari"]];let t="other";for(const[s,a]of e)if(s){t=a;break}return t}function f(e,t,s=1){try{l.getMetricsReporter().createStats({ns:"web_auth",name:e},Object.assign(Object.assign({},t),{browser:h()})).record(s)}catch(s){i.reportException({err:s,severity:i.SEVERITY.NONCRITICAL,tags:["web_auth_amp_logging","acquisition_eng"],exc_extra:Object.assign({metricName:e},t)})}}function _(e,t){a.UXAnalyticsLogger.log(e,t)}t.AuthAMPLogger={logSignupIntent(){f("signup/intent",{},1)},logSignupAttempt(e){f("signup/attempt",{authType:e},1)},logSignupResponse(e,t,s){"funcaptcha_response"!==s?t?f("signup/success",{authType:e},1):(f("signup/success",{authType:e},0),f("signup/failure",{authType:e,error:g(s,u)},1)):f("signup/failure",{authType:e,error:s},1)},logLoginIntent(e){f("login/intent",{loginType:e||"normal"},1)},logLoginAttempt(e,t){f("login/attempt",{authType:e,loginType:t||"normal"},1)},logCredentialsLoginResponse(e,t){const s=c.CREDENTIALS,a=e||"normal";if("funcaptcha_response"!==t)if(t===n.LoginResponseStatus.OK||t===n.LoginResponseStatus.TWOFACTOR)f("login/success",{authType:s,loginType:a},1);else{let e;switch(t){case n.LoginResponseStatus.TOS_SIGNATURE_REQUIRED:e="tos_required";break;case n.LoginResponseStatus.SSO:e="sso_required";break;case n.LoginResponseStatus.TWOFACTOR_REQUIRED:e="enable_twofactor_required";break;case n.LoginResponseStatus.RATELIMIT:e="rate_limited";break;case n.LoginResponseStatus.EXPIRED:e="login_expired";break;case n.LoginResponseStatus.PASSWORD_EXPIRED:e="password_expired";break;case n.LoginResponseStatus.PASSWORD_DECRYPTION_ERROR:e="password_descryption_error";break;case n.LoginResponseStatus.ERROR:e="generic_error";break;case"form_error":e=t;break;default:e="unknown"}f("login/success",{authType:s,loginType:a},0),f("login/failure",{authType:s,loginType:a,error:e},1)}else f("login/failure",{authType:s,loginType:a,error:t},1)},logThirdPartyLoginResponse(e,t,s,a){const r=t||"normal";s||"tfa_required"===a?f("login/success",{authType:e,loginType:r},1):(f("login/success",{authType:e,loginType:r},0),f("login/failure",{authType:e,loginType:r,error:g(a,m)},1))},log2faResponse(e,t){const s=e||"normal";if(t===n.LoginResponseStatus.OK)f("2fa/success",{loginType:s},1);else{let e;switch(t){case n.LoginResponseStatus.REQUIRES_ROLE:e="requires_role";break;case n.LoginResponseStatus.EXPIRED:e="twofactor_expired";break;case n.LoginResponseStatus.INVALID_CREDENTIALS:e="invalid_credentials";break;case n.LoginResponseStatus.ERROR:e="generic_error";break;case"u2f_error":case"code_error":e=t;break;default:e="unknown"}f("2fa/success",{loginType:s},0),f("2fa/failure",{loginType:s,error:e},1)}}},t.AuthUXAnalyticsLogger={logSignupModalShown(e,t={}){_("signup_modal_shown",Object.assign({url:r.get_href(),kind:e},t))},logLoginModalShown(e,t={}){_("login_modal_shown",Object.assign({url:r.get_href(),kind:e},t))},logSignupModalDismissed(e){_("signup_modal_dismissed",{url:r.get_href(),kind:e})},logLoginModalDismissed(e){_("login_modal_dismissed",{url:r.get_href(),kind:e})},logRecoverableErrorShown(){_("login_recoverable_error_shown",{url:r.get_href()})},logDisabledErrorShown(){_("login_disabled_error_shown",{url:r.get_href()})},logRecoverableErrorDismissed(){_("login_recoverable_error_dismissed",{url:r.get_href()})},logDisabledErrorDismissed(){_("login_disabled_error_dismissed",{url:r.get_href()})}},t.EmailAuthUXAnalyticsLogger={logLoginStart(){_("email_login_start",{url:r.get_href()})},logSplitSignupContinue(){_("email_split_signup_continue",{url:r.get_href()})},logLoginResponse(e){switch(e.status){case n.LoginResponseStatus.OK:_("email_login_succeeded",d(e));break;case n.LoginResponseStatus.TWOFACTOR:_("email_login_requires_two_factor",d(e));break;case n.LoginResponseStatus.TWOFACTOR_REQUIRED:case n.LoginResponseStatus.TOS_SIGNATURE_REQUIRED:case n.LoginResponseStatus.EXPIRED:case n.LoginResponseStatus.SSO:_("email_login_redirect",d(e));break;default:_("email_login_failed",d(e))}},logLoginError(){_("email_login_failed",{url:r.get_href()})},logSignupStart(){_("email_signup_start",{url:r.get_href()})},logSignupResponse(){_("email_signup_succeeded",{url:r.get_href()})},logSignupError(){_("email_signup_failed",{url:r.get_href()})}},t.GoogleUXAnalyticsLogger={logLoginStart(){_("google_login_start",{url:r.get_href()})},logLoginResponse(e){e.success?_("google_login_succeeded",p(e)):"tfa_required"===e.err_msg?_("google_login_requires_two_factor",p(e)):_("google_login_failed",p(e))},logSignupStart(){_("google_signup_start",{url:r.get_href()})},logSignupResponse(e){e.success?_("google_signup_succeeded",p(e)):_("google_signup_failed",p(e))}},t.AppleUXAnalyticsLogger={logLoginStart(){_("sia_login_start",{url:r.get_href()})},logLoginResponse(e){e.success?_("sia_login_succeeded",p(e)):"tfa_required"===e.err_msg?_("sia_login_requires_two_factor",p(e)):"requires_password_on_first_link"===e.err_msg?_("sia_login_requires_password",p(e)):_("sia_login_failed",p(e))}},t.logUXAnalytics=_})),define("metaserver/static/js/modules/clean/auth/common/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthFormVariant=t.AuthButtonVariant=t.AuthTextInputType=void 0,(function(e){e.EMAIL="email",e.PASSWORD="password",e.TEXT="text",e.NUMBER="number"})(t.AuthTextInputType||(t.AuthTextInputType={})),(function(e){e.BIG="big",e.SMALL="small",e.STANDARD="standard"})(t.AuthButtonVariant||(t.AuthButtonVariant={})),(function(e){e.PAPER_COMPACT="paper-compact",e.SMALL="small",e.STANDARD="standard",e.DIG20="dig20"})(t.AuthFormVariant||(t.AuthFormVariant={}))})),define("metaserver/static/js/modules/clean/auth/login/2fa/authenticator_form",["require","exports","tslib","classnames","react","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/clean/auth/common/inputs/text","metaserver/static/js/modules/clean/auth/common/types","metaserver/static/js/modules/clean/auth/common/utils","metaserver/static/js/modules/clean/auth/login/2fa/trust_checkbox"],(function(e,t,s,a,r,o,i,n,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Authenticator2FAForm=void 0,a=s.__importDefault(a),r=s.__importDefault(r),t.Authenticator2FAForm=e=>{const t=r.default.createElement("button",{className:a.default("mc-button mc-button-primary",{"inline-submit":e.inlineSubmit,"login-button":!e.inlineSubmit}),type:"submit"},o.intl.formatMessage({id:"K57Ot6",defaultMessage:"Enter"}));return r.default.createElement("form",{className:"two-factor-form clearfix 2fa-phone-form",onSubmit:e.onSubmit},e.displayHeader&&r.default.createElement("div",{className:"login-header"},o.intl.formatMessage({id:"FFqVaU",defaultMessage:"Enter Dropbox 2-step verification code"})),r.default.createElement("div",{className:"login-info two-factor-uses-authenticator"},o.intl.formatMessage({id:"sufs69",defaultMessage:"Enter the code generated by your authenticator app."})),r.default.createElement("div",{className:a.default({"inline-input-submit-pair":e.inlineSubmit,"backup-verification-code-form":e.inlineSubmit})},r.default.createElement(i.AuthTextField,{className:"login-text-input inline-input",disabled:!1,error:e.error,maestroStyle:e.maestroStyle,name:"code",onChange:e.onInputChange,value:e.value,placeholder:o.intl.formatMessage({id:"DFLqLE",defaultMessage:"6-digit code"}),type:n.AuthTextInputType.NUMBER,variant:e.variant,autoFocus:!0,autoComplete:!1,persistLabel:!0}),e.inlineSubmit&&t),!e.hideTrustCheckbox&&r.default.createElement(c.TwoFactorTrustCheckbox,{checked:e.trusted,maestroStyle:e.maestroStyle,onChange:e.onInputChange,tooltipPosition:e.trustTooltipPosition,variant:e.variant}),!e.inlineSubmit&&t,!e.hideHelp&&r.default.createElement("div",{className:"two-factor-need-help"},r.default.createElement("a",{href:l.twoFactorRecoveryUrl(e.rememberMe,e.continuationUrl),className:"twofactor_recovery_url"},o.intl.formatMessage({id:"gR0Vz1",defaultMessage:"Having trouble getting a code?"}))))}})),define("metaserver/static/js/modules/clean/auth/login/2fa/email_form",["require","exports","tslib","classnames","react","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/clean/auth/common/inputs/text","metaserver/static/js/modules/clean/auth/common/types"],(function(e,t,s,a,r,o,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Email2FAForm=void 0,a=s.__importDefault(a),r=s.__importDefault(r),t.Email2FAForm=e=>{const t=r.default.createElement("button",{className:a.default("mc-button mc-button-primary",{"inline-submit":e.inlineSubmit,"login-button":!e.inlineSubmit}),type:"submit"},o.intl.formatMessage({id:"K57Ot6",defaultMessage:"Enter"}));return r.default.createElement("form",{className:"two-factor-form clearfix 2fa-email-form",onSubmit:e.onSubmit},e.displayHeader&&r.default.createElement("div",{className:"login-header"},o.intl.formatMessage({id:"FFqVaU",defaultMessage:"Enter Dropbox 2-step verification code"})),r.default.createElement("div",{className:"login-info two-factor-uses-email"},o.intl.formatMessage({id:"FuPzY9",defaultMessage:"We sent a code to {email} and any devices you’ve linked to this account. Enter the code to continue."},{span:e=>r.default.createElement("span",{className:"tfa-email"},e),email:e.email})),r.default.createElement("div",{className:a.default({"inline-input-submit-pair":e.inlineSubmit,"backup-verification-code-form":e.inlineSubmit})},r.default.createElement(i.AuthTextField,{className:"login-text-input inline-input",disabled:!1,error:e.error,maestroStyle:e.maestroStyle,name:"code",onChange:e.onInputChange,value:e.value,placeholder:o.intl.formatMessage({id:"DFLqLE",defaultMessage:"6-digit code"}),type:n.AuthTextInputType.NUMBER,variant:e.variant,autoFocus:!0,autoComplete:!1,persistLabel:!0}),e.inlineSubmit&&t),!e.inlineSubmit&&t,r.default.createElement("div",{className:"two-factor-need-help"},r.default.createElement("a",{href:"#",onClick:e.onResendCodeClick,className:"resend-two-factor-code two-factor-uses-sms"},o.intl.formatMessage({id:"HTy4qW",defaultMessage:"Resend code"}))))}})),define("metaserver/static/js/modules/clean/auth/login/2fa/phone_form",["require","exports","tslib","classnames","react","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/clean/auth/common/inputs/text","metaserver/static/js/modules/clean/auth/common/types","metaserver/static/js/modules/clean/auth/common/utils","metaserver/static/js/modules/clean/auth/login/2fa/trust_checkbox"],(function(e,t,s,a,r,o,i,n,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Phone2FAForm=void 0,a=s.__importDefault(a),r=s.__importDefault(r),t.Phone2FAForm=e=>{const t=r.default.createElement("button",{className:a.default("mc-button mc-button-primary",{"inline-submit":e.inlineSubmit,"login-button":!e.inlineSubmit}),type:"submit"},o.intl.formatMessage({id:"K57Ot6",defaultMessage:"Enter"}));return r.default.createElement("form",{className:"two-factor-form clearfix 2fa-phone-form",onSubmit:e.onSubmit},e.displayHeader&&r.default.createElement("div",{className:"login-header"},o.intl.formatMessage({id:"FFqVaU",defaultMessage:"Enter Dropbox 2-step verification code"})),r.default.createElement("div",{className:"login-info two-factor-uses-sms"},o.intl.formatMessage({id:"lWPbUP",defaultMessage:"We sent a code to your phone number ending in <span>{last_two_digits}</span>."},{span:e=>r.default.createElement("span",{className:"last-two-digits"},e),last_two_digits:e.lastTwoDigits})),r.default.createElement("div",{className:a.default({"inline-input-submit-pair":e.inlineSubmit,"backup-verification-code-form":e.inlineSubmit})},r.default.createElement(i.AuthTextField,{className:"login-text-input inline-input",disabled:!1,error:e.error,maestroStyle:e.maestroStyle,name:"code",onChange:e.onInputChange,value:e.value,placeholder:o.intl.formatMessage({id:"DFLqLE",defaultMessage:"6-digit code"}),type:n.AuthTextInputType.NUMBER,variant:e.variant,autoFocus:!0,autoComplete:!1,persistLabel:!0}),e.inlineSubmit&&t),!e.hideTrustCheckbox&&r.default.createElement(c.TwoFactorTrustCheckbox,{checked:e.trusted,maestroStyle:e.maestroStyle,onChange:e.onInputChange,tooltipPosition:e.trustTooltipPosition,variant:e.variant}),!e.inlineSubmit&&t,!e.hideHelp&&r.default.createElement("div",{className:"two-factor-need-help"},r.default.createElement("a",{href:"#",onClick:e.onResendCodeClick,className:"resend-two-factor-code two-factor-uses-sms"},o.intl.formatMessage({id:"HTy4qW",defaultMessage:"Resend code"})),r.default.createElement("a",{href:l.twoFactorRecoveryUrl(e.rememberMe,e.continuationUrl),className:"twofactor_recovery_url"},o.intl.formatMessage({id:"gR0Vz1",defaultMessage:"Having trouble getting a code?"}))))}})),define("metaserver/static/js/modules/clean/auth/login/2fa/seckey_form",["require","exports","tslib","react","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/clean/auth/login/2fa/trust_checkbox","metaserver/static/js/modules/clean/auth/login/types","metaserver/static/js/modules/clean/react/image","metaserver/static/js/modules/clean/react/sprite","metaserver/static/js/modules/clean/static_urls"],(function(e,t,s,a,r,o,i,n,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SecKey2FAForm=void 0,a=s.__importDefault(a);const u=()=>a.default.createElement(n.Image,{src:c.static_url("/static/images/security_keys/insert-vflkCfC4_.png"),srcHiRes:c.static_url("/static/images/security_keys/insert@2x-vflTxG2RJ.png"),className:"seckey-insert"}),m=()=>a.default.createElement(n.Image,{src:c.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),srcHiRes:c.static_url("/static/images/icons/ajax-loading-small@2x-vflAxdZTP.gif"),className:"seckey-loading-status"}),d=e=>a.default.createElement("div",{className:"two-factor-seckey-instructions"},a.default.createElement("p",null,a.default.createElement("span",{style:{fontWeight:"bold"}},r.intl.formatMessage({id:"DljPpW",defaultMessage:"Insert your security key to use it"}))," ",e.securityKeyState===i.SecurityKeyState.LOADING&&a.default.createElement(m,null),e.securityKeyState===i.SecurityKeyState.FOUND&&a.default.createElement(p,null)),r.intl.formatMessage({id:"eonxEJ",defaultMessage:"After inserting, tap your key if it has a button or gold disk."})),p=()=>a.default.createElement(l.Sprite,{group:"web",name:"bulletpoint-check",alt:"",className:"seckey-loading-status"});t.SecKey2FAForm=e=>a.default.createElement("form",{className:"two-factor-form clearfix 2fa-seckey-form"},e.displayHeader&&a.default.createElement("div",{className:"login-header"},r.intl.formatMessage({id:"FFqVaU",defaultMessage:"Enter Dropbox 2-step verification code"})),a.default.createElement("div",{className:"login-info two-factor-uses-u2f"},a.default.createElement(u,null),e.securityKeyState!==i.SecurityKeyState.NOT_FOUND&&a.default.createElement(d,{securityKeyState:e.securityKeyState}),a.default.createElement("div",{className:"text-input"},a.default.createElement("div",{className:"text-input-error-wrapper"})),e.securityKeyState===i.SecurityKeyState.NOT_FOUND&&a.default.createElement("div",{className:"two-factor-seckey-instructions"},a.default.createElement("div",{style:{color:"red"}},a.default.createElement("span",{className:"error-msg"},e.error||r.intl.formatMessage({id:"uqQwD8",defaultMessage:"Key not found."}))),a.default.createElement("button",{className:"button-tertiary two-factor-seckey-retry",onClick:e.onRetry},r.intl.formatMessage({id:"n1zYou",defaultMessage:"Retry"}))),!e.hideTrustCheckbox&&a.default.createElement(o.TwoFactorTrustCheckbox,{checked:e.trusted,maestroStyle:e.maestroStyle,onChange:e.onInputChange,tooltipPosition:e.trustTooltipPosition,variant:e.variant}),a.default.createElement("div",{className:"two-factor-use-phone-instead"},a.default.createElement("a",{href:"#",onClick:e.onChange2FA},e.secondaryTwoFactorType===i.TwoFactorType.SMS?r.intl.formatMessage({id:"cDmyI0",defaultMessage:"Send SMS instead"}):r.intl.formatMessage({id:"yzAIpy",defaultMessage:"Use mobile authenticator instead"})))))})),define("metaserver/static/js/modules/clean/auth/login/2fa/trust_checkbox",["require","exports","tslib","react","metaserver/static/js/modules/core/browser_detection","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/clean/auth/common/inputs/checkbox","metaserver/static/js/modules/clean/react/sprite_div","metaserver/static/js/modules/clean/react/tooltip"],(function(e,t,s,a,r,o,i,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TestOnlyTrustTooltipContent=t.TwoFactorTrustCheckbox=void 0,a=s.__importDefault(a),r=s.__importStar(r),n=s.__importDefault(n),l=s.__importStar(l);const c=()=>a.default.createElement("div",{className:"two-factor-trusted-info"},r.is_mobile_or_tablet()?o.intl.formatMessage({id:"UkQZnd",defaultMessage:"Trusted devices will never ask you for a security code again. You should only trust this device if you trust everyone who uses it."}):o.intl.formatMessage({id:"UraGyT",defaultMessage:"Trusted computers will never ask you for a security code again. You should only trust this computer if you trust everyone who uses it."}));t.TestOnlyTrustTooltipContent=c;const u=e=>a.default.createElement("div",{className:"tooltip-wrapper info-icon"},a.default.createElement(l.Tooltip,{position:l.TooltipPosition[e.position||"TOP"],tooltip_classname:"twofactor-trust-tooltip",tooltip_contents:a.default.createElement(c,null)},a.default.createElement(n.default,{group:"web",name:"info",alt:o.intl.formatMessage({id:"+SX5vq",defaultMessage:"More information"}),text:r.is_mobile_or_tablet()?o.intl.formatMessage({id:"+79s4f",defaultMessage:"Trust this device"}):o.intl.formatMessage({id:"Ey/8Q8",defaultMessage:"Trust this computer"}),spritePosition:"right"})));t.TwoFactorTrustCheckbox=e=>a.default.createElement(i.AuthCheckbox,{className:"remember-me",name:"trusted",checked:e.checked,inline:!0,disabled:!1,maestroStyle:e.maestroStyle,onChange:e.onChange,variant:e.variant,label:a.default.createElement(u,{position:e.tooltipPosition})})})),define("metaserver/static/js/modules/clean/auth/login/api",["require","exports","tslib","metaserver/static/js/modules/clean/deprecated_ajax/ajax_as_promised_jquery","metaserver/static/js/api_v2/default_user_client","metaserver/static/js/modules/clean/auth/login/types","metaserver/static/js/modules/clean/viewer","metaserver/static/js/modules/clean/viewer_refresh","metaserver/static/js/modules/core/assert","metaserver/static/js/modules/core/exception","metaserver/static/js/modules/core/i18n"],(function(e,t,s,a,r,o,i,n,l,c,u){"use strict";function m(){const e=i.Viewer.get_viewer().get_users()[0];return l.assert(null!=e,"Expect user is logged in when pairing"),new r.DefaultUserApiV2Client(e)}function d(e){var t;return(null===(t=null==e?void 0:e.error)||void 0===t?void 0:t[".tag"])?{status:o.LoginResponseStatus.ERROR,html_response:!1,message:e.message}:{status:o.LoginResponseStatus.ERROR,html_response:!1,message:u.intl.formatMessage({id:"vuVMnM",defaultMessage:"Something went wrong."})}}function p(e){return s.__awaiter(this,void 0,void 0,(function*(){const t=e.login_email,s=e.encrypted_password;l.assert(null!=t&&null!=s,"Expect login email and password not null");const a=m(),r={login_email:t,encrypted_password:s,remember_me:e.remember_me};try{const e=yield a.ns("team").rpc("account_pair_login",r,{});return e.two_factor_request?e.two_factor_request:e}catch(e){return d(e)}}))}function g(e){return s.__awaiter(this,void 0,void 0,(function*(){const t=e.checkpoint_token,s=e.code;l.assert(null!=t&&null!=s,"Expect checkpoint token and code not null");const a=m(),r={checkpoint_token:t,code:s,remember_me:e.remember_me};try{return yield a.ns("team").rpc("account_pair_two_factor_login",r,{})}catch(e){return d(e)}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.updateDropboxPasswordsEligibility=t.submitTwoFactorForm=t.retryU2fAuthentication=t.resendTwoFactorCode=t.submitCredentialsForm=t.accountPairTwoFactorLogin=t.accountPairLogin=t.checkSsoState=void 0,a=s.__importStar(a),t.checkSsoState=function(e){return new Promise(t=>a.WebRequest({url:"/sso_state",data:{email:e},success:e=>t(JSON.parse(e))}))},t.accountPairLogin=p,t.accountPairTwoFactorLogin=g,t.submitCredentialsForm=function(e,t){let s;switch(e){case"multi":s="/ajax_multi_login";break;case"pairing":s="/team/join/new_pair_login_ajax";break;case"cli_link_nonce":s="/cli_link_nonce";break;case"bidirectional_pair":return p(t);default:s="/ajax_login"}return new Promise((e,r)=>a.WebRequest({url:s,type:"POST",data:t,skipNotifyError:!0,success:t=>{e(JSON.parse(t))},error:(t,s,a)=>{"{"!==a[0]&&-1===a.indexOf(":")?e({status:o.LoginResponseStatus.ERROR,html_response:!1,message:a}):r(JSON.parse(a))}}))},t.resendTwoFactorCode=function(e,t){return new Promise((s,r)=>a.WebRequest({url:"/twofactor_resend",data:{backup:e,mobile_push:t},success:s,error:r}))},t.retryU2fAuthentication=function(){return new Promise((e,t)=>a.WebRequest({url:"/account/twofactor/u2f_start_authentication",success:e,error:t}))},t.submitTwoFactorForm=function(e,t){let s;switch(e){case"multi":s="/ajax_multi_verify_code";break;case"pairing":s="/team/join/new_pair_login_ajax";break;case"cli_link_nonce":s="/cli_link_twofactor";break;case"admin":s="/admin/login/twofactor";break;case"bidirectional_pair":return g(t);default:s="/ajax_verify_code"}return new Promise((e,r)=>a.WebRequest({url:s,type:"POST",data:t,success:t=>e(JSON.parse(t)),error:(e,t,s)=>r(JSON.parse(s))}))},t.updateDropboxPasswordsEligibility=function(e){return s.__awaiter(this,void 0,void 0,(function*(){i.Viewer.get_viewer().is_signed_in||(yield n.refreshViewerAfterLogin());try{const t=m();yield t.ns("passwords").rpc("update_freemium_eligibility",{entry_point:{".tag":e}},{})}catch(e){c.reportException({err:e,severity:"non-critical"})}}))}})),define("metaserver/static/js/modules/clean/auth/login/apple_login_button",["require","exports","tslib","react","classnames","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/clean/auth/login/login_error"],(function(e,t,s,a,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppleLoginButton=void 0,a=s.__importDefault(a),r=s.__importDefault(r),t.AppleLoginButton=e=>{const t=e.buttonProps||{},s=r.default("auth-apple","button-primary",t.className),n=t.text||o.intl.formatMessage({id:"pTMcB4",defaultMessage:"Sign in with Apple"});return a.default.createElement("div",{className:"login-form-container__apple-div"},a.default.createElement("button",{className:s,onClick:e.onClick,type:"button",disabled:e.disabled||t.disabled,"data-uxa-log":"sia_login_start"},a.default.createElement("div",{className:"sign-in-text"},n)),e.error&&a.default.createElement(i.LoginError,{className:"apple-login-error",message:e.error}))}})),define("metaserver/static/js/modules/clean/auth/login/credentials_form",["require","exports","tslib","classnames","react","metaserver/static/js/modules/core/browser_detection","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/clean/auth/common/inputs/checkbox","metaserver/static/js/modules/clean/auth/common/inputs/text","metaserver/static/js/modules/clean/auth/common/types","metaserver/static/js/modules/clean/auth/common/captcha","metaserver/static/js/modules/clean/auth/login/login_error","metaserver/static/js/modules/clean/auth/login/google_login_button","metaserver/static/js/modules/clean/auth/login/apple_login_button","metaserver/static/js/modules/clean/auth/login/types","metaserver/static/js/modules/clean/react/image","metaserver/static/js/modules/clean/react/sprite_div","metaserver/static/js/modules/clean/static_urls"],(function(e,t,s,a,r,o,i,n,l,c,u,m,d,p,g,h,f,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoginCredentialsForm=void 0,a=s.__importDefault(a),r=s.__importDefault(r),f=s.__importDefault(f);const E=e=>{let t="/forgot",s=e.target;return e.appendEmail&&(t=`/forgot?email_from_login=${e.email}`,s=void 0),r.default.createElement("a",{className:"forgot-password-link",href:t,target:s},e.text||i.intl.formatMessage({id:"ovBgtz",defaultMessage:"Forgot your password?"}))},S=e=>r.default.createElement("div",{id:"navisite"},r.default.createElement("br",null),r.default.createElement("a",{href:"/navi_redirect/login",target:e.openLinkInNewTab?"_blank":void 0},i.intl.formatMessage({id:"vnuqfB",defaultMessage:"Dropbox NAVI"}))),b=e=>r.default.createElement("div",{className:"sso-optout"},i.intl.formatMessage({id:"F1g1bb",defaultMessage:"or"})," ",r.default.createElement("a",{href:"#",onClick:e.onClick},i.intl.formatMessage({id:"fRMS5E",defaultMessage:"Log in with Dropbox credentials"}))),v=()=>r.default.createElement("span",{className:"login-loading-indicator ajax-loading"},r.default.createElement(h.Image,{src:_.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),srcHiRes:_.static_url("/static/images/icons/ajax-loading-small@2x-vflAxdZTP.gif")})),y=()=>r.default.createElement("div",{className:"sso-description"},r.default.createElement(f.default,{group:"web",name:"lock",text:i.intl.formatMessage({id:"WH73xS",defaultMessage:"Single sign-on enabled"})})),C=e=>r.default.createElement("div",{className:"credentials-form__fields"},r.default.createElement(l.AuthTextField,{value:e.emailValue,className:a.default("login-text-input","login-email",e.emailProps.className),onChange:e.onInputChange,disabled:e.disabled||e.emailProps.readonly||!1,label:e.emailProps.label||(e.maestroStyle?i.intl.formatMessage({id:"hK3Vsp",defaultMessage:"Email"}):void 0),placeholder:e.emailProps.placeholder||(e.maestroStyle?i.intl.formatMessage({id:"mx5U0y",defaultMessage:"you@mail.com"}):i.intl.formatMessage({id:"hK3Vsp",defaultMessage:"Email"})),error:e.emailError,styledError:e.styledEmailError,maestroStyle:e.maestroStyle,name:"login_email",type:c.AuthTextInputType.EMAIL,variant:e.variant,persistLabel:e.persistLabel}),e.ssoState===g.SsoState.OFF&&r.default.createElement(l.AuthTextField,{value:e.passwordValue,placeholder:e.passwordProps.placeholder||(e.maestroStyle?i.intl.formatMessage({id:"JtdF1I",defaultMessage:"Your password"}):i.intl.formatMessage({id:"i+PJQ7",defaultMessage:"Password"})),name:"login_password",className:a.default("login-text-input","login-password",e.passwordProps.className),error:e.passwordError,inputClassName:"password-input",onChange:e.onInputChange,measureStrength:!1,label:e.passwordProps.label||(e.maestroStyle?i.intl.formatMessage({id:"i+PJQ7",defaultMessage:"Password"}):void 0),maestroStyle:e.maestroStyle,disabled:e.disabled,variant:e.variant,type:c.AuthTextInputType.PASSWORD,persistLabel:e.persistLabel}));class w extends r.default.Component{constructor(){super(...arguments),this.setCaptchaComponent=e=>{this.captchaComponent=e},this.getCaptchaResponses=()=>this.props.supportsCaptcha?u.get_captcha_responses(this.captchaComponent):{},this.handleCaptchaErrors=e=>!!this.props.supportsCaptcha&&u.handle_captcha_errors(this.captchaComponent,e),this.submitRecaptcha=()=>{this.props.supportsCaptcha?this.captchaComponent.getWrappedComponent().submit():this.props.onSubmit()}}render(){const e=this.props.rememberMeProps||{},t=this.props.googleLoginProps,s=this.props.appleLoginProps,l=a.default({clearfix:!this.props.hideRememberMe||!this.props.hideHelp&&o.is_supported_mobile_browser()}),h=this.props.openLinksInNewTab?"_blank":void 0,f=a.default("clearfix","credentials-form","login-form",{"sso-required":this.props.ssoState!==g.SsoState.OFF,"sso-optional":this.props.ssoState===g.SsoState.OPTIONAL}),_=t&&t.positionBelow,w=t&&!t.positionBelow,L=s&&s.positionBelow,R=s&&!s.positionBelow,T=_||L,M=w||R,A=t?r.default.createElement(d.GoogleLoginButton,{buttonProps:t.buttonProps,disabled:this.props.disabled||this.props.isSubmitting,error:this.props.googleLoginError,onClick:this.props.onGoogleLoginClick,variant:this.props.variant}):null,N=s?r.default.createElement(p.AppleLoginButton,{buttonProps:s.buttonProps,disabled:this.props.disabled||this.props.isSubmitting,error:this.props.appleLoginError,onClick:this.props.onAppleLoginClick}):null,I=this.props.hideHelp||this.props.ssoState===g.SsoState.REQUIRED?null:r.default.createElement(E,{email:this.props.emailValue,target:h,appendEmail:void 0===this.props.forgotPasswordProps.appendEmail||this.props.forgotPasswordProps.appendEmail,text:this.props.forgotPasswordProps.text}),O=r.default.createElement("button",{className:a.default("login-button","signin-button","button-primary",this.props.loginButtonProps.className),type:"submit",disabled:this.props.disabled||this.props.isSubmitting||this.props.loginButtonProps.disabled},this.props.ssoState===g.SsoState.OFF&&r.default.createElement("div",{className:"signin-text"},this.props.loginButtonProps.text||i.intl.formatMessage({id:"raLp6W",defaultMessage:"Sign in"})),this.props.ssoState!==g.SsoState.OFF&&r.default.createElement("div",{className:"sso-text"},i.intl.formatMessage({id:"LgJiOW",defaultMessage:"Continue"}))),F=r.default.createElement("div",{className:"hr-label"},r.default.createElement("span",{className:"hr-label__text"},i.intl.formatMessage({id:"F1g1bb",defaultMessage:"or"}))),k=this.props.variant===c.AuthFormVariant.PAPER_COMPACT,P=this.props.isPaperLogin;let x,j;(function(e){e[e.INLINE_WITH_LOGIN_BUTTON=0]="INLINE_WITH_LOGIN_BUTTON",e[e.ON_NEW_LINE=1]="ON_NEW_LINE",e[e.BELOW_FORM=2]="BELOW_FORM",e[e.INLINE_WITH_REMEMBER_ME=3]="INLINE_WITH_REMEMBER_ME"})(x||(x={})),j=T||k?P&&!k?x.BELOW_FORM:x.INLINE_WITH_LOGIN_BUTTON:x.ON_NEW_LINE;const D=this.props.loginBasicSignupsVariant;!!D&&["V1","V2"].includes(D)&&(j=x.INLINE_WITH_REMEMBER_ME);const U=r.default.createElement("div",{className:"forgot-password-link-wrapper"},I);return r.default.createElement("div",{className:"login-form-container--subcontainer"},w&&A,R&&N,M&&!this.props.hideCredentialFields&&F,r.default.createElement("form",{className:f,onSubmit:this.props.onLoginClick,method:"POST"},!this.props.hideCredentialFields&&r.default.createElement(C,{disabled:this.props.disabled,emailError:this.props.emailError,styledEmailError:this.props.styledEmailError,emailProps:this.props.emailProps,emailValue:this.props.emailValue,maestroStyle:this.props.maestroStyle,onInputChange:this.props.onInputChange,passwordError:this.props.passwordError,passwordProps:this.props.passwordProps,passwordValue:this.props.passwordValue,ssoState:this.props.ssoState,variant:this.props.variant,persistLabel:this.props.persistLabel}),this.props.loginError&&r.default.createElement(m.LoginError,{message:this.props.loginError}),r.default.createElement("div",{className:l},this.props.ssoState!==g.SsoState.OFF&&r.default.createElement(y,null),!this.props.hideRememberMe&&r.default.createElement(n.AuthCheckbox,{checked:this.props.rememberMeValue,className:"remember-me",disabled:e.disabled||this.props.disabled,inline:void 0===e.inline||e.inline,label:e.label||i.intl.formatMessage({id:"ztezCK",defaultMessage:"Remember me"}),maestroStyle:this.props.maestroStyle,name:"remember_me",onChange:this.props.onInputChange,variant:this.props.variant}),j===x.INLINE_WITH_LOGIN_BUTTON&&I,j===x.INLINE_WITH_REMEMBER_ME&&U,!k&&!this.props.hideCredentialFields&&O,this.props.isSubmitting&&r.default.createElement(v,null),this.props.ssoState===g.SsoState.OPTIONAL&&r.default.createElement(b,{onClick:this.props.onSsoChangeClick}),j===x.ON_NEW_LINE&&r.default.createElement("div",{className:"login-need-help"},I),this.props.showNaviSiteLogin&&r.default.createElement(S,{openLinkInNewTab:this.props.openLinksInNewTab}),k&&O)),_&&A,L&&N,j===x.BELOW_FORM&&r.default.createElement("div",{className:"login-need-help"},I),this.props.supportsCaptcha&&r.default.createElement(u.Captcha,{ref:this.setCaptchaComponent,email:this.props.emailValue,onSubmit:this.props.onSubmit,onReady:this.props.onCaptchaReady,source:"LOGIN"}))}}t.LoginCredentialsForm=w,w.displayName="LoginCredentialsForm"})),define("metaserver/static/js/modules/clean/auth/login/email_error_banner",["require","exports","tslib","react","metaserver/static/js/modules/clean/react/components/css","dig-components/banner","dig-components/icons","dig-components/icons/src","dig-components/typography","dig-components/buttons","metaserver/static/js/modules/core/i18n"],(function(e,t,s,a,r,o,i,n,l,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoginEmailDisabledErrorBanner=t.LoginEmailRecoverableErrorBanner=void 0,a=s.__importDefault(a),t.LoginEmailRecoverableErrorBanner=function(e){return a.default.createElement(m,{descriptionText:e.recoverableErrorMessage,onCreateNewAccount:e.onCreateNewAccount,onRequestClose:e.onRequestClose,bannerId:"login_recoverable_email_error",id:e.id})},t.LoginEmailDisabledErrorBanner=function(e){return a.default.createElement(m,{descriptionText:e.disabledErrorMessage,onCreateNewAccount:e.onCreateNewAccount,onReRegister:e.onReRegister,onRequestClose:e.onRequestClose,bannerId:"login_disabled_email_error",id:e.id})};const m=r.requireCssWithComponent(e=>{const{learnMoreAriaLabel:t,learnMoreText:s,reRegisterButtonText:r,createANewAccountButtonText:m,titleText:d}={learnMoreText:u.intl.formatMessage({id:"o4l0fJ",defaultMessage:"Learn more"}),learnMoreAriaLabel:u.intl.formatMessage({id:"OfSk0L",defaultMessage:"Learn more about being deleted from a Dropbox team."}),reRegisterButtonText:u.intl.formatMessage({id:"cEOkYU",defaultMessage:"Re-register email"}),createANewAccountButtonText:u.intl.formatMessage({id:"DpXKIj",defaultMessage:"Create a new account"}),titleText:u.intl.formatMessage({id:"XK9XCq",defaultMessage:"This account is deleted"})};return a.default.createElement(o.Banner,{className:"login-form-email-error-banner",id:e.id,onRequestClose:e.onRequestClose,type:"alert",variant:"rich",withCloseButton:"close",withLeftPictogram:a.default.createElement(i.PictogramIcon,{src:n.WarningPictogram})},a.default.createElement(o.Banner.Message,null,a.default.createElement(l.Title,{size:"small"},d),a.default.createElement(l.Text,null,e.descriptionText," ",a.default.createElement(l.Link,{"aria-label":t,"data-trackingid":"email-error-banner-learn-more",href:"/help/508"},s))),a.default.createElement(o.Banner.Actions,null,a.default.createElement(c.Button,{"data-uxa-log":`${e.bannerId}_reregister_click`,disabled:!Boolean(e.onReRegister),onClick:e.onReRegister,type:"button",variant:"outline"},r),a.default.createElement(c.Button,{"data-uxa-log":`${e.bannerId}_create_a_new_account_click`,onClick:e.onCreateNewAccount,variant:"transparent",type:"button"},m)))},["/static/css/dig-components/index.web-vfl0pq0Fh.css"])})),define("metaserver/static/js/modules/clean/auth/login/form",["require","exports","tslib","classnames","react","metaserver/static/js/modules/core/assert","metaserver/static/js/modules/core/browser","metaserver/static/js/modules/core/exception","metaserver/static/js/modules/core/html","metaserver/static/js/modules/core/notify","metaserver/static/js/modules/core/uri","metaserver/static/js/modules/clean/auth/common/types","metaserver/static/js/modules/clean/auth/common/utils","metaserver/static/js/modules/clean/auth/login/2fa/authenticator_form","metaserver/static/js/modules/clean/auth/login/2fa/email_form","metaserver/static/js/modules/clean/auth/login/2fa/phone_form","metaserver/static/js/modules/clean/auth/login/2fa/seckey_form","metaserver/static/js/modules/clean/auth/login/api","metaserver/static/js/modules/clean/auth/login/credentials_form","metaserver/static/js/modules/clean/auth/login/sso_utils","metaserver/static/js/modules/clean/auth/login/types","metaserver/static/js/modules/clean/react/components/css","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/clean/profile_services/profile_services_constants","metaserver/static/js/modules/clean/profile_services/profile_services_link","metaserver/static/js/modules/clean/auth/authenticator","metaserver/static/js/modules/clean/security/passwords","metaserver/static/js/modules/clean/auth/common/stats","metaserver/static/js/modules/clean/react/fedramp/fedramp_util","metaserver/static/js/modules/clean/auth/login/email_error_banner"],(function(e,t,s,a,r,o,i,n,l,c,u,m,d,p,g,h,f,_,E,S,b,v,y,C,w,L,R,T,M,A){"use strict";var N;Object.defineProperty(t,"__esModule",{value:!0}),t.TestOnlyLoginStep=t.TestOnlyLoginFormComponent=t.LoginForm=void 0,a=s.__importDefault(a),r=s.__importDefault(r),i=s.__importStar(i),_=s.__importStar(_),C=s.__importDefault(C),L=s.__importStar(L),(function(e){e[e.CREDENTIALS_OR_SSO=0]="CREDENTIALS_OR_SSO",e[e.EMAIL_2FA=1]="EMAIL_2FA",e[e.PHONE_2FA=2]="PHONE_2FA",e[e.AUTHENTICATOR_2FA=3]="AUTHENTICATOR_2FA",e[e.SECKEY_2FA=4]="SECKEY_2FA"})(N||(N={})),t.TestOnlyLoginStep=N;class I extends r.default.Component{constructor(e){var t;super(e),this.testOnlyGetSsoChecker=()=>this.ssoChecker,this.setCredentialsFormComponent=e=>{this.credentialsFormComponent=e},this.testOnlyGetCredentialsFormComponent=()=>this.credentialsFormComponent,this.onInputChange=e=>{const t=e.currentTarget,s={},a=Object.assign({},this.state.localErrors);let r=!1;switch(t.name){case"login_email":s.email=t.value,a.email=void 0,a.styledEmailError=void 0,r=!0;break;case"login_password":s.password=t.value,a.password=void 0;break;case"remember_me":s.rememberMe=t.checked;break;case"trusted":s.trusted=t.checked;break;case"code":s.twoFactorCode=t.value,a.twoFactor=void 0}s.localErrors=a,this.setState(s,()=>{r&&this.ssoChecker.checkSsoState(s.email,this.onSsoStateUpdate)})},this.setContainerSSOState=e=>{"function"==typeof this.props.setFormSSOState&&this.props.setFormSSOState(e)},this.onSsoStateUpdate=(e,t)=>{e===this.state.email&&this.setState({ssoState:t},()=>this.setContainerSSOState(t))},this.onSsoChangeClick=()=>{o.assert(this.state.ssoState===b.SsoState.OPTIONAL,"User can change SSO state only when it is optional",{tags:["react-login-form"]}),this.setState({ssoState:b.SsoState.OFF},()=>this.setContainerSSOState(b.SsoState.OFF))},this.generateThirdPartyAuthUrl=(e,t)=>{const s={fname:e.profile.given_name,lname:e.profile.family_name,email:e.profile.email,picture_url:e.profile.picture_url,refresh_token:e.refresh_token,email_sig:e.email_sig,automatic_redirect:t.toString(),cont:this.props.continuationUrl||"/"};return this.props.googleLoginProps&&this.props.googleLoginProps.signupTag&&(s.signup_tag=this.props.googleLoginProps.signupTag),this.props.googleLoginProps&&this.props.googleLoginProps.signupEndpoint&&(s.signup_endpoint=this.props.googleLoginProps.signupEndpoint),String(new u.URI({path:"/third_party_signup"}).updateQuery(s))},this.handleGoogleCallback=e=>{T.AuthAMPLogger.logThirdPartyLoginResponse(T.AuthType.GOOGLE,this.props.type,e.success,e.err_msg),T.GoogleUXAnalyticsLogger.logLoginResponse(e);let t=M.getFedrampRedirectUrlIfApplicable(e.is_fedramp_user||!1,this.props.continuationUrl||"/");if(e.success)this.handleLoginFormEvent(b.LoginFormEvent.GOOGLE_LOGIN_SUCCESS),!1!==this.props.canRedirect?(c.Notify.success(y.intl.formatMessage({id:"Ce9FpX",defaultMessage:"Log in successful! Your browser will be redirected in a few seconds."})),i.redirect(t)):e.is_fedramp_user&&!this.props.forceOnLoginSuccess?(t=M.getFedrampRedirectUrlIfApplicable(!0,this.props.continuationUrl||i.get_href()),i.redirect(t)):this.props.onLoginSuccess&&this.props.onLoginSuccess({display_name:e.display_name,id:e.user_id,email:e.profile.email,is_fedramp_user:e.is_fedramp_user});else if("emails_do_not_match_redirect"===e.err_msg){const t=this.props.googleLoginProps,s=t&&t.customErrorHandlers;if(s&&s.emailsDoNotMatchRedirect)s.emailsDoNotMatchRedirect(e);else{const t=this.generateThirdPartyAuthUrl(e,!0);i.redirect(t)}}else if("emails_do_not_match"===e.err_msg)if("pairing"!==this.props.type&&this.props.variant===m.AuthFormVariant.STANDARD){const t=this.generateThirdPartyAuthUrl(e,!1),s=y.intl.formatMessage({id:"6AHSKo",defaultMessage:"Oops! We couldn’t find a Dropbox account matching that email. <a>Click here to create one.</a>"},{a:e=>r.default.createElement("a",{className:"third-party-signup-link",href:t},e)});this.setState({localErrors:Object.assign(Object.assign({},this.state.localErrors),{googleLogin:s})})}else e.localized_error?c.Notify.error(e.localized_error):c.Notify.error(y.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."}));else if("tos_required"===e.err_msg){const t=new u.URI({path:"/account/complete_registration_page"}).updateQuery({finish_web_auth:"true",remember_me:e.remember_me.toString(),cont:this.props.continuationUrl||"/"});i.redirect(t.toString())}else if("tfa_required"===e.err_msg){const s=new u.URI({path:"/verify_code"}).updateQuery({cont:t,remember_me:e.remember_me.toString(),pair_user:e.pair_user.toString()});i.redirect(s.toString())}else if("enable_twofactor_required"===e.err_msg){const s=new u.URI({path:"/twofactor"}).updateQuery({cont:t,remember_me:e.remember_me.toString(),pair_user:e.pair_user.toString()});i.redirect(s.toString())}else if("not_verified"===e.err_msg){const s=new u.URI({path:"/show_password_form"}).updateQuery({cont:t,remember_me:e.remember_me.toString(),pair_user:e.pair_user.toString()});i.redirect(s.toString())}else if("email_not_verified"===e.err_msg){const t=y.intl.formatMessage({id:"S6RuBm",defaultMessage:"Before you can sign in, you’ll need to verify your account with Google {email}"},{email:e.profile.email});c.Notify.error(new l.HTML(`<span>${t}</span>`),30)}else e.localized_error?c.Notify.error(e.localized_error):c.Notify.error(y.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."})),"google_login_not_allowed"!==e.err_msg&&"sso_required"!==e.err_msg||(this.setState({email:e.profile.email}),this.ssoChecker.checkSsoState(e.profile.email,this.onSsoStateUpdate))},this.onGoogleLoginClick=()=>{this.handleLoginFormEvent(b.LoginFormEvent.GOOGLE_LOGIN_CLICK),this.setState({localErrors:{}}),T.AuthAMPLogger.logLoginAttempt(T.AuthType.GOOGLE,this.props.type),T.GoogleUXAnalyticsLogger.logLoginStart();const e=!!this.props.googleLoginProps&&!1!==this.props.googleLoginProps.popup;(new w.ProfileServicesLinkingHandler).auth_service_login_web(C.default.GOOGLE,this.handleGoogleCallback,"login_form",e?w.AuthWindowOption.POP_UP:w.AuthWindowOption.REDIRECT,this.state.rememberMe,this.props.continuationUrl||"/","pairing"===this.props.type)},this.handleAppleCallback=e=>{T.AuthAMPLogger.logThirdPartyLoginResponse(T.AuthType.APPLE,this.props.type,e.success,e.err_msg),T.AppleUXAnalyticsLogger.logLoginResponse(e);let t=M.getFedrampRedirectUrlIfApplicable(e.is_fedramp_user||!1,this.props.continuationUrl||"/");if(e.success)this.handleLoginFormEvent(b.LoginFormEvent.APPLE_LOGIN_SUCCESS),!1!==this.props.canRedirect?(c.Notify.success(y.intl.formatMessage({id:"ZJmJez",defaultMessage:"Sign in successful! Your browser will be redirected in a few seconds."})),i.redirect(t)):e.is_fedramp_user&&!this.props.forceOnLoginSuccess?(t=M.getFedrampRedirectUrlIfApplicable(!0,this.props.continuationUrl||i.get_href()),i.redirect(t)):this.props.onLoginSuccess&&this.props.onLoginSuccess({display_name:e.display_name,id:e.user_id,email:e.profile.email,is_fedramp_user:e.is_fedramp_user});else if("no_email_in_response"===e.err_msg){const e=y.intl.formatMessage({id:"oFA/9f",defaultMessage:"Sign in failed. If you’d like to sign in with Apple again, <a>see how in our help center</a>. You could also sign in with your Dropbox account email and password."},{a:e=>`<a href="/help/accounts-billing/settings-sign-in/apple-sign-in-error">${e}</a>`});c.Notify.error(new l.HTML(`<span>${e}</span>`),30)}else if("tfa_required"===e.err_msg){const s=new u.URI({path:"/verify_code"}).updateQuery({cont:t,remember_me:e.remember_me.toString(),pair_user:e.pair_user.toString()});i.redirect(s.toString())}else if("enable_twofactor_required"===e.err_msg){const s=new u.URI({path:"/twofactor"}).updateQuery({cont:t,remember_me:e.remember_me.toString(),pair_user:e.pair_user.toString()});i.redirect(s.toString())}else if("requires_password_on_first_link"===e.err_msg){const s=new u.URI({path:"/show_password_form"}).updateQuery({cont:t,remember_me:e.remember_me.toString(),pair_user:e.pair_user.toString()});i.redirect(s.toString())}else if("emails_do_not_match"===e.err_msg){const t=y.intl.formatMessage({id:"8cKJMG",defaultMessage:"We couldn’t find a Dropbox account matching the email {email}. <a1>Sign up for a new account</a1> or <a2>get help signing in</a2> to an existing account."},{a1:e=>`<a href="/individual/plans-comparison?_tk=sia_nomatch_plan_web">${e}</a1>`,a2:e=>`<a href="/help/accounts-billing/settings-sign-in/sign-in-with-apple?_tk=sia_nomatch_help_web">${e}</a2>`,email:e.profile.email});c.Notify.error(new l.HTML(`<span>${t}</span>`),30)}else e.localized_error?c.Notify.error(e.localized_error):c.Notify.error(y.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."})),"apple_login_not_allowed"===e.err_msg&&(this.setState({email:e.profile.email}),this.ssoChecker.checkSsoState(e.profile.email,this.onSsoStateUpdate))},this.onAppleLoginClick=()=>{this.handleLoginFormEvent(b.LoginFormEvent.APPLE_LOGIN_CLICK),this.setState({localErrors:{}}),T.AuthAMPLogger.logLoginAttempt(T.AuthType.APPLE,this.props.type),T.AppleUXAnalyticsLogger.logLoginStart();const e=!!this.props.appleLoginProps&&!1!==this.props.appleLoginProps.popup;(new w.ProfileServicesLinkingHandler).auth_service_login_web(C.default.APPLE,this.handleAppleCallback,"login_form",e?w.AuthWindowOption.POP_UP:w.AuthWindowOption.REDIRECT,this.state.rememberMe,this.props.continuationUrl||"/","pairing"===this.props.type)},this.credentialsFormData=()=>{const e=Object.assign(Object.assign(Object.assign({login_email:this.state.email,cont:this.props.continuationUrl||"/",remember_me:this.state.rememberMe},this.credentialsFormComponent.getCaptchaResponses()),this.props.additionalData),{origin:this.props.origin});if(void 0===this.props.encryptionOptions)return Promise.reject(new Error("Must provide encryption options"));const t=this.state.ssoState===b.SsoState.OFF?this.state.password:"";return R.wrapPassword(t,this.props.encryptionOptions).then(t=>(e.encrypted_password=t,Promise.resolve(e)))},this.handleLoginSuccess=e=>s.__awaiter(this,void 0,void 0,(function*(){if(this.handleLoginFormEvent(b.LoginFormEvent.LOGIN_IMMEDIATE_SUCCESS,{userInfo:e}),this.state.didEnterIncorrectPassword&&(yield _.updateDropboxPasswordsEligibility("incorrect_password")),!1!==this.props.canRedirect){const t=M.getFedrampRedirectUrlIfApplicable(e.is_fedramp_user||!1,e.cont_override||this.props.continuationUrl||"/");return i.redirect(t)}if(e.is_fedramp_user&&!this.props.forceOnLoginSuccess){const e=M.getFedrampRedirectUrlIfApplicable(!0,this.props.continuationUrl||i.get_href());return i.redirect(e)}return this.props.onLoginSuccess?this.props.onLoginSuccess(e):i.redirect("/")})),this.handleSuccessResponse=e=>{switch(this.setState({isSubmitting:!1}),T.AuthAMPLogger.logCredentialsLoginResponse(this.props.type,e.status),T.EmailAuthUXAnalyticsLogger.logLoginResponse(e),e.status){case b.LoginResponseStatus.ERROR:const t=e.html_response?new l.HTML(e.message):e.message;return c.Notify.error(t);case b.LoginResponseStatus.EXPIRED:return i.redirect(e.cont);case b.LoginResponseStatus.OK:const s={id:e.id,email:e.email,display_name:e.display_name,locale:e.locale,is_fedramp_user:e.is_fedramp_user,cont_override:e.cont_override};this.handleLoginSuccess(s);break;case b.LoginResponseStatus.PASSWORD_EXPIRED:return this.setState({localErrors:Object.assign(Object.assign({},this.state.localErrors),{email:{message_text:y.intl.formatMessage({id:"3EEu7s",defaultMessage:"The password of the account associated with this email has expired. Please login to this account and update its password before pairing."})}})});case b.LoginResponseStatus.RATELIMIT:return this.setState({localErrors:Object.assign(Object.assign({},this.state.localErrors),{email:{message_text:y.intl.formatMessage({id:"7k/CMy",defaultMessage:"You’ve tried to log in too many times. Please try again in a few minutes."})}})});case b.LoginResponseStatus.TWOFACTOR_REQUIRED:case b.LoginResponseStatus.TOS_SIGNATURE_REQUIRED:return i.redirect(e.cont);case b.LoginResponseStatus.TWOFACTOR:e.checkpoint_token&&this.setState({checkpointToken:e.checkpoint_token}),e.use_email_2fa?this.setState({primaryTwoFactorType:b.TwoFactorType.EMAIL,currentStep:N.EMAIL_2FA}):e.u2f_challenge&&L.canUseAuthenticator(this.generateU2fRequest(e.u2f_challenge))?(this.setState({primaryTwoFactorType:b.TwoFactorType.SEC_KEY,currentStep:N.SECKEY_2FA}),e.last_two_digits?this.setState({lastTwoDigits:e.last_two_digits,secondaryTwoFactorType:b.TwoFactorType.SMS}):this.setState({secondaryTwoFactorType:b.TwoFactorType.AUTHENTICATOR}),this.kickOffU2f(e.u2f_challenge)):e.last_two_digits?this.setState({primaryTwoFactorType:b.TwoFactorType.SMS,lastTwoDigits:e.last_two_digits,secondaryTwoFactorType:void 0,currentStep:N.PHONE_2FA}):this.setState({primaryTwoFactorType:b.TwoFactorType.AUTHENTICATOR,lastTwoDigits:void 0,secondaryTwoFactorType:void 0,currentStep:N.AUTHENTICATOR_2FA});break;case b.LoginResponseStatus.SSO:return i.unsafeRedirect(e.sso_url);case b.LoginResponseStatus.PASSWORD_DECRYPTION_ERROR:return i.redirect(e.cont)}},this.handleServerErrors=e=>{if(T.AuthAMPLogger.logCredentialsLoginResponse(this.props.type,e.funcaptcha_response?"funcaptcha_response":"form_error"),this.credentialsFormComponent.handleCaptchaErrors(e))return void setTimeout(()=>{this.isCaptchaReady||d.notifyCaptchaNotLoaded()},1e4);T.EmailAuthUXAnalyticsLogger.logLoginError();const t={};e.login_email?t.email=e.login_email:t.email=void 0,e.login_password?t.password=e.login_password:t.password=void 0,e["failed-login-invalid-email-password"]?(t.login=y.intl.formatMessage({id:"kfg1Pg",defaultMessage:"Oops! It looks like you may have forgotten your password. <a>Click here to reset it.</a>"},{a:e=>r.default.createElement("a",{href:"/forgot"},e)}),this.setState({didEnterIncorrectPassword:!0})):t.login=void 0,e["account-is-disabled"]&&e.login_email&&e.login_email.message_text&&this.props.onCreateNewAccountClick&&this.props.onReRegisterClick&&(t.styledEmailError=t=>(T.AuthUXAnalyticsLogger.logDisabledErrorDismissed(),r.default.createElement(A.LoginEmailDisabledErrorBanner,{disabledErrorMessage:e.login_email.message_text,onCreateNewAccount:this.props.onCreateNewAccountClick,onReRegister:()=>this.props.onReRegisterClick(this.state.email),onRequestClose:()=>{T.AuthUXAnalyticsLogger.logDisabledErrorDismissed(),this.setState({localErrors:Object.assign(Object.assign({},this.state.localErrors),{styledEmailError:void 0})})},id:t.id})),t.email=void 0),e["account-is-recoverable"]&&e.login_email&&e.login_email.message_text&&this.props.onCreateNewAccountClick&&(t.styledEmailError=t=>(T.AuthUXAnalyticsLogger.logRecoverableErrorDismissed(),r.default.createElement(A.LoginEmailRecoverableErrorBanner,{onCreateNewAccount:this.props.onCreateNewAccountClick,onRequestClose:()=>{T.AuthUXAnalyticsLogger.logRecoverableErrorDismissed(),this.setState({localErrors:Object.assign(Object.assign({},this.state.localErrors),{styledEmailError:void 0})})},recoverableErrorMessage:e.login_email.message_text,id:t.id})),t.email=void 0),this.setState({localErrors:t}),this.setState({isSubmitting:!1})},this.onCredentialsFormSubmit=()=>{T.EmailAuthUXAnalyticsLogger.logLoginStart(),this.setState({isSubmitting:!0}),this.credentialsFormData().then(e=>{_.submitCredentialsForm(this.props.type,e).then(this.handleSuccessResponse).catch(this.handleServerErrors)}).catch(e=>{let t,s;e.isBrowserNotSupported?(t="user-error",s=y.intl.formatMessage({id:"rWb8d2",defaultMessage:"Dropbox doesn’t support your browser. For a better experience, upgrade to the latest version of a modern browser like Chrome, Firefox, Edge, or Safari."})):(t="critical",s=y.intl.formatMessage({id:"dNlIBC",defaultMessage:"There was a problem completing this request."})),n.reportException({err:e,severity:t,tags:["react-login-form"]}),this.setState({isSubmitting:!1}),c.Notify.error(s)})},this.onLoginClick=e=>{e.preventDefault(),T.AuthAMPLogger.logLoginAttempt(T.AuthType.CREDENTIALS,this.props.type),this.handleLoginFormEvent(b.LoginFormEvent.LOGIN_CLICK),this.credentialsFormComponent.submitRecaptcha()},this.handleResendCodeSuccess=e=>{let t;switch(e){case b.TwoFactorResendResponse.OK:return c.Notify.success(y.intl.formatMessage({id:"vdqTup",defaultMessage:"We sent you a code. It may take a few minutes to arrive."}));case b.TwoFactorResendResponse.RATELIMIT:t=y.intl.formatMessage({id:"7k/CMy",defaultMessage:"You’ve tried to log in too many times. Please try again in a few minutes."});break;case b.TwoFactorResendResponse.UNREACHABLE:t=y.intl.formatMessage({id:"G6HUee",defaultMessage:"We couldn’t reach your phone number. Are you sure it’s correct?"});break;case b.TwoFactorResendResponse.EXPIRED:t=y.intl.formatMessage({id:"l5AyQn",defaultMessage:"Sorry, your phone code has expired. Please log in again."});break;case b.TwoFactorResendResponse.BADCARRIER:t=y.intl.formatMessage({id:"ffjRA4",defaultMessage:"Unfortunately, your carrier isn’t supported at this time."});break;case b.TwoFactorResendResponse.INVALIDNUMBER:t=y.intl.formatMessage({id:"1P05hM",defaultMessage:"That isn’t a valid phone number."});break;case b.TwoFactorResendResponse.NOTAMOBILE:t=y.intl.formatMessage({id:"aI/ARD",defaultMessage:"That phone number doesn’t appear to be a valid mobile number."});break;default:return c.Notify.error(y.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."}))}this.setState({localErrors:Object.assign(Object.assign({},this.state.localErrors),{twoFactor:{message_text:t}})})},this.resendCode=()=>{var e,t,s,a;const r=_.resendTwoFactorCode(null!==(t=null===(e=this.props.additionalData)||void 0===e?void 0:e.backup)&&void 0!==t&&t,null!==(a=null===(s=this.props.additionalData)||void 0===s?void 0:s.mobile_push)&&void 0!==a&&a);r.then(this.handleResendCodeSuccess),r.catch(()=>{c.Notify.error(y.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."}))})},this.handleTwoFactorSuccess=e=>{switch(T.AuthAMPLogger.log2faResponse(this.props.type,e.status),e.status){case b.LoginResponseStatus.OK:this.state.currentStep===N.SECKEY_2FA&&this.setState({securityKeyState:b.SecurityKeyState.FOUND});const t={id:e.id,email:e.email,display_name:e.display_name,locale:e.locale,is_fedramp_user:e.is_fedramp_user,cont_override:e.cont_override};this.handleLoginSuccess(t);break;case b.LoginResponseStatus.ERROR:c.Notify.error(e.message);break;case b.LoginResponseStatus.REQUIRES_ROLE:case b.LoginResponseStatus.EXPIRED:this.setState({localErrors:Object.assign(Object.assign({},this.state.localErrors),{email:{message_text:e.message}}),currentStep:N.CREDENTIALS_OR_SSO});break;case b.LoginResponseStatus.INVALID_CREDENTIALS:this.setState({localErrors:Object.assign(Object.assign({},this.state.localErrors),{password:{message_text:e.message}}),currentStep:N.CREDENTIALS_OR_SSO});break;default:c.Notify.error(y.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."}))}},this.twoFactorFormData=()=>{const e=Object.assign({remember_me:this.state.rememberMe,cont:this.props.continuationUrl||"/",code:this.state.twoFactorCode,trusted:this.state.trusted},this.props.additionalData);return this.state.checkpointToken?Object.assign({checkpoint_token:this.state.checkpointToken},e):e},this.submitTwoFactor=()=>{this.setState({isSubmitting:!0});const e=_.submitTwoFactorForm(this.props.type,this.twoFactorFormData());e.then(this.handleTwoFactorSuccess),e.catch(e=>{T.AuthAMPLogger.log2faResponse(this.props.type,e.u2f?"u2f_error":e.code?"code_error":"unknown"),this.state.currentStep===N.SECKEY_2FA&&e.u2f?this.setState({localErrors:Object.assign(Object.assign({},this.state.localErrors),{securityKey:e.u2f.message_text}),securityKeyState:b.SecurityKeyState.NOT_FOUND}):e.code?this.setState({localErrors:Object.assign(Object.assign({},this.state.localErrors),{twoFactor:e.code})}):c.Notify.error(y.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."}))}),e.finally(()=>{this.setState({isSubmitting:!1})})},this.onPhone2FASubmit=e=>{e.preventDefault(),this.submitTwoFactor()},this.onAuthenticator2FASubmit=e=>{e.preventDefault(),this.submitTwoFactor()},this.generateU2fRequest=e=>{const t=JSON.parse(e),s={challenge_id:t.challenge_id};for(const e of Object.keys(L.PROTOCOLS))s[e]=t[e]&&JSON.parse(t[e]);return s},this.kickOffU2f=e=>s.__awaiter(this,void 0,void 0,(function*(){const t=this.generateU2fRequest(e);if(L.canUseAuthenticator(t))try{const e=yield L.sign(t);this.state.currentStep===N.SECKEY_2FA&&this.setState({twoFactorCode:JSON.stringify(e)},()=>this.submitTwoFactor())}catch(e){this.state.currentStep===N.SECKEY_2FA&&this.setState({securityKeyState:b.SecurityKeyState.NOT_FOUND}),o.assert(!1,`U2F Error - ${e}`,{tags:["react-login-form","u2f"]})}})),this.switch2FA=()=>{let e;o.assert(this.state.primaryTwoFactorType===b.TwoFactorType.SEC_KEY,"Unexpected two factor choice switch",{tags:["react-login-form"]}),this.state.secondaryTwoFactorType===b.TwoFactorType.SMS?(e=N.PHONE_2FA,this.resendCode()):e=N.AUTHENTICATOR_2FA,this.setState({twoFactorCode:"",primaryTwoFactorType:this.state.secondaryTwoFactorType,secondaryTwoFactorType:void 0,currentStep:e})},this.onRetryU2f=()=>{this.setState({securityKeyState:b.SecurityKeyState.LOADING});const e=_.retryU2fAuthentication();e.then(this.kickOffU2f),e.catch(()=>{this.setState({securityKeyState:b.SecurityKeyState.NOT_FOUND}),c.Notify.error(y.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."}))})},this.onCaptchaReady=()=>{this.isCaptchaReady=!0},o.assert(!1!==e.canRedirect||!!e.onLoginSuccess,"Need an on login success handler if we cannot redirect the user",{tags:["react-login-form"]}),this.ssoChecker=new S.SsoStateChecker,this.isCaptchaReady=!1;let a=N.CREDENTIALS_OR_SSO,p=void 0,g=void 0,h=void 0;e.twoFactorOnlyProps&&(e.twoFactorOnlyProps.u2fChallenge&&!(null===(t=e.additionalData)||void 0===t?void 0:t.backup)&&L.canUseAuthenticator(this.generateU2fRequest(e.twoFactorOnlyProps.u2fChallenge))?(a=N.SECKEY_2FA,p=b.TwoFactorType.SEC_KEY,e.twoFactorOnlyProps.lastTwoDigits?(g=b.TwoFactorType.SMS,h=e.twoFactorOnlyProps.lastTwoDigits):g=b.TwoFactorType.AUTHENTICATOR):e.twoFactorOnlyProps.lastTwoDigits?(a=N.PHONE_2FA,p=b.TwoFactorType.SMS,h=e.twoFactorOnlyProps.lastTwoDigits):(a=N.AUTHENTICATOR_2FA,p=b.TwoFactorType.AUTHENTICATOR)),this.state={currentStep:a,email:e.emailProps&&e.emailProps.initialValue||"",isSubmitting:!1,lastTwoDigits:h,localErrors:{},password:"",primaryTwoFactorType:p,secondaryTwoFactorType:g,rememberMe:e.rememberMeCheckboxProps&&e.rememberMeCheckboxProps.checked||!1,securityKeyState:b.SecurityKeyState.LOADING,ssoState:b.SsoState.OFF,trusted:e.twoFactorTrustCheckboxProps&&e.twoFactorTrustCheckboxProps.checked||!1,twoFactorCode:"",checkpointToken:void 0,shouldDisableForm:!0,didEnterIncorrectPassword:!1}}handleLoginFormEvent(e,t){d.pushMarketingEvent(e,this.props.pushConversionDataReadyMarketingEvent),this.props.onLoginFormEvent&&this.props.onLoginFormEvent(e,t)}componentDidMount(){this.setState({shouldDisableForm:!1}),this.props.twoFactorOnlyProps||T.AuthAMPLogger.logLoginIntent(this.props.type),this.props.twoFactorOnlyProps&&this.props.twoFactorOnlyProps.u2fChallenge&&this.state.currentStep===N.SECKEY_2FA&&this.kickOffU2f(this.props.twoFactorOnlyProps.u2fChallenge),this.state.email&&this.ssoChecker.checkSsoState(this.state.email,this.onSsoStateUpdate)}get shouldDisableForm(){return!!this.props.disabled||this.state.shouldDisableForm}get supportsCaptcha(){return!this.props.hideCredentialFields&&!["multi","pairing","cli_link_nonce"].includes(this.props.type)}render(){var e,t,s,o;let i;switch(this.state.currentStep){case N.CREDENTIALS_OR_SSO:i=r.default.createElement(E.LoginCredentialsForm,{ref:this.setCredentialsFormComponent,disabled:this.shouldDisableForm,emailError:this.state.localErrors.email,styledEmailError:this.state.localErrors.styledEmailError,emailProps:this.props.emailProps||{},emailValue:this.state.email,forgotPasswordProps:this.props.forgotPasswordProps||{},googleLoginError:this.state.localErrors.googleLogin,googleLoginProps:this.props.googleLoginProps,appleLoginError:this.state.localErrors.appleLogin,appleLoginProps:this.props.appleLoginProps,hideCredentialFields:this.props.hideCredentialFields||!1,hideHelp:this.props.hideHelp||!1,hideRememberMe:this.props.hideRememberMe||!1,isPaperLogin:this.props.isPaperLogin||!1,isSubmitting:this.state.isSubmitting,loginButtonProps:this.props.loginButtonProps||{},loginError:this.state.localErrors.login,maestroStyle:this.props.maestroStyle||!1,onGoogleLoginClick:this.onGoogleLoginClick,onAppleLoginClick:this.onAppleLoginClick,onInputChange:this.onInputChange,onLoginClick:this.onLoginClick,openLinksInNewTab:!!this.props.openLinksInNewTab,onSsoChangeClick:this.onSsoChangeClick,onSubmit:this.onCredentialsFormSubmit,onCaptchaReady:this.onCaptchaReady,passwordError:this.state.localErrors.password,passwordProps:this.props.passwordProps||{},passwordValue:this.state.password,persistLabel:!!this.props.persistLabel,rememberMeProps:this.props.rememberMeCheckboxProps||{},rememberMeValue:this.state.rememberMe,showNaviSiteLogin:!!this.props.showNaviSiteLogin,ssoState:this.state.ssoState,supportsCaptcha:this.supportsCaptcha,variant:this.props.variant||m.AuthFormVariant.STANDARD,loginBasicSignupsVariant:this.props.loginBasicSignupsVariant});break;case N.PHONE_2FA:i=r.default.createElement(h.Phone2FAForm,{continuationUrl:this.props.continuationUrl,displayHeader:null!==(e=this.props.twoFactorDisplayHeader)&&void 0!==e&&e,error:this.state.localErrors.twoFactor,hideHelp:this.props.hideHelp||!1,hideTrustCheckbox:this.props.hideRememberMe||!1,inlineSubmit:void 0===this.props.twoFactorSubmitButtonInline||this.props.twoFactorSubmitButtonInline,lastTwoDigits:this.state.lastTwoDigits||"",maestroStyle:this.props.maestroStyle||!1,onInputChange:this.onInputChange,onResendCodeClick:this.resendCode,onSubmit:this.onPhone2FASubmit,rememberMe:this.state.rememberMe,trusted:this.state.trusted,trustTooltipPosition:this.props.twoFactorTrustCheckboxProps&&this.props.twoFactorTrustCheckboxProps.tooltipPosition,value:this.state.twoFactorCode,variant:this.props.variant||m.AuthFormVariant.STANDARD});break;case N.EMAIL_2FA:i=r.default.createElement(g.Email2FAForm,{displayHeader:null!==(t=this.props.twoFactorDisplayHeader)&&void 0!==t&&t,email:this.state.email,error:this.state.localErrors.twoFactor,inlineSubmit:void 0===this.props.twoFactorSubmitButtonInline||this.props.twoFactorSubmitButtonInline,maestroStyle:this.props.maestroStyle||!1,onInputChange:this.onInputChange,onSubmit:this.onPhone2FASubmit,value:this.state.twoFactorCode,variant:this.props.variant||m.AuthFormVariant.STANDARD,onResendCodeClick:this.resendCode});break;case N.AUTHENTICATOR_2FA:i=r.default.createElement(p.Authenticator2FAForm,{continuationUrl:this.props.continuationUrl,displayHeader:null!==(s=this.props.twoFactorDisplayHeader)&&void 0!==s&&s,error:this.state.localErrors.twoFactor,hideHelp:this.props.hideHelp||!1,hideTrustCheckbox:this.props.hideRememberMe||!1,inlineSubmit:void 0===this.props.twoFactorSubmitButtonInline||this.props.twoFactorSubmitButtonInline,maestroStyle:this.props.maestroStyle||!1,onInputChange:this.onInputChange,onSubmit:this.onAuthenticator2FASubmit,rememberMe:this.state.rememberMe,trusted:this.state.trusted,trustTooltipPosition:this.props.twoFactorTrustCheckboxProps&&this.props.twoFactorTrustCheckboxProps.tooltipPosition,value:this.state.twoFactorCode,variant:this.props.variant||m.AuthFormVariant.STANDARD});break;case N.SECKEY_2FA:i=r.default.createElement(f.SecKey2FAForm,{displayHeader:null!==(o=this.props.twoFactorDisplayHeader)&&void 0!==o&&o,error:this.state.localErrors.securityKey,hideTrustCheckbox:this.props.hideRememberMe||!1,maestroStyle:this.props.maestroStyle||!1,onChange2FA:this.switch2FA,onInputChange:this.onInputChange,onRetry:this.onRetryU2f,trusted:this.state.trusted,trustTooltipPosition:this.props.twoFactorTrustCheckboxProps&&this.props.twoFactorTrustCheckboxProps.tooltipPosition,secondaryTwoFactorType:this.state.secondaryTwoFactorType,securityKeyState:this.state.securityKeyState,variant:this.props.variant||m.AuthFormVariant.STANDARD})}const n=a.default("login-form-container",this.props.variant,this.props.className,{"login-form-container--centered":this.props.centered,"login-form-container--maestro":this.props.maestroStyle});return r.default.createElement("div",{className:n},r.default.createElement("div",{className:"regular-login-forms"},i))}}t.TestOnlyLoginFormComponent=I,I.displayName="LoginFormComponent",t.LoginForm=v.requireCssWithComponent(I,["/static/css/components/exp_cards-vfls5BO1G.css","/static/css/components/login_form-vflPyw88n.css","/static/css/legacy_packages/components-vfltTYCHD.css","/static/css/login_or_register-vflUMxt4M.css","/static/css/scooter/scooter-scoped-vflpl9JSl.css","/static/css/spectrum/index.web-vfliw9181.css","/static/css/recaptcha_challenge-vflrcf67y.css","/static/css/recaptcha_v2_challenge-vflYEW-GO.css"])})),define("metaserver/static/js/modules/clean/auth/login/google_login_button",["require","exports","tslib","react","classnames","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/clean/auth/common/types","metaserver/static/js/modules/clean/auth/login/login_error","dig-components/buttons","metaserver/static/js/modules/clean/react/image","metaserver/static/js/modules/clean/static_urls"],(function(e,t,s,a,r,o,i,n,l,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GoogleLoginButton=void 0,a=s.__importDefault(a),r=s.__importDefault(r);const m=u.static_url("/static/images/growth/biz-setup/gmail-vflKoZim9.svg"),d=e=>{const{onClick:t,label:s,disabled:r}=e;return a.default.createElement(l.Button,{className:"setup-button",disabled:r,onClick:t,variant:"outline",size:"large"},a.default.createElement("div",{className:"email-cta-button"},a.default.createElement(c.Image,{className:"email-cta-button__item",src:m}),a.default.createElement("div",{className:"email-cta-button__item"},s)))};t.GoogleLoginButton=e=>{const t=e.buttonProps||{},s=r.default("auth-google","button-primary",t.className),l=e.variant&&e.variant===i.AuthFormVariant.DIG20,c=t.text||o.intl.formatMessage({id:"SgtygT",defaultMessage:"Sign in with Google"});return a.default.createElement("div",{className:"login-form-container__google-div"},l?a.default.createElement(d,Object.assign({},e,{label:c})):a.default.createElement("button",{className:s,onClick:e.onClick,type:"button",disabled:e.disabled||t.disabled,"data-uxa-log":"google_login_start"},a.default.createElement("div",{className:"sign-in-text"},c)),e.error&&a.default.createElement(n.LoginError,{className:"google-login-error",message:e.error}))}})),define("metaserver/static/js/modules/clean/auth/login/login_error",["require","exports","tslib","react","classnames"],(function(e,t,s,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoginError=void 0,a=s.__importDefault(a),r=s.__importDefault(r),t.LoginError=e=>{const t=r.default("c-card","c-card--error",e.className);return a.default.createElement("div",{className:t},e.message)}})),define("metaserver/static/js/modules/clean/auth/login/sso_utils",["require","exports","tslib","metaserver/static/js/modules/clean/auth/login/api","metaserver/static/js/modules/clean/auth/login/types"],(function(e,t,s,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SsoStateChecker=void 0,a=s.__importStar(a);const o=/^[^@\s]+@[^@\s]+\.[A-Za-z]{2,}$/;t.SsoStateChecker=class{constructor(){this.shouldCheckSsoState=e=>e.match(o),this.checkSsoState=(e,t)=>{this.shouldCheckSsoState(e)?this.CACHE[e]?t(e,this.CACHE[e]):this.INFLIGHT[e]||(this.INFLIGHT[e]=!0,a.checkSsoState(e).then(s=>{switch(s.user_sso_state){case"optional":this.CACHE[e]=r.SsoState.OPTIONAL;break;case"required":this.CACHE[e]=r.SsoState.REQUIRED;break;default:this.CACHE[e]=r.SsoState.OFF}t(e,this.CACHE[e])}).finally(()=>{delete this.INFLIGHT[e]})):t(e,r.SsoState.OFF)},this.CACHE={},this.INFLIGHT={}}}})),define("metaserver/static/js/modules/clean/auth/login/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoginFormEvent=t.TwoFactorResendResponse=t.LoginResponseStatus=t.SsoState=t.SecurityKeyState=t.TwoFactorType=t.LoginRole=void 0,(function(e){e.ROLE_WORK="work",e.ROLE_PERSONAL="personal",e.ROLE_PHOTOS="photos",e.ROLE_BOTH="both"})(t.LoginRole||(t.LoginRole={})),(function(e){e[e.EMAIL=0]="EMAIL",e[e.SMS=1]="SMS",e[e.AUTHENTICATOR=2]="AUTHENTICATOR",e[e.SEC_KEY=3]="SEC_KEY"})(t.TwoFactorType||(t.TwoFactorType={})),(function(e){e[e.LOADING=0]="LOADING",e[e.FOUND=1]="FOUND",e[e.NOT_FOUND=2]="NOT_FOUND"})(t.SecurityKeyState||(t.SecurityKeyState={})),(function(e){e.OFF="off",e.OPTIONAL="optional",e.REQUIRED="required"})(t.SsoState||(t.SsoState={})),(function(e){e.DEVICE_LIMIT="DEVICE_LIMIT",e.OK="OK",e.SSO="SSO",e.TWOFACTOR="TWOFACTOR",e.TWOFACTOR_REQUIRED="TWOFACTOR_REQUIRED",e.RATELIMIT="RATELIMIT",e.PASSWORD_EXPIRED="PASSWORD_EXPIRED",e.EXPIRED="EXPIRED",e.ERROR="ERROR",e.REQUIRES_ROLE="REQUIRES_ROLE",e.INVALID_CREDENTIALS="INVALID_CREDENTIALS",e.PASSWORD_DECRYPTION_ERROR="PASSWORD_DECRYPTION_ERROR",e.TOS_SIGNATURE_REQUIRED="TOS_SIGNATURE_REQUIRED"})(t.LoginResponseStatus||(t.LoginResponseStatus={})),(function(e){e.OK="OK",e.RATELIMIT="RATELIMIT",e.UNREACHABLE="UNREACHABLE",e.EXPIRED="EXPIRED",e.BADCARRIER="BADCARRIER",e.INVALIDNUMBER="BADCARRIER",e.NOTAMOBILE="BADCARRIER"})(t.TwoFactorResendResponse||(t.TwoFactorResendResponse={})),(function(e){e.LOGIN_CLICK="LOGIN_CLICK",e.LOGIN_IMMEDIATE_SUCCESS="LOGIN_IMMEDIATE_SUCCESS",e.GOOGLE_LOGIN_CLICK="GOOGLE_LOGIN_CLICK",e.GOOGLE_LOGIN_SUCCESS="GOOGLE_LOGIN_SUCCESS",e.APPLE_LOGIN_CLICK="APPLE_LOGIN_CLICK",e.APPLE_LOGIN_SUCCESS="APPLE_LOGIN_SUCCESS"})(t.LoginFormEvent||(t.LoginFormEvent={}))})),define("metaserver/static/js/modules/clean/auth/login_or_register/login_register_container",["require","exports","tslib","react","react-intl","classnames","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/clean/react/components/css","metaserver/static/js/modules/clean/auth/login_or_register/logging_util","metaserver/static/js/modules/clean/auth/login_or_register/types","metaserver/static/js/modules/clean/auth/login/form","metaserver/static/js/modules/clean/auth/register/form","dig-components/typography","ts-key-enum","metaserver/static/js/modules/clean/auth/login/types"],(function(e,t,s,a,r,o,i,n,l,c,u,m,d,p,g){"use strict";var h;Object.defineProperty(t,"__esModule",{value:!0}),t.TestOnlyStatelessLoginRegisterContainer=t.LoginRegisterContainer=t.StatelessLoginRegisterContainer=t.SwitchLinkLocationEnum=void 0,a=s.__importStar(a),o=s.__importDefault(o),(function(e){e.TOP="top",e.BOTTOM="bottom"})(h=t.SwitchLinkLocationEnum||(t.SwitchLinkLocationEnum={}));const f=r.defineMessages({registerHeader:{id:"P09UfX",defaultMessage:"Create an account"},loginHeader:{id:"raLp6W",defaultMessage:"Sign in"},switchToRegisterLinkLabel:{id:"91fajJ",defaultMessage:"create an account"},switchToLoginLinkLabel:{id:"/bdGRh",defaultMessage:"log in"}}),_=({switchLinkLabel:e,onSwitchLinkAction:t,switchLinkUxaId:s,hideSwitchOrText:r=!1})=>a.default.createElement("div",{className:"login-register-switch"},!r&&a.default.createElement("span",null,`${i.intl.formatMessage({id:"F1g1bb",defaultMessage:"or"})} `),a.default.createElement(d.Link,{className:"login-register-switch-link",onClick:t,onKeyDown:e=>{e.target instanceof HTMLAnchorElement&&[p.Key.Enter," "].includes(e.key)&&(e.preventDefault(),e.target.click())},hasNoUnderline:!0,href:"#","data-uxa-log":s,role:"button",tabIndex:0},e));_.displayName="SwitchLink";const E=({className:e,hideHeader:t,headerText:s,switchLinkLocation:r,switchLinkLabel:i,onSwitchLinkAction:n,switchLinkUxaId:l,children:c,showTopSwitchLink:u=!0,hideSwitchOrText:m=!1})=>{const d=a.default.createElement(_,{onSwitchLinkAction:n,switchLinkLabel:i,switchLinkUxaId:l,hideSwitchOrText:m});return a.default.createElement("div",{className:o.default("login-register-part",e)},a.default.createElement("div",{className:"clearfix"},!t&&a.default.createElement("div",{className:"login-register-header"},s),u&&r===h.TOP&&d),c,r===h.BOTTOM&&d)};E.displayName="AuthFormWithHeader";const S=e=>{var t,{switchLinkProps:n={switchLinkLocation:h.TOP},hideHeaders:l=!1,currentMode:d,setLoginRegisterMode:p}=e,_=s.__rest(e,["switchLinkProps","hideHeaders","currentMode","setLoginRegisterMode"]);const{className:S,loginHeader:b,registerHeader:v,loginFormProps:y,registerFormProps:C,showTopSwitchLink:w=!0,isBasicSignupsVariant:L,setLoginRegisterPageMode:R}=_,{switchLinkLocation:T,switchToRegisterLinkLabel:M,switchToLoginLinkLabel:A}=n,N=o.default("login-register-container",S,null!==(t=y.variant)&&void 0!==t?t:C.variant,[`login-register-container--link-${T}`]),[I,O]=a.default.useState(g.SsoState.OFF),[F,k]=a.default.useState(void 0),P=I!==g.SsoState.OFF&&d===c.Mode.LOGIN,x=!w&&!P,j=r.defineMessages({signupToggleText:{id:"F2YYO0",defaultMessage:"Don’t have an account?"},signupToggleButtonLabel:{id:"HXjK0v",defaultMessage:"Sign up for free"},loginToggleText:{id:"hVkDSg",defaultMessage:"Already have an account?"},loginToggleButtonLabel:{id:"98QA7W",defaultMessage:"Log in"}}),D=a.default.createElement("div",{className:"login_page_basic_signups--bottom-toggle-text"},i.intl.formatMessage(d===c.Mode.LOGIN?j.signupToggleText:j.loginToggleText)),U=`${d===c.Mode.REGISTER?"log_in":"create_an_account"}_toggle`,G=i.intl.formatMessage(d===c.Mode.LOGIN?j.signupToggleButtonLabel:j.loginToggleButtonLabel),q=()=>{const e=d===c.Mode.REGISTER?c.Mode.LOGIN:c.Mode.REGISTER;p(e),R&&R(e)},H=a.default.createElement("button",{className:o.default("button-primary","login_page_basic_signups--bottom-toggle"),onClick:e=>{q(),e.currentTarget.blur()},"data-uxa-log":U},G),B=a.default.createElement(E,{className:o.default("login-register-login-part",{"current-form":d===c.Mode.LOGIN}),hideHeader:l,headerText:null!=b?b:i.intl.formatMessage(f.loginHeader),switchLinkLocation:T,switchLinkLabel:null!=M?M:i.intl.formatMessage(f.switchToRegisterLinkLabel),onSwitchLinkAction:q,switchLinkUxaId:"create_an_account_toggle",showTopSwitchLink:w,hideSwitchOrText:L},a.default.createElement(u.LoginForm,Object.assign({},y,{onCreateNewAccountClick:()=>{k(void 0),q()},onReRegisterClick:e=>{k(e),q()},setFormSSOState:w?void 0:O}))),K=a.default.createElement(E,{className:o.default("login-register-register-part",{"current-form":d===c.Mode.REGISTER}),hideHeader:l,headerText:null!=v?v:i.intl.formatMessage(f.registerHeader),switchLinkLocation:T,switchLinkLabel:null!=A?A:i.intl.formatMessage(f.switchToLoginLinkLabel),onSwitchLinkAction:q,switchLinkUxaId:"log_in_toggle",showTopSwitchLink:w,hideSwitchOrText:L},a.default.createElement(m.RegisterForm,Object.assign({},C,{onEmailChanged:()=>k(void 0),emailPrefill:F})));return a.default.createElement("div",{className:N},B,K,x&&[D,H])};t.TestOnlyStatelessLoginRegisterContainer=S,S.displayName="StatelessLoginRegisterContainerView",t.StatelessLoginRegisterContainer=n.requireCssWithComponent(S,["/static/css/components/login_or_register-vflMH7T5x.css","/static/css/legacy_packages/components-vfltTYCHD.css","/static/css/components/button-vfl7d2xHj.css","/static/css/scooter/scooter-scoped-vflpl9JSl.css","/static/css/recaptcha_challenge-vflrcf67y.css","/static/css/recaptcha_v2_challenge-vflYEW-GO.css"]),t.LoginRegisterContainer=e=>{const[s,r]=a.useState(e.defaultRegister?c.Mode.REGISTER:c.Mode.LOGIN);return a.useEffect(()=>l.logAuthIntent(s),[s]),a.default.createElement(t.StatelessLoginRegisterContainer,Object.assign({currentMode:s,setLoginRegisterMode:r},e))},t.LoginRegisterContainer.displayName="LoginRegisterContainer"})),define("metaserver/static/js/modules/clean/auth/login_or_register/logging_util",["require","exports","metaserver/static/js/modules/clean/analytics","metaserver/static/js/modules/clean/auth_event_logger","metaserver/static/js/modules/clean/auth/common/stats","metaserver/static/js/modules/clean/auth/login_or_register/types"],(function(e,t,s,a,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logModalMiscActivity=t.logModalShown=t.logModalDismissed=t.logAuthIntent=void 0,t.logAuthIntent=e=>{e===o.Mode.REGISTER?a.AuthEventLogger.log_web_signup_intent():a.AuthEventLogger.log_web_login_intent()},t.logModalDismissed=(e,t)=>{e===o.Mode.REGISTER?r.AuthUXAnalyticsLogger.logSignupModalDismissed(t):r.AuthUXAnalyticsLogger.logLoginModalDismissed(t)},t.logModalShown=(e,t,s={})=>{e===o.Mode.REGISTER?r.AuthUXAnalyticsLogger.logSignupModalShown(t,s):r.AuthUXAnalyticsLogger.logLoginModalShown(t,s)},t.logModalMiscActivity=(e,t)=>{const a={auth_google:!0};e===o.LoginOrRegisterKind.IMMEDIATE?s.WebMiscActivityLogger.log("signup_modal-show-upfront",a):e===o.LoginOrRegisterKind.DOWNLOAD&&t===o.DownloadAction.DIRECT_DOWNLOAD&&s.WebMiscActivityLogger.log("signup_modal-show-download",a)}})),define("metaserver/static/js/modules/clean/auth/register/form",["require","exports","tslib","react","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/core/browser","metaserver/static/js/modules/core/assert","metaserver/static/js/modules/clean/deprecated_ajax/ajax_jquery","metaserver/static/js/modules/clean/auth/common/types","metaserver/static/js/modules/clean/auth/common/utils","metaserver/static/js/modules/clean/auth/register/types","metaserver/static/js/modules/clean/auth/register/view","metaserver/static/js/modules/clean/profile_services/auth_callback_handler","metaserver/static/js/modules/clean/profile_services/profile_services_constants","metaserver/static/js/modules/clean/profile_services/profile_services_link","metaserver/static/js/modules/clean/react/components/css","metaserver/static/js/modules/clean/web_timing_logger","metaserver/static/js/modules/clean/web_register_logging_data","metaserver/static/js/modules/clean/auth/common/stats","metaserver/static/js/api_v2/noauth_client","metaserver/static/js/modules/core/notify"],(function(e,t,s,a,r,o,i,n,l,c,u,m,d,p,g,h,f,_,E,S,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TestOnlyRegisterFormComponent=t.RegisterForm=t.handleInviteResendImpl=void 0,a=s.__importDefault(a),o=s.__importStar(o),n=s.__importStar(n),p=s.__importDefault(p);class v extends a.default.Component{constructor(e){super(e),this.testOnlyGetViewComponent=()=>this.viewComponent,this.setViewComponent=e=>{this.viewComponent=e},this.onClickSignUp=e=>{e.preventDefault(),this.handleRegisterFormEvent(u.RegisterFormEvent.REGISTER_CLICK),E.AuthAMPLogger.logSignupAttempt(E.AuthType.CREDENTIALS),E.EmailAuthUXAnalyticsLogger.logSignupStart();const t=this.getFormErrors();t.fname||t.email||t.password||t.tos?this.setState({localErrors:t}):this.viewComponent.getCaptchaComponent().getWrappedComponent().submit()},this.onSubmit=()=>{this.setState({isSubmitting:!0});const e=this.registerData(),t=this.props.signupUrl||(this.thirdPartySignupInitiated?"/ajax_thirdparty_register":"/ajax_register");n.WebRequest({url:t,type:"POST",data:e,success:(e,t,s)=>{this.handleSuccess(e)},error:(e,t,s)=>{"success"===t?this.handleServerErrors(JSON.parse(s)):this.setState({isSubmitting:!1})}})},this.handleGoogleCallback=e=>{E.AuthAMPLogger.logSignupResponse(E.AuthType.GOOGLE,e.success,e.err_msg),E.GoogleUXAnalyticsLogger.logSignupResponse(e);const{additionalParams:t={},marketingOptInProps:a={},canRedirect:r}=this.props,i=this.props.googleRegisterProps||{},n=i.signupContinuationUrl||"/",l=i.optimisticLoginContinuationUrl||n,c=_.getWebRegisterLoggingData();d.handleRegisterResponse(e,Object.assign({showMarketingOptIn:!!a.show,registerCont:n,loginCont:l,signupTag:t.signup_tag||"",canRedirect:!1!==r,k:t.k,eh:t.eh,signupEndpoint:this.props.signupEndpoint,inlineRedirect:r?void 0:e=>{const{fname:t,lname:a,email:r}=e,o=s.__rest(e,["fname","lname","email"]);this.setState({fname:t,lname:a,email:r,inlineThirdPartySignupState:o})}},c),void 0,()=>{this.handleRegisterFormEvent(u.RegisterFormEvent.GOOGLE_REGISTER_SUCCESS)},e=>{if(this.handleRegisterFormEvent(u.RegisterFormEvent.REGISTER_IMMEDIATE_SUCCESS,{userInfo:e}),!1!==this.props.canRedirect)o.redirect(l);else if(this.props.onRegisterSuccess)return this.props.onRegisterSuccess(e,e)})},this.onGoogleRegisterClick=()=>{this.handleRegisterFormEvent(u.RegisterFormEvent.GOOGLE_REGISTER_CLICK),E.AuthAMPLogger.logSignupAttempt(E.AuthType.GOOGLE),E.GoogleUXAnalyticsLogger.logSignupStart();const e=new g.ProfileServicesLinkingHandler,t=this.props.googleRegisterProps||{};let s;s=void 0===t.popup?g.AuthWindowOption.POP_UP:t.popup?g.AuthWindowOption.POP_UP:g.AuthWindowOption.REDIRECT;const a=t.signupContinuationUrl?{kind:"web",cont:t.signupContinuationUrl,remember_me:!1,pair_user:!1}:null;e.auth_service_create_user_if_needed(p.default.GOOGLE,this.handleGoogleCallback,"register_form",s,a)},this.onInputChange=e=>{var t,s;const a={},r=e.currentTarget,{name:o,value:i,checked:n}=r;"fname"===o?a.fname=i:"lname"===o?a.lname=i:"email"===o?(a.email=i,null===(s=(t=this.props).onEmailChanged)||void 0===s||s.call(t)):"password"===o?a.password=i:"tos_agree"===o?a.tosAgree=n:"marketing_opt_in"===o&&(a.marketingOptIn=n),this.setState(a),this.clearFormErrors(a)},this.handleResendClick=e=>{const t=e.target,{email:s,isSendingInvite:a}=this.state;"login-register-resend-invite"===t.className&&y(e,a,s,()=>this.setState({isSendingInvite:!0}),()=>this.setState({isSendingInvite:!1}))},this.onCaptchaReady=()=>{this.isCaptchaReady=!0},i.assert(!1!==e.canRedirect||!!e.onRegisterSuccess,"Need an on register success handler if we cannot redirect the user",{tags:["react-register-form"]});const{fnameProps:t={},lnameProps:a={},emailProps:r={},tosCheckboxProps:l={},marketingOptInProps:c={}}=e,m=!c.show||!!c.checked;this.state={localErrors:{},isSubmitting:!1,fname:t.initialValue||"",lname:a.initialValue||"",email:e.emailPrefill||r.initialValue||"",password:"",tosAgree:!!l.checked,isSendingInvite:!1,marketingOptIn:m,shouldDisableForm:!0},this.mounted=!1,this.isCaptchaReady=!1}getCurrentEmail(){var e;return null!==(e=this.props.emailPrefill)&&void 0!==e?e:this.state.email}handleServerErrors(e){if(!this.mounted)return;if(E.AuthAMPLogger.logSignupResponse(E.AuthType.CREDENTIALS,!1,e.funcaptcha_response?"funcaptcha_response":"form_error"),this.viewComponent.handleCaptchaErrors(e))return void setTimeout(()=>{this.isCaptchaReady||c.notifyCaptchaNotLoaded()},1e4);E.EmailAuthUXAnalyticsLogger.logSignupError();const t=Object.assign({},this.state.localErrors),s=Date.now();e.email&&(t.email=e.email,t.email.clientTimestamp=s),e.password&&(t.password=e.password,t.password.clientTimestamp=s),e.lname&&(t.lname=e.lname,t.lname.clientTimestamp=s),e.fname&&(t.fname=e.fname,t.fname.clientTimestamp=s),e.tos_agree&&(t.tos=e.tos_agree,t.tos.clientTimestamp=s),this.setState({localErrors:t}),this.setState({isSubmitting:!1})}handleSuccess(e){if(!this.mounted)return;const t=JSON.parse(e),s={id:t.id,email:t.email,display_name:t.display_name};if(E.AuthAMPLogger.logSignupResponse(E.AuthType.CREDENTIALS,!0,null),E.EmailAuthUXAnalyticsLogger.logSignupResponse(),this.handleRegisterFormEvent(u.RegisterFormEvent.REGISTER_IMMEDIATE_SUCCESS,{userInfo:s}),!1!==this.props.canRedirect){const e=t.force_redirect_url?t.redirect_url:this.props.continuationUrlForNonGoogleSignup||t.redirect_url||"/";o.redirect(e)}else this.props.onRegisterSuccess&&this.props.onRegisterSuccess(s,t);this.setState({isSubmitting:!1})}handleRegisterFormEvent(e,t){c.pushMarketingEvent(e,this.props.pushConversionDataReadyMarketingEvent),this.props.onRegisterFormEvent&&this.props.onRegisterFormEvent(e,t)}registerData(){const[e,t]=c.getFormattedName(this.state.fname,this.state.lname,this.props.combinedName),s=o.get_uri().getQuery(),{email:a,password:r,tosAgree:i,marketingOptIn:n,inlineThirdPartySignupState:l}=this.state,{additionalParams:u,thirdPartyInitiatedSignupData:m}=this.props,d=Object.assign({fname:e,lname:t,email:a,tos_agree:i},this.thirdPartySignupInitiated?{}:{password:r}),p=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({cont:this.props.continuationUrlForNonGoogleSignup,signup_endpoint:this.props.signupEndpoint,demandbase_override:s.demandbase_override,marketing_opt_in:n},d),m||{}),l||{}),this.viewComponent&&this.viewComponent.getCaptchaResponses()||{}),u);return _.setWebRegisterLoggingData(p)}componentDidUpdate(e){e.emailPrefill!==this.props.emailPrefill&&this.setState({email:this.getCurrentEmail()})}clearFormErrors(e){const t=this.state.localErrors;e.fname&&(t.fname={}),e.lname&&(t.lname={}),e.email&&(t.email={}),e.password&&(t.password={}),e.tosAgree&&(t.tos={}),this.setState({localErrors:t})}getFormErrors(){const e={};if(!this.props.validateClientSide)return e;const t=Date.now();return this.state.fname?e.fname=void 0:e.fname={message_text:r.intl.formatMessage({id:"GlyhO1",defaultMessage:"Please enter your name"}),clientTimestamp:t},this.getCurrentEmail()?e.email=void 0:e.email={message_text:r.intl.formatMessage({id:"I7g4FQ",defaultMessage:"Please enter an email address"}),clientTimestamp:t},this.state.password||this.thirdPartySignupInitiated?e.password=void 0:e.password={message_text:r.intl.formatMessage({id:"LhlWCW",defaultMessage:"Please enter a password"}),clientTimestamp:t},this.state.tosAgree?e.tos=void 0:e.tos={message_text:r.intl.formatMessage({id:"yw3Lbd",defaultMessage:"Please agree to the terms of service"}),clientTimestamp:t},e}get thirdPartySignupInitiated(){return!!this.props.thirdPartyInitiatedSignupData||!!this.state.inlineThirdPartySignupState}componentDidMount(){this.setState({shouldDisableForm:!1}),this.props.markTti&&f.mark_time_to_interactive(),this.mounted=!0,E.AuthAMPLogger.logSignupIntent(),document.addEventListener("click",this.handleResendClick)}componentWillUnmount(){this.mounted=!1,document.removeEventListener("click",this.handleResendClick)}get shouldDisableForm(){return!!this.props.disabled||this.state.shouldDisableForm}render(){const{marketingOptInProps:e={},variant:t,emailProps:s,maestroStyle:r,className:o,combinedName:i,fnameProps:n,lnameProps:c,passwordProps:u,persistLabel:d,tosCheckboxProps:p,submitButtonProps:g,googleRegisterProps:h,showSplitSignupFlow:f,loginBasicSignupsVariant:_}=this.props;return a.default.createElement(m.RegisterFormView,{ref:this.setViewComponent,variant:t||l.AuthFormVariant.STANDARD,maestroStyle:!!r,disabled:this.shouldDisableForm,className:o,combinedName:!!i,fnameProps:n||{},fnameValue:this.state.fname,fnameError:this.state.localErrors.fname,lnameProps:c||{},lnameValue:this.state.lname,lnameError:this.state.localErrors.lname,emailProps:s||{},emailValue:this.getCurrentEmail(),emailError:this.state.localErrors.email,passwordProps:u||{},passwordValue:this.state.password,passwordError:this.state.localErrors.password,tosCheckboxProps:p||{},tosChecked:this.state.tosAgree,tosError:this.state.localErrors.tos,submitButtonProps:g||{},googleRegisterProps:h,thirdPartyInitiatedSignup:this.thirdPartySignupInitiated,isSubmitting:this.state.isSubmitting,onClickSignUp:this.onClickSignUp,onInputChange:this.onInputChange,onSubmit:this.onSubmit,onCaptchaReady:this.onCaptchaReady,onGoogleRegisterClick:this.onGoogleRegisterClick,showMarketingOptIn:!!e.show,marketingOptInChecked:this.state.marketingOptIn,splitSignupEnabled:f,loginBasicSignupsVariant:_,persistLabel:!!d})}}function y(e,t,s,a,o){if(!0===t)return void e.preventDefault();const i=new S.NoAuthApiV2Client;a(),i.ns("team").rpc("logged_out_resend_pending_invite_email",{email:s},{}).then(()=>{b.Notify.success(r.intl.formatMessage({id:"un5VKD",defaultMessage:"Invite resent to {email}"},{email:s})),o()}).catch(e=>{b.Notify.error(r.intl.formatMessage({id:"yqLGvW",defaultMessage:"Failed to resend invite."})),o()}),e.preventDefault()}t.TestOnlyRegisterFormComponent=v,v.displayName="RegisterFormComponent",t.handleInviteResendImpl=y,t.RegisterForm=h.requireCssWithComponent(v,["/static/css/login_or_register-vflUMxt4M.css","/static/css/components/login_form-vflPyw88n.css","/static/css/components/button-vfl7d2xHj.css"])})),define("metaserver/static/js/modules/clean/auth/register/google_register_button",["require","exports","tslib","classnames","react","metaserver/static/js/modules/core/i18n"],(function(e,t,s,a,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GoogleRegisterButton=void 0,a=s.__importDefault(a),r=s.__importDefault(r),t.GoogleRegisterButton=e=>{const t=e.buttonProps||{},s=a.default("auth-google","button-primary",t.className,{[`button-${t.variant}`]:"standard"!==t.variant}),i=t.text||o.intl.formatMessage({id:"M4SS1n",defaultMessage:"Sign up with Google"});return r.default.createElement("button",{className:s,type:"button",onClick:e.onClick,disabled:e.disabled||t.disabled,"data-uxa-log":"google_signup_start"},r.default.createElement("span",{className:"sign-up-text"},i))}})),define("metaserver/static/js/modules/clean/auth/register/name_fields",["require","exports","tslib","classnames","react","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/clean/auth/common/inputs/text","metaserver/static/js/modules/clean/auth/common/types","metaserver/static/js/modules/clean/auth/common/utils"],(function(e,t,s,a,r,o,i,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RegisterFormNameFields=void 0,a=s.__importDefault(a),r=s.__importDefault(r),t.RegisterFormNameFields=e=>{const t=e.fnameProps||{};if(e.combinedName){const s=a.default("exp-input-combined-name","clearfix",t.className);return r.default.createElement("div",{className:"register-form__name-fields"},r.default.createElement(i.AuthTextField,{placeholder:t.placeholder||(e.maestroStyle?o.intl.formatMessage({id:"yse7tr",defaultMessage:"Jane Doe"}):o.intl.formatMessage({id:"7raSCH",defaultMessage:"Full name"})),name:"fname",value:e.fnameValue,onChange:e.onInputChange,disabled:e.disabled||t.readonly||!1,label:t.label||(e.maestroStyle?o.intl.formatMessage({id:"7raSCH",defaultMessage:"Full name"}):void 0),error:e.fnameError,maestroStyle:e.maestroStyle,className:s,variant:e.variant,type:n.AuthTextInputType.TEXT}))}const s=e.lnameProps||{},c=["first","text-input__margin-right"],u=["second"];let m=["input-fname",t.className],d=["input-lname",s.className];l.lastNameGoesFirst()?(d=[...d,...c],m=[...m,...u]):(m=[...m,...c],d=[...d,...u]);const p=r.default.createElement(i.AuthTextField,{className:a.default(m),name:"fname",value:e.fnameValue,onChange:e.onInputChange,error:e.fnameError,maestroStyle:e.maestroStyle,disabled:e.disabled||t.readonly||!1,label:t.label||(e.maestroStyle?o.intl.formatMessage({id:"flaKkC",defaultMessage:"First name"}):void 0),placeholder:t.placeholder||(e.maestroStyle?o.intl.formatMessage({id:"G3gJf8",defaultMessage:"Jane"}):o.intl.formatMessage({id:"flaKkC",defaultMessage:"First name"})),variant:e.variant,type:n.AuthTextInputType.TEXT,persistLabel:e.persistLabel}),g=r.default.createElement(i.AuthTextField,{className:a.default(d),name:"lname",value:e.lnameValue,onChange:e.onInputChange,error:e.lnameError,disabled:e.disabled||s.readonly||!1,label:s.label||(e.maestroStyle?o.intl.formatMessage({id:"rew2qC",defaultMessage:"Last name"}):void 0),placeholder:s.placeholder||(e.maestroStyle?o.intl.formatMessage({id:"yUetMg",defaultMessage:"Doe"}):o.intl.formatMessage({id:"rew2qC",defaultMessage:"Last name"})),maestroStyle:e.maestroStyle,variant:e.variant,type:n.AuthTextInputType.TEXT,persistLabel:e.persistLabel});return l.lastNameGoesFirst()?r.default.createElement("div",{className:"register-form__name-fields"},g,p):r.default.createElement("div",{className:"register-form__name-fields"},p,g)}})),define("metaserver/static/js/modules/clean/auth/register/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RegisterFormEvent=void 0,(function(e){e.GOOGLE_REGISTER_CLICK="GOOGLE_REGISTER_CLICK",e.GOOGLE_REGISTER_SUCCESS="GOOGLE_REGISTER_SUCCESS",e.REGISTER_CLICK="REGISTER_CLICK",e.REGISTER_IMMEDIATE_SUCCESS="REGISTER_IMMEDIATE_SUCCESS"})(t.RegisterFormEvent||(t.RegisterFormEvent={}))})),define("metaserver/static/js/modules/clean/auth/register/view",["require","exports","tslib","classnames","react","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/clean/auth/common/inputs/checkbox","metaserver/static/js/modules/clean/auth/common/inputs/text","metaserver/static/js/modules/clean/auth/common/captcha","metaserver/static/js/modules/clean/auth/common/types","metaserver/static/js/modules/clean/auth/register/google_register_button","metaserver/static/js/modules/clean/auth/register/name_fields","metaserver/static/js/modules/clean/auth/common/stats"],(function(e,t,s,a,r,o,i,n,l,c,u,m,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RegisterFormView=void 0,a=s.__importDefault(a),r=s.__importDefault(r);class p extends r.default.Component{constructor(){super(...arguments),this.state={splitSignupStep:0},this.setCaptchaComponent=e=>{this.captchaComponent=e}}handleCaptchaErrors(e){return l.handle_captcha_errors(this.captchaComponent,e)}getCaptchaComponent(){return this.captchaComponent}getCaptchaResponses(){return l.get_captcha_responses(this.captchaComponent)}onContinue(){this.setState({splitSignupStep:1}),d.EmailAuthUXAnalyticsLogger.logSplitSignupContinue()}render(){const{className:e,variant:t,thirdPartyInitiatedSignup:s,tosCheckboxProps:d,onGoogleRegisterClick:p,disabled:g,isSubmitting:h,maestroStyle:f,onInputChange:_,showMarketingOptIn:E,marketingOptInChecked:S,splitSignupEnabled:b,loginBasicSignupsVariant:v}=this.props,y=a.default("form_shown","login-form-container","register",e,t,{third_party_auth:s,"login-form-container--maestro":f}),C=d||{};let w=void 0;C.unsafeLabelHTML||(w=o.intl.formatMessage({id:"QECDJM",defaultMessage:"I agree to the <a>Dropbox Terms</a>. Learn about how we use and protect your data in our <b>Privacy Policy</b>."},{a:e=>r.default.createElement("a",{href:"/terms",target:"_blank",rel:"noreferrer noopener"},e),b:e=>r.default.createElement("a",{href:"/privacy",target:"_blank",rel:"noreferrer noopener"},e)}));const L=this.props.submitButtonProps||{},R=a.default("login-button","button-primary",L.className,{"button-small":L.variant===c.AuthButtonVariant.SMALL,"button-big":L.variant===c.AuthButtonVariant.BIG}),T=a.default("continue-button","button-primary",L.className,{"button-small":L.variant===c.AuthButtonVariant.SMALL,"button-big":L.variant===c.AuthButtonVariant.BIG}),M=this.props.thirdPartyInitiatedSignup,A=!!this.props.googleRegisterProps&&!M,N=this.props.googleRegisterProps||{},I=r.default.createElement(u.GoogleRegisterButton,{onClick:p,disabled:g||h,buttonProps:N.buttonProps}),O=r.default.createElement("div",{className:"hr-label"},r.default.createElement("span",{className:"hr-label__text"},o.intl.formatMessage({id:"F1g1bb",defaultMessage:"or"}))),F=!!v&&["V1"].includes(v),k=this.props.emailProps||{},P=a.default("input-email","text-input__margin-right",k.className),x=this.props.passwordProps||{},j=a.default("input-password",x.className);let D=this.props.maestroStyle||!!v&&["V2"].includes(v);"TOP"===N.position?D=!0:"BOTTOM"===N.position&&(D=!1);const U=C.variant||t,G=void 0===C.inline||C.inline,q=M?o.intl.formatMessage({id:"j7O6M6",defaultMessage:"Create and continue"}):L.text||o.intl.formatMessage({id:"P09UfX",defaultMessage:"Create an account"}),H=o.intl.formatMessage({id:"pV/Btf",defaultMessage:"Continue"}),B=r.default.createElement(n.AuthTextField,{value:this.props.emailValue,className:P,onChange:_,disabled:g||k.readonly||!1,label:k.label||(f?o.intl.formatMessage({id:"ZuKPpH",defaultMessage:"Email"}):void 0),placeholder:k.placeholder||(this.props.maestroStyle?o.intl.formatMessage({id:"87vAZJ",defaultMessage:"you@mail.com"}):o.intl.formatMessage({id:"ZbTBdC",defaultMessage:"Email"})),error:this.props.emailError,maestroStyle:f,name:"email",type:c.AuthTextInputType.EMAIL,variant:t,persistLabel:this.props.persistLabel});return b&&0===this.state.splitSignupStep?r.default.createElement("div",{className:y},r.default.createElement("form",{className:"clearfix credentials-form register-form",onSubmit:this.props.onClickSignUp,method:"post"},r.default.createElement("div",{className:"credentials-form__fields"},r.default.createElement("div",{className:"register-form__credential-fields"}),r.default.createElement("div",{className:"split-signup-fields"},B,r.default.createElement("button",{className:T,type:"submit","data-uxa-log":"register_form_continue_button",onClick:()=>this.onContinue()},r.default.createElement("span",null,H)))),A&&r.default.createElement("div",{className:"hr-split-signup"}),A&&I,A&&r.default.createElement(l.Captcha,{ref:this.setCaptchaComponent,email:this.props.emailValue,onSubmit:this.props.onSubmit,onReady:this.props.onCaptchaReady,source:"REGISTER"}))):r.default.createElement("div",{className:y},r.default.createElement("form",{className:"clearfix credentials-form register-form",onSubmit:this.props.onClickSignUp,method:"post"},D&&A&&I,D&&A&&O,r.default.createElement("div",{className:"credentials-form__fields"},r.default.createElement(m.RegisterFormNameFields,{maestroStyle:f,onInputChange:_,combinedName:this.props.combinedName,fnameError:this.props.fnameError,fnameProps:this.props.fnameProps,lnameError:this.props.lnameError,lnameProps:this.props.lnameProps,fnameValue:this.props.fnameValue,lnameValue:this.props.lnameValue,disabled:g,variant:t,persistLabel:this.props.persistLabel}),r.default.createElement("div",{className:"register-form__credential-fields"},B,!this.props.thirdPartyInitiatedSignup&&r.default.createElement(n.AuthTextField,{value:this.props.passwordValue,placeholder:x.placeholder||(this.props.maestroStyle?o.intl.formatMessage({id:"klwYHA",defaultMessage:"Minimum 6 characters"}):o.intl.formatMessage({id:"i+PJQ7",defaultMessage:"Password"})),name:"password",className:j,inputClassName:"password-input",onChange:_,measureStrength:x.measureStrength,label:x.label||(f?o.intl.formatMessage({id:"i+PJQ7",defaultMessage:"Password"}):void 0),error:this.props.passwordError,maestroStyle:f,disabled:g,variant:t,passwordStrengthProps:x.strengthMeterProps,type:c.AuthTextInputType.PASSWORD,persistLabel:this.props.persistLabel}))),r.default.createElement(i.AuthCheckbox,{variant:U,className:"agree",disabled:C.disabled||g,maestroStyle:f,error:this.props.tosError,inline:G,onChange:_,name:"tos_agree",checked:this.props.tosChecked,label:C.label||w,unsafeLabelHTML:C.unsafeLabelHTML}),E&&r.default.createElement(i.AuthCheckbox,{variant:U,className:"agree marketing-opt-in-checkbox",disabled:g,maestroStyle:f,inline:G,onChange:_,checked:S,name:"marketing_opt_in",label:o.intl.formatMessage({id:"vRE9NS",defaultMessage:"I’d like to receive direct marketing email updates from Dropbox"})}),r.default.createElement("button",{className:R,type:"submit","data-uxa-log":"register_form_submit_button",disabled:this.props.disabled||L.disabled||this.props.isSubmitting},r.default.createElement("span",null,q)),F&&!D&&A&&O,!D&&A&&I,r.default.createElement(l.Captcha,{ref:this.setCaptchaComponent,email:this.props.emailValue,onSubmit:this.props.onSubmit,onReady:this.props.onCaptchaReady,source:"REGISTER"})))}}t.RegisterFormView=p,p.displayName="RegisterFormView"})),define("metaserver/static/js/modules/clean/components/password_strength_meter",["require","exports","tslib","react","classnames","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/clean/react/components/css","metaserver/static/js/modules/clean/react/bubble_dropdown_v2","metaserver/static/js/modules/clean/web_timing_logger","metaserver/static/js/modules/core/cancelable_promise","metaserver/static/js/modules/clean/react/sticky_position","dig-components/tooltips"],(function(e,t,s,a,r,o,i,n,l,c,u,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PasswordStrengthMeter=void 0,a=s.__importDefault(a),r=s.__importDefault(r);class d extends a.default.Component{constructor(t){super(t),this.setZxcvbn=({default:e})=>{this.setState({zxcvbn:e})},this.getPasswordScore=e=>this.state.zxcvbn?this.state.zxcvbn(e).score:0,this.renderPasswordDots=(e,t)=>{const{isDigEnabled:s,bubblePosition:r,bubbleClassName:i,bubbleDescription:l}=this.props,c=o.intl.formatMessage({id:"6SDr7W",defaultMessage:"Passwords must be 6 characters or more. Good passwords are hard to guess and use uncommon words, numbers, symbols, and uppercase letters."}),m=l||c;return s?a.default.createElement(g,{score:e,title:t,description:m,className:i}):a.default.createElement(a.default.Fragment,null,a.default.createElement(p,{score:e}),a.default.createElement(n.BubbleDropdown,{position:r||u.StickyPosition.RIGHT,targetButton:a.default.createElement("button",{type:"button","aria-label":o.intl.formatMessage({id:"bjXtDK",defaultMessage:"Show more information about password strength."}),className:"password-bubble__button"}),className:i},a.default.createElement("div",{className:"password-bubble__content"},a.default.createElement("div",{className:"password-bubble__title"},t||""),a.default.createElement("div",{className:"password-bubble__desc"},m))))},this.state={},t.zxcvbnPostTti?l.waitForTTI().then(()=>{this.zxcvbnPromise=c.makeCancelable(new Promise((t,s)=>{e(["zxcvbn"],t,s)}).then(s.__importStar)),this.zxcvbnPromise.then(this.setZxcvbn)}):(this.zxcvbnPromise=c.makeCancelable(new Promise((t,s)=>{e(["zxcvbn"],t,s)}).then(s.__importStar)),this.zxcvbnPromise.then(this.setZxcvbn))}componentWillUnmount(){this.zxcvbnPromise&&this.zxcvbnPromise.cancel()}getTitle(e){return["",o.intl.formatMessage({id:"i/ragh",defaultMessage:"Weak"}),o.intl.formatMessage({id:"GwYES8",defaultMessage:"So-so"}),o.intl.formatMessage({id:"Yd7c8F",defaultMessage:"Good"}),o.intl.formatMessage({id:"kbsmZh",defaultMessage:"Great!"})][e]}render(){const{password:e,className:t}=this.props,s=e.length?Math.max(1,this.getPasswordScore(e)):0,i=this.getTitle(s);return a.default.createElement("div",{className:r.default("password-input-meter",{[`${t}`]:t}),"aria-label":o.intl.formatMessage({id:"7h/xn+",defaultMessage:"Password strength"})},a.default.createElement("span",{"aria-live":"assertive",className:"ax-visually-hidden"},i),this.renderPasswordDots(s,i))}}d.displayName="PasswordStrengthMeterComponent";const p=({score:e})=>a.default.createElement(a.default.Fragment,null,[4,3,2,1].map(t=>{const s=r.default({"password-input-dot":!0,"password-input-dot-selected--weak":e>=t&&e<=2,"password-input-dot-selected":e>=t});return a.default.createElement("div",{key:"password-input-dot-"+t,className:s})})),g=({score:e,description:t,title:s,className:r})=>{const o=s?`(${s}) ${t}`:`${t}`;return a.default.createElement(m.Tooltip,{title:o,placement:"right",className:r},a.default.createElement("span",{tabIndex:0},a.default.createElement(p,{score:e})))};t.PasswordStrengthMeter=i.requireCssWithComponent(d,["/static/css/components/password_strength_meter-vfl-vxQ_W.css"])})),define("metaserver/static/js/modules/clean/form_util/name_parser",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{static splitFullName(e){const t=e.split(" ");return[t[0],t.slice(1).join(" ")]}}}));
//# sourceMappingURL=pkg-login-and-register-pages.min.js-vfl9A8J2v.map