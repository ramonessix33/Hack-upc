define(["require","exports","tslib","react","typescript/libraries/file-viewer/src/preview_error/index","typescript/libraries/file-viewer/src/renderer","typescript/libraries/file-viewer/src/core/data/preview_key","typescript/libraries/file-viewer/src/core/logging/constants","typescript/libraries/file-viewer/src/core/data/selectors","typescript/libraries/file-viewer/src/core/data/actions","lodash","typescript/libraries/file-viewer/src/toolbar/toolbar_v2","typescript/libraries/file-viewer/src/core/utils/support","typescript/libraries/file-viewer/src/core/data/utils","typescript/libraries/file-viewer/src/core/logging/actions","typescript/libraries/file-viewer/src/core/utils/index","typescript/libraries/file-viewer/src/plugins/types","typescript/libraries/file-viewer/src/core/extension_constants"],(function(e,i,r,l,t,n,s,a,o,c,v,p,w,f,d,u,_,y){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.FileEntryView=void 0,l=r.__importStar(l),i.FileEntryView=e=>{var i,r,g,P,S,F,b,E,m,I,h,T;const{intl:D,rootArchiveFileInformation:V,isArchiveFilePasswordProtected:A,rootFileId:x,entry:R,archiveFiles:C,fullFilePreviewUi:M,fullRivieraData:N,dispatch:j,fileViewerId:z,currentPath:U,config:K,loggingSession:O,fileConfig:k,previewKey:q,rivieraData:W,coreFileViewerUiData:B,fileMetadata:G,filePreviewUiData:H,toolbarPlugins:J,snackbarManagerPluginInstance:L,width:Q,responsiveSize:X}=e,Y=s.getPreviewKeyForNestedArchiveFile(x,s.getSubpath(U)),Z=o.getArchiveFilesPreviewMetadata(C,Y),$=w.resolvePreviewType(Z),ee=l.useRef(null),ie=l.useRef(null),re=l.useRef(null),le=l.useRef(null),te=l.useRef(null),ne=l.useRef(null),se=l.useRef(null),ae=l.useRef(null);if(ee.current!==R&&(ee.current=R,j(c.initializeFilePreviewSession({fileViewerId:O.file_viewer_session_id,fileId:O.file_id,sjId:O.sj_id,nsId:O.ns_id,deviceType:O.device_type,fileExtension:u.getFileExtension(R.name),sourceSession:{source_action:a.SourceAction.Click,source_context:a.SourceContext.ArchiveFile,page_start_ts:Date.now(),preview_type:$}})),re.current=v.once(e=>j(d.logSessionEvent({event:a.SessionEventType.FilePreviewAttemptStarted,fileViewerId:z,previewSessionId:e}))),le.current=v.once(e=>j(d.logSessionEvent({event:a.SessionEventType.FilePreviewSupportConfirmed,fileViewerId:z,previewSessionId:e}))),te.current=v.once(e=>j(d.logSessionEvent({event:a.SessionEventType.FilePreviewSupportDenied,fileViewerId:z,previewSessionId:e}))),ne.current=v.once(e=>j(d.logSessionEvent({event:a.SessionEventType.FilePreviewDownloadAttempted,fileViewerId:z,previewSessionId:e}))),se.current=v.once(e=>j(d.logSessionEvent({event:a.SessionEventType.FilePreviewDownloadSucceeded,fileViewerId:z,previewSessionId:e}))),ae.current=v.once(e=>j(d.logSessionEvent({event:a.SessionEventType.FilePreviewDownloadFailed,fileViewerId:z,previewSessionId:e}))),ie.current=O.file_preview_session_id),null!==ie.current&&ie.current===O.file_preview_session_id)return null;if(ie.current=null,null===(i=re.current)||void 0===i||i.call(re,O.file_preview_session_id),A)return null===(r=te.current)||void 0===r||r.call(te,O.file_preview_session_id),l.createElement(t.ArchiveFilePasswordProtected,{intl:D,fileName:V.fileName});switch($){case _.PreviewType.Audio:case _.PreviewType.Video:case _.PreviewType.Archive:case _.PreviewType.Error:null===(g=te.current)||void 0===g||g.call(te,O.file_preview_session_id);let e,i=$;if($==_.PreviewType.Error){const e=u.getFileExtension(R.name);e&&(i=y.resolvePreviewTypeFromExtension(e))}switch(i){case _.PreviewType.Audio:case _.PreviewType.Video:case _.PreviewType.Archive:e=l.createElement(t.ArchiveNestedFiletypeNotSupported,{fileName:R.name,fileSize:null!==(P=R.size)&&void 0!==P?P:0,intl:D});break;default:e=l.createElement(t.ArchiveFileUnavailable,{fileName:R.name,fileSize:null!==(S=R.size)&&void 0!==S?S:0,intl:D})}return l.createElement(l.Fragment,null,e,K.preview_page_revamp&&l.createElement(p.ConfigurableToolbarV2,{featureConfig:K,fileConfig:k,previewKey:q,rootArchiveFileInformation:V,fileViewerId:z,intl:D,fileRivieraData:W,fileViewerUi:B,fileMetadata:G,filePreviewUi:H,previewType:_.PreviewType.Archive,plugins:J,snackbarManagerPluginInstance:L,previewWidth:Q,responsiveSize:X}))}const oe=o.getFilePreviewUiData(M,Y);if(!oe)return j(c.initializeNestedArchiveFilePreview({fileViewerId:z,currentPath:U,previewKey:Y,previewType:w.resolvePreviewType(o.getArchiveFilesPreviewMetadata(C,Y))})),null===(F=le.current)||void 0===F||F.call(le,O.file_preview_session_id),null===(b=ne.current)||void 0===b||b.call(ne,O.file_preview_session_id),j(c.fetchRivieraData({fileViewerId:z,previewKey:Y,config:K})),null;null===(E=le.current)||void 0===E||E.call(le,O.file_preview_session_id),null===(m=ne.current)||void 0===m||m.call(ne,O.file_preview_session_id);const ce=Object.assign(Object.assign({},e),{extractConfig:{canExtract:!1},fileConfig:e.fileConfig?Object.assign(Object.assign({},e.fileConfig),{enable_print:!1}):e.fileConfig,fileInfo:void 0,previewKey:Y,fileMetadata:{file_name:R.name,file_collection_context:null==G?void 0:G.file_collection_context},previewMetadata:Z,filePreviewUiData:oe,rivieraData:o.getRivieraDataFromSlice(N,Y)});if($===_.PreviewType.SsrDoc){if(!ce.rivieraData)return null;f.isDocPreviewRivieraData(ce.rivieraData)&&ce.rivieraData.error?null===(I=ae.current)||void 0===I||I.call(ae,O.file_preview_session_id):null===(h=se.current)||void 0===h||h.call(se,O.file_preview_session_id)}else null===(T=se.current)||void 0===T||T.call(se,O.file_preview_session_id);return l.createElement(n.PreviewRenderer,Object.assign({},ce))},i.FileEntryView.displayName="FileEntryView"}));
//# sourceMappingURL=file_entry_view.amd.min.js-vfl4firrR.map