define("metaserver/static/js/modules/clean/react/file_viewer/constants",["require","exports","metaserver/static/js/modules/clean/react/size_class/constants"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DOCSEND_PROD_APP_ID=t.HELLOSIGN_PROD_APP_ID=t.OverflowMenuDirection=t.DocType=t.PreviewsUpsellUrl=t.UnsupportedExtensionHelpLink=t.PageQueryKey=t.SubpathQueryKey=t.ResponsiveClassName=t.SizeClassFilenameLengthMap=t.SplitButtonActionLocation=t.UserActionContext=t.UserAction=t.FileViewerPane=t.FileViewerInterfaceType=t.CannedTestFilename=t.EventType=t.PreviewRenderStatus=t.ActionType=void 0,(function(e){e.Setup="SETUP",e.Cleanup="CLEANUP",e.UpdateFiles="UPDATE_FILES",e.FlipNext="FLIP_NEXT",e.FlipPrevious="FLIP_PREVIOUS",e.OpenFullscreen="OPEN_FULLSCREEN",e.CloseFullscreen="CLOSE_FULLSCREEN",e.SwitchRevision="SWITCH_REVISION",e.RestoreRevision="RESTORE_REVISION",e.SaveForwardRevision="SAVE_FORWARD_REVISION",e.BroadcastRenderStatus="BROADCAST_RENDER_STATUS",e.HideOpenInAppBanner="HIDE_OPEN_IN_APP_BANNER"})(t.ActionType||(t.ActionType={})),(function(e){e[e.Unknown=0]="Unknown",e[e.Loading=1]="Loading",e[e.Succeeded=2]="Succeeded"})(t.PreviewRenderStatus||(t.PreviewRenderStatus={})),(function(e){e.FileViewerOpened="FILE_VIEWER_OPENED",e.FilePreviewSessionEnded="FILE_PREVIEW_SESSION_ENDED",e.FilePreviewAttemptStarted="FILE_PREVIEW_ATTEMPT_STARTED",e.FilePreviewSupportConfirmed="FILE_PREVIEW_SUPPORT_CONFIRMED",e.FilePreviewSupportDenied="FILE_PREVIEW_SUPPORT_DENIED",e.FilePreviewDownloadAttempted="FILE_PREVIEW_DOWNLOAD_ATTEMPTED",e.FilePreviewDownloadSucceeded="FILE_PREVIEW_DOWNLOAD_SUCCEEDED",e.FilePreviewDownloadFailed="FILE_PREVIEW_DOWNLOAD_FAILED",e.FilePreviewRenderSucceeded="FILE_PREVIEW_RENDER_SUCCEEDED",e.FilePreviewRenderFailed="FILE_PREVIEW_RENDER_FAILED",e.FilePreviewPASSShown="FILE_PREVIEW_PASS_SHOWN",e.FilePreviewPASSHover="FILE_PREVIEW_PASS_HOVER",e.FilePreviewPASSClick="FILE_PREVIEW_PASS_CLICK",e.BrowsePASSShown="BROWSE_PASS_SHOWN",e.BrowsePASSHover="BROWSE_PASS_HOVER",e.BrowsePASSClick="BROWSE_PASS_CLICK",e.FilePreviewFidelitySurveyAsked="FILE_PREVIEW_FIDELITY_SURVEY_ASKED",e.FilePreviewFidelitySurveyAnswered="FILE_PREVIEW_FIDELITY_SURVEY_ANSWERED",e.FilePreviewFidelitySurveyDismissed="FILE_PREVIEW_FIDELITY_SURVEY_DISMISSED",e.FilePreviewUserAction="FILE_PREVIEW_USER_ACTION",e.FilePreviewVideoStalled="FILE_PREVIEW_VIDEO_STALLED",e.FilePreviewVideoToggled="FILE_PREVIEW_VIDEO_TOGGLED",e.FilePreviewVideoTruncated="FILE_PREVIEW_VIDEO_TRUNCATED",e.ArchivePreviewContentsScanned="ARCHIVE_PREVIEW_CONTENTS_SCANNED",e.FilePreviewModeDetermined="FILE_PREVIEW_MODE_DETERMINED",e.FilePreviewModeBounce="FILE_PREVIEW_MODE_BOUNCE",e.SidebarPaneSelected="SIDEBAR_PANE_SELECTED",e.SidebarModeSelected="SIDEBAR_MODE_SELECTED",e.SidebarOpened="SIDEBAR_OPENED",e.SidebarClosed="SIDEBAR_CLOSED",e.SidebarCollapsedShareClicked="SIDEBAR_COLLAPSED_SHARE_CLICKED",e.SidebarOpenedShareClicked="SIDEBAR_OPENED_SHARE_CLICKED",e.FilePreviewUpsellExposed="FILE_PREVIEW_UPSELL_EXPOSED",e.FilePreviewUpsellClicked="FILE_PREVIEW_UPSELL_CLICKED",e.PersistentFooterShown="PERSISTENT_FOOTER_SHOWN",e.DecompressInitiated="DECOMPRESS_INITIATED",e.DecompressSucceeded="DECOMPRESS_SUCCEEDED",e.DecompressFailed="DECOMPRESS_FAILED"})(t.EventType||(t.EventType={})),(function(e){e.ExcelHTML="test-workbook.html"})(t.CannedTestFilename||(t.CannedTestFilename={})),(function(e){e[e.Frame=0]="Frame",e[e.Window=1]="Window"})(t.FileViewerInterfaceType||(t.FileViewerInterfaceType={})),(function(e){e[e.TitleBar=0]="TitleBar",e[e.PreviewContent=1]="PreviewContent",e[e.Sidebar=2]="Sidebar"})(t.FileViewerPane||(t.FileViewerPane={})),(function(e){e.AppDownloadInterstitialClose="app_download_interstitial_close",e.AppDownloadInterstitialContinue="app_download_interstitial_continue",e.AppDownloadInterstitialInstall="app_download_interstitial_install",e.AppDownloadInterstitialView="app_download_interstitial_view",e.ArchiveNavigation="archive_navigation",e.CopyToPaper="copy_to_paper",e.ConvertAndShare="convert_and_share",e.Share="share",e.Download="download",e.AddToDropbox="add_to_dropbox",e.SaveToDropbox="save_to_dropbox",e.SaveToDropboxPersonal="save_to_dropbox_personal",e.SaveToDropboxWork="save_to_dropbox_work",e.SaveToDropboxApprove="save_to_dropbox_approve",e.SaveToDropboxCancel="save_to_dropbox_cancel",e.RequestAccess="request_access",e.RequestAccessSend="request_access_send",e.RequestAccessCancel="request_access_cancel",e.OpenInApp="open_in_app",e.OpenInNewTab="open_in_new_tab",e.OpenInOfficeOnline="open_in_office_online",e.OpenInUnity="open_in_unity",e.OpenInUnityFolder="open_in_unity_folder",e.OpenWithAppAction="open_with_app_action",e.OpenWithCloudDocEditor="open_with_cloud_doc_editor",e.OpenPrepareForSignature="open_prepare_for_signature",e.ModeChange="mode_change",e.PageChange="page_change",e.PageUp="page_up",e.PageDown="page_down",e.PresentInZoom="present_in_zoom",e.RemoveLink="remove_link",e.ShareToSlack="share_to_slack",e.ShareToTrello="share_to_trello",e.ShareToAction="share_to_action",e.SendForSignatureAction="send_for_signature",e.InviteViaEmail="invite_via_email",e.ViewRevisions="view_revisions",e.ClickDropboxLogo="click_dropbox_logo",e.ClickCustomLogo="click_custom_logo",e.ToggleCommentsOn="toggle_comments_on",e.ToggleCommentsOff="toggle_comments_off",e.SignIn="sign_in",e.SignUp="sign_up",e.ClickNotifications="click_notifications",e.ClickAccountMenu="click_account_menu",e.ToggleFullscreenOn="toggle_fullscreen_on",e.ToggleFullscreenOff="toggle_fullscreen_off",e.ToggleSidebarOn="toggle_sidebar_on",e.ToggleSidebarOff="toggle_sidebar_off",e.Print="print",e.InlineSearch="inline_search",e.FlipNext="flip_next",e.FlipPrevious="flip_prev",e.ZoomIn="zoom_in",e.ZoomOut="zoom_out",e.VideoPlaybackRateChanged="playback_rate_changed",e.OpenMoreApps="open_more_apps",e.OpenAddApps="open_add_apps",e.OpenInDesktop="open_in_desktop",e.SelectShowMore="select_show_more",e.SelectAddApp="select_add_app",e.ScrollUp="scroll_up",e.ScrollDown="scroll_down",e.Dismiss="dismiss",e.LearnMore="learn_more",e.AddSuggestedComment="add_suggested_comment",e.SwitchWorkbookTab="switch_workbook_tab",e.SelectWorkbookContent="select_workbook_content",e.ClickSocialShareButton="click_social_share_button",e.ToggleShareRecept="toggle_share_receipt",e.DecompressFile="decompress_file",e.GoToFolder="go_to_folder",e.DecompressCloseSnackbar="decompress_close_snackbar",e.DecompressRetry="decompress_retry",e.ConvertFile="convert_file",e.SaveAs="save_as",e.PreviewFile="preview_file",e.Transfer="transfer",e.FileConversionInitiated="file_conversion_initiated",e.FileConversionRetry="file_conversion_retry",e.FileConversionCloseSnackbar="file_conversion_close_snackbar",e.OpenInReplay="open_in_replay",e.CreateClientPortal="create_client_portal",e.EditClientPortal="edit_client_portal"})(t.UserAction||(t.UserAction={})),(function(e){e.AppDownloadInterstitial="app_download_interstitial",e.TitleBarMain="title_bar_main",e.TitleBarSplitButton="title_bar_open_split_button",e.TitleBarMore="title_bar_more",e.TitleBarBackButton="title_bar_back_button",e.TitleBarSecondaryButton="title_bar_secondary_button",e.PreviewContentMain="preview_content_main",e.PreviewContentSplitButton="preview_content_open_split_button",e.Toolbar="toolbar",e.VideoPlayer="video_player",e.OpenInAppBanner="open_in_app_banner",e.LightboxFrame="lightbox_frame",e.LightboxToolbar="lightbox_toolbar",e.LightboxCloseButton="lightbox_close_button",e.Sidebar="sidebar",e.Keyboard="keyboard",e.Browser="browser",e.Unknown="unknown",e.PersistentFooter="persistent_footer",e.Snackbar="snackbar",e.RichSnackbar="rich_snackbar"})(t.UserActionContext||(t.UserActionContext={})),(function(e){e[e.Main=0]="Main",e[e.Split=1]="Split"})(t.SplitButtonActionLocation||(t.SplitButtonActionLocation={}));t.SizeClassFilenameLengthMap={[i.SizeClass.Small]:12,[i.SizeClass.Medium]:25,[i.SizeClass.Large]:35,[i.SizeClass.ExtraLarge]:45},t.ResponsiveClassName="responsive-enabled",t.SubpathQueryKey="file_subpath",t.PageQueryKey="page",t.UnsupportedExtensionHelpLink="https://www.dropbox.com/help/files-folders/file-types-that-preview",t.PreviewsUpsellUrl="/pro?_tk=autocad_modal",(function(e){e.default="default",e.html="html",e.pdf="pdf",e.ppt="ppt",e.spreadsheet="spreadsheet",e.image="image"})(t.DocType||(t.DocType={})),(function(e){e[e.ABOVE=0]="ABOVE",e[e.BELOW=1]="BELOW"})(t.OverflowMenuDirection||(t.OverflowMenuDirection={})),t.HELLOSIGN_PROD_APP_ID="dbaid:AAA8M7BsKD8QVXgtkUl5Rs7oFykwEx3Vm7U",t.DOCSEND_PROD_APP_ID="dbaid:AAA6hDRnKKWTEvY7Xb4xVXwWZA8c8Af3GOM"})),define("metaserver/static/js/modules/clean/react/file_viewer/file_preview_event_emitter",["require","exports","tslib","eventemitter3"],(function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.filePreviewEventEmitter=void 0,o=i.__importDefault(o),t.filePreviewEventEmitter=new o.default})),define("metaserver/static/js/modules/clean/react/file_viewer/models",["require","exports","metaserver/static/js/modules/clean/react/file_viewer/constants","metaserver/static/js/modules/clean/react/file_viewer/file_preview_event_emitter","metaserver/static/js/modules/clean/react/previews/constants","metaserver/static/js/modules/clean/uuid/uuid","metaserver/static/js/modules/clean/web_timing_logger","metaserver/static/js/modules/core/assert","metaserver/static/js/modules/clean/perf_tools/web_timing_utils","metaserver/static/js/modules/core/browser_detection"],(function(e,t,i,o,r,n,s,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilePreviewSession=t.FileViewerSession=void 0;const d={};d[i.EventType.FilePreviewAttemptStarted]=null,d[i.EventType.FilePreviewSupportConfirmed]=i.EventType.FilePreviewAttemptStarted,d[i.EventType.FilePreviewSupportDenied]=i.EventType.FilePreviewAttemptStarted,d[i.EventType.FilePreviewDownloadAttempted]=i.EventType.FilePreviewSupportConfirmed,d[i.EventType.FilePreviewDownloadSucceeded]=i.EventType.FilePreviewDownloadAttempted,d[i.EventType.FilePreviewDownloadFailed]=i.EventType.FilePreviewDownloadAttempted,d[i.EventType.FilePreviewRenderSucceeded]=i.EventType.FilePreviewDownloadSucceeded,d[i.EventType.FilePreviewRenderFailed]=i.EventType.FilePreviewDownloadSucceeded;class u{constructor(e){this.id=e||n.UUID.v4({allowInsecure:!0}),this.deviceType=this._deviceTypeString()}_deviceTypeString(){return c.is_supported_mobile_browser()?"mobile":c.is_tablet()?"tablet":"desktop"}}t.FileViewerSession=u,u.currentSession=null;class p{constructor({id:e,fileViewerSession:t,file:i,previewType:o,sourceContext:r,sourceAction:s,extra:l}){this.passwordNeeded=!1,a.assert(!!t,"FileViewerSession required"),a.assert(!!i,"File required"),this.id=e||n.UUID.v4({allowInsecure:!0}),this.fileViewerSession=t,this.file=i,this.previewType=o,this.sourceContext=r,this.sourceAction=s,this.previewTimeline={},this.lastEvent=null,this.extra=l||{}}recordEvent(e,t={}){if(!(t instanceof Object))throw new Error("extra param of recordEvent should be an object.");this.isEventInTimeline(e)||d.hasOwnProperty(e)&&this.lastEvent!==d[e]||(this.addToTimeline(e),o.filePreviewEventEmitter.emit(e,this,Object.assign(Object.assign({},this.extra),t)),this.lastEvent=e)}markPrimaryEvent(){let e;e=window._timingData&&window._timingData.tti?window._timingData.tti.getTime():l.WebTimingUtil.getNow(),this.primaryMarkTs||(this.primaryMarkTs=e)}timeToPrimaryMark(){return this.timeToMark(this.primaryMarkTs)}timeToMark(e){if(void 0!==e)switch(this.sourceAction){default:return;case r.PreviewSourceAction.Visit:const t=s.start_time();return void 0!==t?e-t:void 0;case r.PreviewSourceAction.Click:const o=this.previewTimeline[i.EventType.FilePreviewAttemptStarted];if(!o)return;const n=o.timestamp;if(void 0===n)return;return e-n}}isEventInTimeline(e){return e in this.previewTimeline}addToTimeline(e){this.previewTimeline[e]={timestamp:l.WebTimingUtil.getNow()}}}t.FilePreviewSession=p,p.currentSession=null})),define("metaserver/static/js/modules/clean/react/file_viewer/logging",["require","exports","metaserver/static/js/modules/clean/react/file_viewer/models","metaserver/static/js/modules/clean/react/file_viewer/file_preview_event_emitter","metaserver/static/js/modules/clean/react/file_viewer/constants","metaserver/static/js/modules/clean/react/file_viewer/sdk_file_viewer/experiments"],(function(e,t,i,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapKeyboardActionWithLogging=t.wrapToolbarActionWithLogging=t.logUserAction=void 0,t.logUserAction=(e,t,s={})=>{null!=i.FilePreviewSession.currentSession&&o.filePreviewEventEmitter.emit(r.EventType.FilePreviewUserAction,i.FilePreviewSession.currentSession,e,t,Object.assign(Object.assign({},s),{preview_page_revamp:n.fileViewerFeatureExperiments.previewPageRevamp||"NULL"}))},t.wrapToolbarActionWithLogging=function(e,i){return(...o)=>{const n=e(...o);return t.logUserAction(i,r.UserActionContext.Toolbar),n}},t.wrapKeyboardActionWithLogging=function(e,i){return(...o)=>{const n=e(...o);return t.logUserAction(i,r.UserActionContext.Keyboard),n}}})),define("typescript/libraries/comments2/src/components/annotation_utils",["require","exports","typescript/libraries/comments2/src/components/utils/to_percent"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isVideoAnnotation=t.toRectangleStyle=void 0,t.toRectangleStyle=function({x:e,y:t,width:o,height:r}){return{top:i.toPercent(t),left:i.toPercent(e),width:i.toPercent(o),height:i.toPercent(r)}},t.isVideoAnnotation=function(e){return void 0!==e&&"video"===e.type}})),define("typescript/libraries/comments2/src/components/utils/throttle-debounce",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.debounce=t.throttle=void 0,t.throttle=function(e,t){let i=!0,o=null;function r(){i=!0,null!==o&&(e(...o),o=null)}return function(...n){i?(i=!1,e(...n),setTimeout(r,t)):o=n}},t.debounce=function(e,t,i=!1){let o;return function(...r){const n=this,s=i&&void 0===o;void 0!==o&&window.clearTimeout(o),o=window.setTimeout((function(){o=void 0,i||e.apply(n,r)}),t),s&&e.apply(n,r)}}})),define("typescript/libraries/comments2/src/components/utils/to_percent",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toPercent=void 0,t.toPercent=function(e){return`${100*e}%`}})),define("typescript/libraries/comments2/src/transforms/index",["require","exports","typescript/libraries/comments2/src/transforms/comments","typescript/libraries/comments2/src/transforms/threads","typescript/libraries/comments2/src/transforms/users","typescript/libraries/comments2/src/transforms/revisions","typescript/libraries/comments2/src/transforms/annotations","typescript/libraries/comments2/src/transforms/third_party_source"],(function(e,t,i,o,r,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.thirdPartySourceToIThirdPartySource=t.iInteractionAnnotationToNumberedAnnotation=t.numberedAnnotationToIInteractionAnnotation=t.streamToRevision=t.userToIUser=t.usersToIUserMap=t.threadToIThread=t.threadsToIThreadMap=t.iCommentContentToUserSubmittedComment=void 0,Object.defineProperty(t,"iCommentContentToUserSubmittedComment",{enumerable:!0,get:function(){return i.iCommentContentToUserSubmittedComment}}),Object.defineProperty(t,"threadsToIThreadMap",{enumerable:!0,get:function(){return o.threadsToIThreadMap}}),Object.defineProperty(t,"threadToIThread",{enumerable:!0,get:function(){return o.threadToIThread}}),Object.defineProperty(t,"usersToIUserMap",{enumerable:!0,get:function(){return r.usersToIUserMap}}),Object.defineProperty(t,"userToIUser",{enumerable:!0,get:function(){return r.userToIUser}}),Object.defineProperty(t,"streamToRevision",{enumerable:!0,get:function(){return n.streamToRevision}}),Object.defineProperty(t,"numberedAnnotationToIInteractionAnnotation",{enumerable:!0,get:function(){return s.numberedAnnotationToIInteractionAnnotation}}),Object.defineProperty(t,"iInteractionAnnotationToNumberedAnnotation",{enumerable:!0,get:function(){return s.iInteractionAnnotationToNumberedAnnotation}}),Object.defineProperty(t,"thirdPartySourceToIThirdPartySource",{enumerable:!0,get:function(){return a.thirdPartySourceToIThirdPartySource}})})),define("typescript/libraries/comments2/src/transforms/annotations",["require","exports"],(function(e,t){"use strict";function i(e,t){return e[".tag"]===t}Object.defineProperty(t,"__esModule",{value:!0}),t.iInteractionAnnotationToNumberedAnnotation=t.numberedAnnotationToIInteractionAnnotation=t.iAnnotationToAnnotation=t.annotationToIAnnotation=void 0,t.annotationToIAnnotation=function(e){if(i(e,"video"))return{type:"video",time:e.time||0,timeSec:e.time_sec||0};if(i(e,"audio"))return{type:"audio",time:e.time};if(i(e,"document"))return{type:"document",regionType:e.region_type[".tag"],label:e.label,regions:e.regions};if(i(e,"image"))return{type:"image",region:e.region,label:e.label};throw new Error("Attempted to convert an annotation type that does not yet exist.")},t.iAnnotationToAnnotation=function(e){return"video"===e.type?{".tag":"video",time:e.time,time_sec:e.timeSec}:"audio"===e.type?{".tag":"audio",time:e.time}:"document"===e.type?{".tag":"document",regions:e.regions,region_type:{".tag":e.regionType}}:{".tag":"image",region:Object.assign(Object.assign({},e.region),{page:1})}},t.numberedAnnotationToIInteractionAnnotation=function(e){return"image"===e.type?{type:"rnd",regions:[e.region]}:"highlight"===e.regionType?{type:"highlight",regions:e.regions}:{type:"rnd",regions:e.regions}},t.iInteractionAnnotationToNumberedAnnotation=function({type:e,regions:t},i){return void 0===i?{type:"image",region:t[0]}:{type:"document",regionType:"rnd"===e?"rectangle":"highlight",regions:t.map(e=>(function(e,t){return Object.assign(Object.assign({},e),{page:t})})(e,i))}}})),define("typescript/libraries/comments2/src/transforms/comments",["require","exports","typescript/libraries/comments2/src/transforms/annotations","typescript/libraries/comments2/src/transforms/metadata","typescript/libraries/comments2/src/transforms/revisions"],(function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.iCommentContentToUserSubmittedComment=t.commentToIComment=void 0,t.commentToIComment=function(e,t,i,n){return{author:i[e.author_id],content:{metadata:o.metadataToIMetadata(e.metadata),text:e.content},deleted:e.deleted,id:e.id,threadId:t,timestamp:new Date(e.timestamp),revisionInfo:n&&e.revision?r.revisionInfoToIRevisionInfo(n,e.revision):{isCurrent:!0},userPermissions:{canDelete:e.permissions.can_delete,canEdit:e.permissions.can_edit}}},t.iCommentContentToUserSubmittedComment=function({annotation:e,content:t,stream:n}){return{annotation_data:e?i.iAnnotationToAnnotation(e):void 0,content:t.text,metadata:o.iCommentMetadataToUserSubmittedMetadata(t.metadata),revision:r.streamToRevision(n)}}})),define("typescript/libraries/comments2/src/transforms/metadata",["require","exports"],(function(e,t){"use strict";function i(e,t){return e.type===t}function o(e){return i(e,"mention")}function r(e){return i(e,"style")}function n(e){return i(e,"sticker")}function s(e){return i(e,"guest")}function a(e){return i(e,"reel")}function l(e){const t=e.format[".tag"];if("other"===t)throw new Error('"other" is not a valid format block');return{location:e.location,style:t,type:"style"}}function c(e){const t=e.user.type[".tag"];if("other"===t)throw new Error('"other" is not a valid user type');const i={identifier:e.user.identifier,type:t};return{location:e.location,type:"mention",user:i}}function d(e){var t,i,o;if(e.status&&e.approvers&&e.requester_email)return{type:"approval",status:e.status[".tag"],requester_email:e.requester_email,approval_type:null===(t=e.approval_type)||void 0===t?void 0:t[".tag"],actor:null===(i=e.actor)||void 0===i?void 0:i[".tag"],approvers:null===(o=e.approvers)||void 0===o?void 0:o.map(e=>{var t;return{email:e.email,display_name:e.display_name,overall_status:null===(t=e.overall_status)||void 0===t?void 0:t[".tag"]}}),requires_all:e.requires_all}}Object.defineProperty(t,"__esModule",{value:!0}),t.iCommentMetadataToUserSubmittedMetadata=t.metadataToIMetadata=t.approvalMetadataToIApprovalMetadata=t.isReelMetadata=t.isGuestMetadata=t.isStickerMetadata=t.isStyleMetadata=t.isMentionMetadata=void 0,t.isMentionMetadata=o,t.isStyleMetadata=r,t.isStickerMetadata=n,t.isGuestMetadata=s,t.isReelMetadata=a,t.approvalMetadataToIApprovalMetadata=d,t.metadataToIMetadata=function(e){const t=[...e.formatting.map(l),...e.mentions.map(c)];if(e.sticker){const i=(function(e){if(e.url&&e.name&&e.description)return{type:"sticker",id:e.id,url:e.url,name:e.name,description:e.description}})(e.sticker);i&&t.push(i)}if(e.guest){const i=(function(e){if(e.first_name||e.last_name)return{type:"guest",first_name:e.first_name,last_name:e.last_name}})(e.guest);i&&t.push(i)}if(e.reel){const i=(function(e){if(e.annotation_data)return{type:"reel",annotation_data:e.annotation_data}})(e.reel);i&&t.push(i)}if(e.approval){const i=d(e.approval);i&&t.push(i)}return t},t.iCommentMetadataToUserSubmittedMetadata=function(e){const t=e.filter(r).map(e=>({format:{".tag":e.style},location:e.location})),i=e.filter(o).map(e=>({user:{type:{".tag":e.user.type},identifier:e.user.identifier},location:e.location})),l=e.find(n),c=l?{id:l.id}:void 0,d=e.find(s),u=d?{first_name:d.first_name,last_name:d.last_name}:void 0,p=e.find(a);return{formatting:t,mentions:i,sticker:c,guest:u,reel:p?{annotation_data:p.annotation_data}:void 0}}})),define("typescript/libraries/comments2/src/transforms/revisions",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.streamToRevision=t.revisionInfoToIRevisionInfo=void 0,t.revisionInfoToIRevisionInfo=function(e,t){const i=t.timestamp?new Date(t.timestamp):void 0;return{isCurrent:e.ns_id===t.ns_id&&e.sjid===t.sjid,revision:{nsId:t.ns_id,sjId:t.sjid},timestamp:i}},t.streamToRevision=function(e){return e&&"file"===e.type?{ns_id:e.ns_id,sjid:e.sjid}:void 0}})),define("typescript/libraries/comments2/src/transforms/third_party_source",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.thirdPartySourceToIThirdPartySource=void 0,t.thirdPartySourceToIThirdPartySource=function(e){return e[".tag"]}})),define("typescript/libraries/comments2/src/transforms/threads",["require","exports","lodash","typescript/libraries/comments2/src/transforms/annotations","typescript/libraries/comments2/src/transforms/comments"],(function(e,t,i,o,r){"use strict";function n(e,t){if("resolved_no_details"===e[".tag"])return{type:"no_details"};if((function(e){return"resolved_with_details"===e[".tag"]})(e))return{type:"with_details",resolver:t[e.resolver_id],resolvedTimestamp:new Date(e.resolved_timestamp)};throw new Error("Not a valid type for ResolvedInfo.")}function s(e,t,i){const s=e.comments.map(o=>r.commentToIComment(o,e.id,t,i)),a=e.resolved_info?{resolved:!0,resolvedInfo:n(e.resolved_info,t)}:{resolved:!1};return Object.assign(Object.assign({annotation:e.annotation_data?o.annotationToIAnnotation(e.annotation_data):void 0,comments:s,id:e.id,read:e.read,readonly:e.readonly,isThirdParty:e.is_third_party},a),{timestamp:s[0].timestamp})}Object.defineProperty(t,"__esModule",{value:!0}),t.threadsToIThreadMap=t.threadToIThread=t.resolvedInfoToIResolvedInfo=void 0,t.resolvedInfoToIResolvedInfo=n,t.threadToIThread=s,t.threadsToIThreadMap=function(e,t,o){const r=e.map(e=>s(e,t,o));return i.keyBy(r,"id")}})),define("typescript/libraries/comments2/src/transforms/users",["require","exports","lodash"],(function(e,t,i){"use strict";function o(e){return{id:e.id,name:{display:e.display_name,initials:e.initials,public:e.public_name},photoUrl:e.photo_url}}Object.defineProperty(t,"__esModule",{value:!0}),t.usersToIUserMap=t.userToIUser=void 0,t.userToIUser=o,t.usersToIUserMap=function(e){const t=e.map(o);return i.keyBy(t,"id")}})),define("typescript/libraries/comments2/src/components/rich_facepile/avatars",["require","exports","tslib","react","typescript/libraries/comments2/src/components/rich_facepile/context","spectrum/avatar/index","spectrum/facepile/index","typescript/libraries/comments2/src/components/rich_facepile/spectrum_fork/facepile_members_avatar","spectrum/util/uuid_generator","typescript/libraries/comments2/src/components/rich_facepile/leave_active_mode_wrapper","typescript/libraries/comments2/src/components/rich_facepile/types"],(function(e,t,i,o,r,n,s,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Avatars=void 0,o=i.__importStar(o);class u extends o.Component{constructor(){super(...arguments),this.state={},this.tooltipContentWrapperClassName=l.generateUUID("sc-rich-facepile-tooltip-content"),this.documentClickListener=e=>{const t=e.target;void 0===this.state.activeTooltipIndex||this.closest(t,this.tooltipContentWrapperClassName)||this.closest(t,"mc-facepile-container")||this.setActiveTooltipIndex(void 0)},this.leaveActiveMode=()=>{this.setActiveTooltipIndex(void 0)},this.bindN=e=>{const t=[];for(let i=0;i<d.MAX_FACES;i++)t.push(()=>e(i));return t},this.onTooltipShownForIndex=e=>{if(this.activeMode)return;const{onTooltipChange:t}=this.props,i=this.infoFromIndex(e);if(t&&null!==i){const o=this.avatarRectForIndex(e,i);t({activeMode:this.activeMode,displayInfo:null},{activeMode:this.activeMode,displayInfo:i,avatarRect:o})}},this.onTooltipHiddenForIndex=e=>{if(this.activeMode)return;const{onTooltipChange:t}=this.props,i=this.infoFromIndex(e);t&&null!==i&&t({activeMode:this.activeMode,displayInfo:i},{activeMode:this.activeMode,displayInfo:null})},this.onAvatarClickForIndex=e=>{const{becomePassiveOnOverflowAvatarClick:t,onAvatarClick:i}=this.props,o=this.infoFromIndex(e),r=t&&o===d.OVERFLOW;r||this.activeMode||this.setActiveTooltipIndex(e),r&&this.activeMode&&this.setActiveTooltipIndex(void 0),o&&i&&i(o)},this.onAvatarMouseOverForIndex=e=>{this.activeMode&&this.setActiveTooltipIndex(e)},this.onAvatarMouseEnterForIndex=e=>{if(this.props.onAvatarMouseEnter){const t=this.infoFromIndex(e),i=this.avatarRectForIndex(e,t);this.props.onAvatarMouseEnter({activeMode:this.activeMode,displayInfo:t,avatarRect:i})}},this.onAvatarFocusForIndex=e=>{this.onAvatarMouseEnterForIndex(e),this.onAvatarMouseOverForIndex(e)},this.onTooltipShown=this.bindN(this.onTooltipShownForIndex),this.onTooltipHidden=this.bindN(this.onTooltipHiddenForIndex),this.onAvatarClick=this.bindN(this.onAvatarClickForIndex),this.onAvatarMouseOver=this.bindN(this.onAvatarMouseOverForIndex),this.onAvatarMouseEnter=this.bindN(this.onAvatarMouseEnterForIndex),this.onAvatarFocus=this.bindN(this.onAvatarFocusForIndex),this.avatarDivRefs=Array(d.MAX_FACES).fill(0).map(e=>o.createRef())}componentDidMount(){document.addEventListener("click",this.documentClickListener,!0),window.addEventListener("resize",this.leaveActiveMode,!0)}componentWillUnmount(){document.removeEventListener("click",this.documentClickListener,!0),window.removeEventListener("resize",this.leaveActiveMode,!0)}closest(e,t){for(;e;e=e.parentElement)if(e.classList.contains(t))return e;return null}get activeMode(){return void 0!==this.state.activeTooltipIndex}setActiveTooltipIndex(e){const{activeTooltipIndex:t}=this.state,{onTooltipChange:i}=this.props;if(i&&t!==e){const{activeMode:o}=this,r=void 0!==e,n=r?this.infoFromIndex(e):null;i({activeMode:o,displayInfo:o?this.infoFromIndex(t):n},{activeMode:r,displayInfo:n,avatarRect:r?this.avatarRectForIndex(e,n):void 0})}this.setState({activeTooltipIndex:e})}displayModeForIndex(e){const{activeTooltipIndex:t}=this.state,i=this.props.passiveShowOnHover?d.DisplayMode.Hover:d.DisplayMode.Auto;return void 0===t?i:t===e?d.DisplayMode.ForceShow:d.DisplayMode.ForceHide}infoFromIndex(e){const{avatarInfoList:t,avatarInfoList:{length:i},overflowRemainderCount:o}=this.props;return o&&e===i?d.OVERFLOW:e>=i?null:t[e]}getBoundingClientRectForRef({current:e}){return e?e.getBoundingClientRect():{left:-1,top:-1,width:0,height:0,right:-1,bottom:-1}}avatarRectForIndex(e,t){if(void 0===t&&(t=this.infoFromIndex(e)),!t)return;const{left:i,top:o,width:r,height:n}=this.getBoundingClientRectForRef(this.avatarDivRefs[e]);return{origin:{x:i,y:o},size:{width:r,height:n}}}get intl(){return this.context.intl}render(){const{avatarSize:e,avatarInfoList:t,overflowRemainderCount:i,tooltipComponent:r,renderFacepile:l,initialsToColorAssigner:u,source:p}=this.props,m=t.map((t,i)=>{const{present:s,activeTooltipContent:l,avatarColorSeed:d,displayName:m,initials:_,memberKey:v,passiveTooltipContent:f,photoUrl:h}=t,g=d||m,E=o.createElement("div",{onFocusCapture:this.onAvatarFocus[i],ref:this.avatarDivRefs[i]},o.createElement(a.FacepileMembersAvatar,{active:s,"aria-label":m,avatarColorSeed:g,avatarSize:e,initials:_,onClick:this.onAvatarClick[i],onMouseEnter:this.onAvatarMouseEnter[i],onMouseOver:this.onAvatarMouseOver[i],photoUrl:h,initialsToColorAssigner:u||void 0}));let S;return this.activeMode?(S=void 0!==l?l:f,null!==S&&(S=o.createElement(c.LeaveActiveModeWrapperContext.Provider,{value:{signalClick:this.leaveActiveMode}},S))):S=f,o.createElement(r,{avatar:E,source:p,displayMode:this.displayModeForIndex(i),tooltipContent:S,avatarColor:u?u(g):n.avatarColorForUserIdentifier(g),onTooltipShown:this.onTooltipShown[i],onTooltipHidden:this.onTooltipHidden[i],tooltipContentWrapperClassName:this.tooltipContentWrapperClassName,key:v})}),{intl:_}=this;if(i){const n=_.formatMessage({id:"tkBGME",defaultMessage:"99+"}),a=i>=99?n:""+i,l=t.length,c=o.createElement("div",{onFocusCapture:this.onAvatarMouseOver[l],ref:this.avatarDivRefs[l]},o.createElement(s.FacepileMembersOverflowCircle,{avatarSize:e,backgroundColor:"#627283",textColor:"white",onClick:this.onAvatarClick[l],onMouseOver:this.onAvatarMouseOver[l],remainderCount:a})),u=_.formatMessage({id:"U34Aor",defaultMessage:"{count, plural, one {# other} other {# others}}"},{count:i});m.push(o.createElement(r,{source:p,avatar:c,displayMode:this.displayModeForIndex(l),tooltipContent:o.createElement("div",{className:"sc-rich-facepile-overflow-tooltip-content"},u),avatarColor:"#627283",onTooltipShown:this.onTooltipShown[l],onTooltipHidden:this.onTooltipHidden[l],tooltipContentWrapperClassName:this.tooltipContentWrapperClassName,key:d.OVERFLOW}))}return l(m)}}t.Avatars=u,u.contextType=r.RichFacepileContext,u.displayName="Avatars"})),define("typescript/libraries/comments2/src/components/rich_facepile/context",["require","exports","tslib","react"],(function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RichFacepileContext=void 0,o=i.__importStar(o),t.RichFacepileContext=o.createContext({intl:{}})})),define("typescript/libraries/comments2/src/components/rich_facepile/index",["require","exports","typescript/libraries/comments2/src/components/rich_facepile/util","typescript/libraries/comments2/src/components/rich_facepile/rich_facepile","typescript/libraries/comments2/src/components/rich_facepile/types"],(function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RichFacepileProps=t.MAX_FACES=t.OVERFLOW=t.TooltipComponentProps=t.SizeClass=t.DisplayMode=t.AvatarInfo=t.RichFacepilePresentationInfo=t.RichFacepile=t.UtilTooltip=void 0,Object.defineProperty(t,"UtilTooltip",{enumerable:!0,get:function(){return i.UtilTooltip}}),Object.defineProperty(t,"RichFacepile",{enumerable:!0,get:function(){return o.RichFacepile}}),Object.defineProperty(t,"RichFacepilePresentationInfo",{enumerable:!0,get:function(){return o.RichFacepilePresentationInfo}}),Object.defineProperty(t,"AvatarInfo",{enumerable:!0,get:function(){return r.AvatarInfo}}),Object.defineProperty(t,"DisplayMode",{enumerable:!0,get:function(){return r.DisplayMode}}),Object.defineProperty(t,"SizeClass",{enumerable:!0,get:function(){return r.SizeClass}}),Object.defineProperty(t,"TooltipComponentProps",{enumerable:!0,get:function(){return r.TooltipComponentProps}}),Object.defineProperty(t,"OVERFLOW",{enumerable:!0,get:function(){return r.OVERFLOW}}),Object.defineProperty(t,"MAX_FACES",{enumerable:!0,get:function(){return r.MAX_FACES}}),Object.defineProperty(t,"RichFacepileProps",{enumerable:!0,get:function(){return r.RichFacepileProps}})})),define("typescript/libraries/comments2/src/components/rich_facepile/leave_active_mode_wrapper",["require","exports","tslib","react"],(function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LeaveActiveModeWrapper=t.LeaveActiveModeWrapperContext=void 0,o=i.__importStar(o),t.LeaveActiveModeWrapperContext=o.createContext({signalClick:()=>{}}),t.LeaveActiveModeWrapper=({children:e})=>o.createElement(t.LeaveActiveModeWrapperContext.Consumer,null,({signalClick:t})=>o.createElement("span",{onClick:t},e)),t.LeaveActiveModeWrapper.displayName="LeaveActiveModeWrapper"})),define("typescript/libraries/comments2/src/components/rich_facepile/rich_facepile",["require","exports","tslib","react","spectrum/facepile/index","typescript/libraries/comments2/src/components/rich_facepile/avatars","typescript/libraries/comments2/src/components/rich_facepile/context","typescript/libraries/comments2/src/components/rich_facepile/types"],(function(e,t,i,o,r,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RichFacepile=void 0,o=i.__importStar(o);const l={[a.SizeClass.Small]:2,[a.SizeClass.Medium]:3,[a.SizeClass.Large]:a.MAX_FACES,[a.SizeClass.ExtraLarge]:a.MAX_FACES};class c extends o.PureComponent{render(){const{avatarSize:e=32,avatarInfoList:t,becomePassiveOnOverflowAvatarClick:i,intl:c,onAvatarClick:d,onTooltipChange:u,onAvatarMouseEnter:p,overflowBasis:m,shadowBackgroundColor:_,sizeClass:v,source:f,sizeClassToCircleCountOverrides:h,tooltipComponent:g,passiveShowOnHover:E,initialsToColorAssigner:S}=this.props,w=Object.assign(Object.assign({},l),h),y=Math.min(w[v],a.MAX_FACES);if(y<=0)return null;const b=Math.max(m,t.length);let T,P;return"fileViewer"===this.props.source&&window.innerWidth<768?(P=t.length-1,T=t):b<=y?(T=t,P=void 0):(T=t.slice(0,y-1),P=b-T.length),o.createElement(s.RichFacepileContext.Provider,{value:{intl:c}},o.createElement(n.Avatars,{avatarSize:e,onAvatarClick:d,onTooltipChange:u,onAvatarMouseEnter:p,avatarInfoList:T,becomePassiveOnOverflowAvatarClick:i,passiveShowOnHover:E,overflowRemainderCount:P,source:f,tooltipComponent:g,renderFacepile:t=>o.createElement(r.Facepile,{avatarSize:e,shadowBackgroundColor:_},t.reverse()),initialsToColorAssigner:S||void 0}))}}t.RichFacepile=c,c.displayName="RichFacepile"})),define("typescript/libraries/comments2/src/components/rich_facepile/spectrum_fork/facepile_members_avatar",["require","exports","tslib","react","spectrum/avatar/index","spectrum/button/index"],(function(e,t,i,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FacepileMembersAvatar=void 0,o=i.__importStar(o);class s extends o.PureComponent{constructor(){super(...arguments),this.renderAvatarInitials=()=>{const{active:e,"aria-label":t,avatarColorSeed:i,avatarSize:n,initials:s,initialsToColorAssigner:a}=this.props;return o.createElement(r.AvatarInitials,{avatarSize:n,"aria-label":t,backgroundColor:a?a(i):r.avatarColorForUserIdentifier(i),variant:e?"normal":"inactive"},s)}}render(){const{active:e,"aria-label":t,"aria-describedby":i,avatarColorSeed:s,avatarSize:a,disabled:l,photoUrl:c,onClick:d,onMouseEnter:u,onMouseLeave:p,onMouseOver:m,tabIndex:_,initialsToColorAssigner:v}=this.props,f=v?v(s):r.avatarColorForUserIdentifier(s);return o.createElement(n.Button,{"aria-label":t,"aria-describedby":i,className:"mc-facepile-members-avatar",disabled:l,onClick:d,onMouseEnter:u,onMouseLeave:p,onMouseOver:m,tabIndex:_,variant:"circular"},c?o.createElement(r.Avatar,{renderFallback:this.renderAvatarInitials,size:a,src:c||void 0,variant:e?"normal":"inactive",style:{background:e?f:"#BFBFBF"}}):this.renderAvatarInitials())}}t.FacepileMembersAvatar=s,s.displayName="FacepileMembersAvatar"})),define("typescript/libraries/comments2/src/components/rich_facepile/types",["require","exports"],(function(e,t){"use strict";var i,o;Object.defineProperty(t,"__esModule",{value:!0}),t.SizeClass=t.DisplayMode=t.MAX_FACES=t.OVERFLOW=void 0,t.OVERFLOW="overflow",t.MAX_FACES=5,(i=t.DisplayMode||(t.DisplayMode={}))[i.Auto=1]="Auto",i[i.ForceShow=2]="ForceShow",i[i.ForceHide=3]="ForceHide",i[i.Hover=4]="Hover",(o=t.SizeClass||(t.SizeClass={}))[o.Small=0]="Small",o[o.Medium=1]="Medium",o[o.Large=2]="Large",o[o.ExtraLarge=3]="ExtraLarge"})),define("typescript/libraries/comments2/src/components/rich_facepile/util",["require","exports","tslib","react","classnames","spectrum/positioned_portal/index","spectrum/facepile_tooltip/facepile_tooltip_content","typescript/libraries/comments2/src/components/rich_facepile/types"],(function(e,t,i,o,r,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UtilTooltip=void 0,o=i.__importStar(o),r=i.__importDefault(r);class l extends o.PureComponent{constructor(e){super(e),this.tooltipDirection="below",this.hidePortal=()=>{const e=this.portalRef.current;e&&e.hidePortal.call(e)},this.handlePortalMouseout=e=>{const{displayMode:t}=this.props;t===a.DisplayMode.Hover&&this.hasLeftIntoTooltip(e)&&e.stopPropagation()},this.onContentMouseLeave=()=>{this.props.displayMode===a.DisplayMode.Hover&&this.hidePortal()},this.renderContent=()=>{var e,t;const{avatarColor:i,tooltipContent:n,tooltipContentWrapperClassName:a,source:l}=this.props;return null===n?null:o.createElement(s.FacepileTooltipContent,{backgroundColor:i,className:r.default("sc-rich-facepile-tooltip-content-container",a,{"offset-facepile":"fileViewer"===l&&(n.props.colorSeed||(null===(t=null===(e=n.props.children)||void 0===e?void 0:e.props)||void 0===t?void 0:t.colorSeed))}),tooltipContent:n,onMouseLeave:this.onContentMouseLeave})},this.portalRef=o.createRef()}componentDidUpdate({displayMode:e}){const{displayMode:t}=this.props,{current:i}=this.portalRef;i&&t!==e&&(t===a.DisplayMode.ForceShow?(this.hidePortal(),window.setTimeout(()=>i.showPortal.call(i),0)):i.state.isShown&&this.hidePortal())}hasLeftIntoTooltip(e){const t=e.target.getBoundingClientRect(),i=Math.abs(t.top-e.pageY),o=Math.abs(t.bottom-e.pageY),r=Math.abs(t.left-e.pageX),n=Math.abs(t.right-e.pageX);switch(Math.min(i,o,r,n)){case i:return"above"===this.tooltipDirection;case o:return"below"===this.tooltipDirection;case r:return"left"===this.tooltipDirection;case n:default:return"right"===this.tooltipDirection}}render(){const{avatar:e,onTooltipShown:t,onTooltipHidden:i,displayMode:r=a.DisplayMode.Auto}=this.props,s=r===a.DisplayMode.Hover?o.createElement("div",{onMouseLeave:this.handlePortalMouseout},e):e;return o.createElement(n.PositionedPortal,{renderContent:this.renderContent,onDidShow:t,onWillClose:i,isShowInitially:r===a.DisplayMode.ForceShow,positioning:this.tooltipDirection,ref:this.portalRef,showOnMouseMove:r===a.DisplayMode.Auto||r===a.DisplayMode.Hover,closeOnBlur:r===a.DisplayMode.Auto||r===a.DisplayMode.Hover},s)}}t.UtilTooltip=l,l.displayName="UtilTooltip"})),define("metaserver/static/js/modules/clean/cloud_docs/shared_components/dynamic_routing_modal",["require","exports","tslib","metaserver/static/js/modules/clean/react/components/modal","metaserver/static/js/modules/clean/cloud_docs/open_with_utils","metaserver/static/js/modules/clean/react/components/css","metaserver/static/js/modules/clean/cloud_docs/constants","react","metaserver/static/js/modules/core/i18n","spectrum/button/index","metaserver/static/js/modules/clean/cloud_docs/event_logging","metaserver/static/js/modules/clean/cloud_docs/types","metaserver/static/js/modules/clean/metrics/index","metaserver/static/js/dig-illustrations/spot/paper-airplane"],(function(e,t,i,o,r,n,s,a,l,c,d,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showDynamicRoutingModal=t.DynamicRoutingModal=void 0,a=i.__importStar(a);class _ extends a.Component{constructor(e){super(e),this.editorToString={preview:l.intl.formatMessage({id:"N5Byoz",defaultMessage:"Dropbox Preview"}),word:l.intl.formatMessage({id:"Y9FcUQ",defaultMessage:"Word for the web"}),excel:l.intl.formatMessage({id:"o3mRdr",defaultMessage:"Excel for the web"}),powerpoint:l.intl.formatMessage({id:"RTj2SO",defaultMessage:"PowerPoint for the web"}),gdoc:l.intl.formatMessage({id:"+HsOFj",defaultMessage:"Google Docs"}),gsheet:l.intl.formatMessage({id:"cpuRML",defaultMessage:"Google Sheets"}),gslides:l.intl.formatMessage({id:"PcJCVL",defaultMessage:"Google Slides"})},this.state={set_routing_dest:!1}}componentDidMount(){d.logUserAction({actionEvent:u.UserActionEventType.DYNAMIC_ROUTING_MODAL_IMPRESSION,userId:this.props.user.id,docPathOrId:this.props.file.file_id,data:{webOpenId:this.props.openId,origDest:this.props.currentEditor}})}componentWillUnmount(){if(!this.state.set_routing_dest){const e="Dismissed";d.logUserAction({actionEvent:u.UserActionEventType.DYNAMIC_ROUTING_MODAL_IMPRESSION,userId:this.props.user.id,docPathOrId:this.props.file.file_id,data:{webOpenId:this.props.openId,origDest:this.props.currentEditor,routingDest:e}});const t=p.getMetricsReporter(),i={origin:this.props.currentEditor,destination:e};t.createStats({ns:s.CLOUD_DOCS_AMP_NAMESPACE,name:"web/dynamicRoutingEvent"},i).record(1),this.setState({set_routing_dest:!1})}}render(){const e=this.editorToString[this.props.editorWithLock],t=this.editorToString[this.props.currentEditor];let i,n,_,v=l.intl.formatMessage({id:"ILSqGs",defaultMessage:"Want to see the latest version and edit?"});"preview"===this.props.currentEditor?(n=l.intl.formatMessage({id:"vX9MC5",defaultMessage:"Open in {editor_with_lock_string}"},{editor_with_lock_string:e}),i=l.intl.formatMessage({id:"MaUI+x",defaultMessage:"Right now people are working on this file in {editor_with_lock_string}. You can see updates and edit there."},{editor_with_lock_string:e})):this.props.isLockEditorEnabled?(n=l.intl.formatMessage({id:"jpCK4T",defaultMessage:"Edit in {editor_with_lock_string}"},{editor_with_lock_string:e}),i=l.intl.formatMessage({id:"1Y/1oL",defaultMessage:"Because this file is already open in {editor_with_lock_string}, you can only see updates and edit there."},{editor_with_lock_string:e})):(v=l.intl.formatMessage({id:"RtkW2p",defaultMessage:"You can’t edit this file right now"}),i=l.intl.formatMessage({id:"yOUn8S",defaultMessage:"Someone is working on this file in {editor_with_lock_string}. However, your admin has disabled access to {editor_with_lock_string} in your organization."},{editor_with_lock_string:e}));const f=(e,t)=>{d.logUserAction({actionEvent:u.UserActionEventType.DYNAMIC_ROUTING_MODAL_IMPRESSION,userId:this.props.user.id,docPathOrId:this.props.file.file_id,data:{webOpenId:this.props.openId,origDest:this.props.currentEditor,routingDest:e}});const i=p.getMetricsReporter(),o={origin:this.props.currentEditor,destination:e};i.createStats({ns:s.CLOUD_DOCS_AMP_NAMESPACE,name:"web/dynamicRoutingEvent"},o).record(1),this.setState({set_routing_dest:!0});const n=window.self;r.getCloudEditorUrl(this.props.user.id,this.props.file.file_id).then(i=>{r.openCloudEditorUrl(i,n,this.props.file.file_id,this.props.user.id,e,t)}).catch(e=>{r.handleError(e)})},h=()=>{f(this.props.editorWithLock,!1)};if(this.props.showViewOnlyMode){const e=()=>{f(this.props.currentEditor,!0)},i=l.intl.formatMessage({id:"nLLL8d",defaultMessage:"View-Only in {current_editor}"},{current_editor:t});_=a.createElement("div",{className:"link-text"},a.createElement("span",{role:"link",className:"link-span",tabIndex:0,onClick:e},i))}else if(!this.props.isLockEditorEnabled){const e=l.intl.formatMessage({id:"DWwxhG",defaultMessage:"View-Only in Preview"});_=a.createElement("div",{className:"link-text"},a.createElement("span",{role:"link",className:"link-span",tabIndex:0,onClick:()=>o.Modal.close()},e))}let g;return g=this.props.isLockEditorEnabled?a.createElement("div",{className:"edit-buttons"},a.createElement(c.Button,{className:"main-button",onClick:h},n),_):a.createElement("div",{className:"edit-buttons"},_),a.createElement(o.Modal,{id:"dynamic-routing",className:"dynamic-routing-modal",buttonComponent:g,displayCloseButton:!0,style:"clean"},a.createElement("div",{className:"default-dyn-routing-modal"},a.createElement("div",{className:"modal-image"},a.createElement(m.PaperAirplaneSpot,null)),a.createElement("div",{className:"main-text"},v),a.createElement("div",{className:"sub-text"},i)))}}_.displayName="DynamicRoutingModalWithoutCss",t.DynamicRoutingModal=n.requireCssWithComponent(_,["/static/css/cloud_docs/dynamic_routing-vfltbra9r.css"]),t.showDynamicRoutingModal=function(e){o.Modal.showInstance(a.createElement(t.DynamicRoutingModal,Object.assign({},e)))}})),define("metaserver/static/js/modules/clean/cloud_docs/shared_components/routing",["require","exports","tslib","metaserver/static/js/modules/clean/cloud_docs/constants","metaserver/static/js/modules/clean/previews/util","metaserver/static/js/modules/clean/previews/util","metaserver/static/js/modules/clean/cloud_docs/shared_components/dynamic_routing_modal","metaserver/static/js/modules/clean/cloud_docs/cloud_doc_api_client","metaserver/static/js/modules/clean/file_store/utils","metaserver/static/js/modules/core/browser","metaserver/static/js/modules/clean/cloud_docs/types"],(function(e,t,i,o,r,n,s,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCloudEditorString=t.maybeShowDynamicRoutingModal=void 0,n=i.__importStar(n),c=i.__importStar(c);const u={[o.MicrosoftEditors.WORD]:!0,[o.MicrosoftEditors.EXCEL]:!0,[o.MicrosoftEditors.POWERPOINT]:!1,[o.GoogleFileTypes.GOOGLE_DSS_SLIDES]:!1,[o.GoogleFileTypes.GOOGLE_DSS_DOC]:!1,[o.GoogleFileTypes.GOOGLE_DSS_SHEET]:!1,preview:!1};var p;(function(e){e.pptx="pptx",e.docx="docx",e.xlsx="xlsx"})(p||(p={}));const m={3503728:{[p.pptx]:o.GoogleFileTypes.GOOGLE_DSS_SLIDES,[p.docx]:o.GoogleFileTypes.GOOGLE_DSS_DOC,[p.xlsx]:o.GoogleFileTypes.GOOGLE_DSS_SHEET},661085:{[p.pptx]:o.MicrosoftEditors.POWERPOINT,[p.docx]:o.MicrosoftEditors.WORD,[p.xlsx]:o.MicrosoftEditors.EXCEL}},_={3503728:d.CloudDocProviderIntegration.GDD_INTEGRATION};function v(e,t){if(e)switch(e.toLowerCase()){case"google_docs":case"gdoc":return o.GoogleFileTypes.GOOGLE_DSS_DOC;case"google_slides":case"gslides":return o.GoogleFileTypes.GOOGLE_DSS_SLIDES;case"google_sheets":case"gsheet":return o.GoogleFileTypes.GOOGLE_DSS_SHEET;case"wopi":return r.isPptExtension(t)?o.MicrosoftEditors.POWERPOINT:n.isWordDocExtension(t)?o.MicrosoftEditors.WORD:o.MicrosoftEditors.EXCEL;case"paper":return t;case"word":case"excel":case"powerpoint":return e;default:return}}t.maybeShowDynamicRoutingModal=function(e,t,o){return i.__awaiter(this,void 0,void 0,(function*(){const i=o;a.getLockProviderAsync(e.id,t.file_id).then(r=>{const n=r.app_id;if(n&&m[n][i]&&(l.isBrowseFile(t)||l.isSharedFile(t))){const r=c.get_uri().getQuery().web_open_id,l=v(c.get_uri().getQuery().from_editor,o)||"preview",p={editorWithLock:m[n][i],currentEditor:l,file:t,user:e,showViewOnlyMode:u[l],openId:r,isLockEditorEnabled:!0};e.is_team?a.getTeamSettings(e.id).then(e=>{const t=e.settings;if(_.hasOwnProperty(n)){const e=_[n];p.isLockEditorEnabled=t[e][".tag"]===d.IntegrationCreateAndEdit[".tag"]}("preview"!==p.currentEditor||p.isLockEditorEnabled)&&s.showDynamicRoutingModal(p)}):s.showDynamicRoutingModal(p)}})}))},t.getCloudEditorString=v})),define("metaserver/static/js/modules/clean/image_size",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.imageBestFitSize=void 0;const i=[["480x320",480,320],["640x480",640,480],["800x600",800,600],["1024x768",1024,768],["1280x960",1280,960],["1600x1200",1600,1200],["2048x1536",2048,1536]];t.imageBestFitSize=function(e,t){for(const o of i){const i=o[0],r=o[1],n=o[2];if(r>=e||n>=t)return i}return i[i.length-1][0]}})),define("metaserver/static/js/modules/clean/react/previews/video/video_preview_logger",["require","exports","tslib","metaserver/static/js/modules/clean/deprecated_ajax/ajax_jquery","metaserver/static/js/modules/clean/perf_tools/web_timing_utils"],(function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VideoPreviewLogger=void 0,o=i.__importStar(o);t.VideoPreviewLogger=class{constructor(e,t){this.videoTruncated=!1,this.filePreviewSessionId=t?t.id:"",this.videoFormat=e}populateVideoDuration(e){this.videoDuration=Math.round(e)}setVideoTruncated(){this.videoTruncated=!0}logEvent(e,t){const i={event_name:e,client_timestamp_ms:r.WebTimingUtil.getNow(),file_preview_session_id:this.filePreviewSessionId,video_format:this.videoFormat,video_duration_seconds:this.videoDuration,video_truncated:this.videoTruncated,extra:JSON.stringify(Object.assign(Object.assign({},t),{FVSDK_ON:"false"}))};o.SilentBackgroundBeaconRequest({url:"/log/video_preview",data:i})}}})),define("metaserver/static/js/modules/clean/logging/hive/schemas/web-comments2",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Comments2LoggingTableRow=void 0;t.Comments2LoggingTableRow=class{constructor(e){this.category="web-comments2",this.active_user_id=null,this.authed_user_ids=null,this.identity_gid=null,this.locale_browser_header=null,this.locale_user_selected=null,this.referrer=null,this.session_id=null,this.team_id=null,this.team_type=null,this.ua_browser_name=null,this.ua_browser_version=null,this.ua_dist_name=null,this.ua_dist_version=null,this.ua_os_name=null,this.ua_os_version=null,this.user_agent=null,this.user_id=null,this.event=e.event,this.comment_gid=e.comment_gid,this.thread_gid=e.thread_gid,this.stream_gid=e.stream_gid,this.timestamp=Math.floor(Date.now()/1e3),this.is_annotation=e.is_annotation,this.time_comment_offset=e.time_comment_offset,this.file_extension=e.file_extension,this.file_obj_id=e.file_obj_id,this.platform=e.platform,this.oref_name=e.oref_name,this.ns_id=e.ns_id,this.file_size=e.file_size,this.error_message=e.error_message,this.annotation_type=e.annotation_type,this.page=e.page,this.referral_source=e.referral_source,this.product_surface=e.product_surface,this.is_mobile=e.is_mobile,this.annotation_position=e.annotation_position,this.is_third_party=e.is_third_party,this.is_sticker=e.is_sticker,Object.seal(this)}}})),define("metaserver/static/js/modules/clean/previews/actions",["require","exports","tslib","metaserver/static/js/modules/clean/referrer_cleansing_redirect","metaserver/static/js/modules/core/i18n"],(function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.docPrint=t.imagePrint=void 0,o=i.__importStar(o),t.imagePrint=function(e){const t=window.open("about:blank");if(!t)throw new Error(r.intl.formatMessage({id:"X9xK6f",defaultMessage:"Could not open new window"}));window.setTimeout(()=>{const i=t.document.createElement("style");i.innerHTML="\n      @page { margin: 0;}\n      img { max-width: 100%; max-height: 100%}\n    ",t.document.head.appendChild(i);const o=t.document.createElement("img");o.src=e,o.onload=()=>{t.print()},o.onerror=()=>{t.close()},t.document.body.appendChild(o)},50)},t.docPrint=function(e){o.safe_open_tab_and_redirect(e)}})),define("metaserver/static/js/modules/clean/previews/util",["require","exports","tslib","metaserver/static/js/modules/core/browser","metaserver/static/js/modules/clean/analytics","metaserver/static/js/modules/clean/filepath/filepath","metaserver/static/js/modules/clean/previews/constants","metaserver/static/js/modules/clean/cloud_docs/constants","metaserver/static/js/modules/clean/file_store/utils","metaserver/static/js/modules/clean/react/previews/constants","typescript/libraries/file-viewer/src/file_extension/extension_constants","typescript/libraries/file-viewer/src/core/data/riviera/types","metaserver/static/js/modules/core/uri","metaserver/static/js/modules/core/i18n","typescript/libraries/dbx-i18n/src/index"],(function(e,t,i,o,r,n,s,a,l,c,d,u,p,m,_){"use strict";function v(e,t){const i={};return i._subject_uid=String(t),e.updateQuery(i)}function f(e,t){return v(new p.URI({path:"/history"+e.fq_path}),t.id)}function h(e){return d.PRESENTATION_EXTS.map(e=>e.slice(1)).includes(e)}function g(e){return["doc","docm","docx"].includes(e)}function E(e){return["odp","odt","rtf","wpd"].includes(e)}function S(e,t){let i=Number.MAX_VALUE;if("pdf"===e)i=Number("524288000");else if(g(e)||E(e))i=s.MAX_WORD_DOC_FILE_SIZE_B;else if(h(e))i=s.MAX_PPT_FILE_SIZE_B;else if(t===s.PreviewType.Archive)i=s.MAX_ARCHIVE_FILE_SIZE_B;else if(t===s.PreviewType.HTML||t===s.PreviewType.Text)i=Number("8388608");else{if(t!==s.PreviewType.Linkfile)return;i=Number("10485760")}return i}Object.defineProperty(t,"__esModule",{value:!0}),t.isCloudDocPreview=t.isSupportedBundleFile=t.isLimitedPreview=t.tagCriticalPathContentRequest=t.iOSIframeScrollStyles=t.mapRivieraStatusToErrorType=t.isEmptyFile=t.filesizeSupported=t.getFileSizeLimit=t.isLibreOfficeExtension=t.isWordDocExtension=t.isPptExtension=t.VALID_PREVIEW_TYPES=t.redirectToVersionHistory=t.getVersionHistoryUrl=t.update_url_with_user_id=t.update_url_for_annotation=t.getModifierString=t.normalize_extension=t.getWhitelistedExtensionFromFile=t.getWhitelistedExtension=t.is_excel2_file=t.getIframeQuery=void 0,o=i.__importStar(o),n=i.__importStar(n),t.getIframeQuery=function(){return".react-file-viewer__preview iframe"},t.is_excel2_file=function(e){return["xls","csv","ods"].indexOf(e.substring(0,3))>-1},t.getWhitelistedExtension=function(e){const t=n.file_extension(e);return d.LOGGING_ALLOWED_EXTS.includes(`.${t}`)?t:d.LOGGING_UNALLOWED_EXT_PLACEHOLDER},t.getWhitelistedExtensionFromFile=function(e){const t=l.getExtension(e);return d.LOGGING_ALLOWED_EXTS.includes(`.${t}`)?t:d.LOGGING_UNALLOWED_EXT_PLACEHOLDER},t.normalize_extension=function(e){if("indd"===e)return e;const t=e.substring(0,3);switch(t){case"rtf":case"odt":case"wpd":return"doc";case"pps":case"odp":return"ppt";case"csv":case"ods":return"xls";default:return t}},t.getModifierString=function(e){if(e.ts)return _.timeSince(m.intl,1e3*e.ts,{displayLocation:"label"})},t.update_url_for_annotation=function(e){return e=(e=e.updateQuery({annotation_highlight:"1"})).updateQuery({annotation_region:"1"})},t.update_url_with_user_id=v,t.getVersionHistoryUrl=f,t.redirectToVersionHistory=function(e,t){r.UserActivityLogger.log("web","view_version_history");const i=f(e,t);o.redirect(i.toString())},t.VALID_PREVIEW_TYPES=[s.PreviewType.Archive,s.PreviewType.Audio,s.PreviewType.CloudDoc,s.PreviewType.Excel,s.PreviewType.HTML,s.PreviewType.Image,s.PreviewType.Linkfile,s.PreviewType.Other,s.PreviewType.SsrDoc,s.PreviewType.RawHTML,s.PreviewType.Restricted,s.PreviewType.Video,s.PreviewType.Doc,s.PreviewType.Photo,s.PreviewType.Text],t.isPptExtension=h,t.isWordDocExtension=g,t.isLibreOfficeExtension=E,t.getFileSizeLimit=S,t.filesizeSupported=function(e,t){const i=e.bytes;if(void 0===i)return!0;const o=S(l.getExtension(e),t);return!o||i<=o},t.isEmptyFile=function(e){return 0===e.bytes},t.mapRivieraStatusToErrorType=function(e){let t=c.ErrorType.LoadError;return e===u.RivieraStatus.TooBig?t=c.ErrorType.FileSizeError:e===u.RivieraStatus.PasswordProtected&&(t=c.ErrorType.PasswordProtectedError),t},t.iOSIframeScrollStyles=function(){return{overflow:"auto","-webkit-overflow-scrolling":"touch"}},t.tagCriticalPathContentRequest=function(e,t){return e&&t?p.URI.parse(e).updateQuery({psid:t.id}).toString():e},t.isLimitedPreview=function(e,t){return s.IworkExtensions.includes(l.getExtension(e))&&!e.is_dir&&t===s.PreviewType.Image},t.isSupportedBundleFile=function(e){return s.IworkExtensions.includes(l.getExtension(e))},t.isCloudDocPreview=function(e){return e.preview_type===s.PreviewType.CloudDoc||a.isCloudBasedFileByExtension(l.getExtension(e))}})),define("metaserver/static/js/modules/clean/react/previews/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.THRESHOLD_TEXT_SECOND_BATCH=t.TEXT_FIRST_BATCH_SIZE=t.PreviewToolbarButtonType=t.PreviewSessionEndReason=t.PreviewSourceAction=t.PreviewSourceContext=t.ErrorType=void 0,(function(e){e.LoadError="LOAD_ERROR",e.SupportError="SUPPORT_ERROR",e.ExtensionError="EXTENSION_ERROR",e.NeedFlashError="NEED_FLASH_ERROR",e.FileSizeError="FILE_SIZE_ERROR",e.PasswordProtectedError="PASSWORD_PROTECTED_ERROR",e.PendingUploadError="PENDING_UPLOAD_ERROR",e.EmptyFileError="EMPTY_FILE_ERROR",e.SymLinkError="SYM_LINK_ERROR",e.WatermarkingError="WATERMARKING_ERROR",e.UpsellError="UPSELL_ERROR",e.UnknownError="UNKNOWN_ERROR"})(t.ErrorType||(t.ErrorType={})),(function(e){e.Browse="browse",e.Home="home",e.SharedLinkFile="sl_file",e.SharedLinkFolder="sl_folder",e.SharedLinkCollection="sl_collection",e.VersionHistory="version_history",e.FileViewer="file_viewer",e.Desktop="desktop",e.EmbeddedSharedLinkFile="embedded_sl_file",e.ArchiveFile="archive_file",e.Workflow="workflow",e.TrelloPreview="trello_preview",e.FileLocking="file_locking",e.Search="search",e.Recents="recents",e.Starred="starred",e.StandalonePreview="standalone_preview",e.Photos="photos",e.Collections="collections",e.Hellosign="hellosign",e.Commerce="commerce",e.Transfer="transfer",e.PdfEditor="pdf_editor",e.Dropin="dropin"})(t.PreviewSourceContext||(t.PreviewSourceContext={})),(function(e){e.Visit="visit",e.Click="click",e.FileViewerExit="file_viewer_exit"})(t.PreviewSourceAction||(t.PreviewSourceAction={})),(function(e){e.Unknown="unknown",e.NewFile="new_file",e.BeforeUnload="before_unload",e.Unmount="unmount"})(t.PreviewSessionEndReason||(t.PreviewSessionEndReason={})),(function(e){e.EnableRegionCreation="EnableRegionCreation",e.Fullscreen="Fullscreen",e.PageDown="PageDown",e.PageIndicator="PageIndicator",e.PageUp="PageUp",e.Print="Print",e.Sidebar="Sidebar",e.ZoomIn="ZoomIn",e.ZoomOut="ZoomOut",e.FlipControls="FlipControls"})(t.PreviewToolbarButtonType||(t.PreviewToolbarButtonType={})),t.TEXT_FIRST_BATCH_SIZE=10,t.THRESHOLD_TEXT_SECOND_BATCH=7})),define("metaserver/static/js/modules/clean/react/previews/image_helpers",["require","exports","tslib","metaserver/static/js/modules/constants/python","metaserver/static/js/modules/clean/photos/thumbnail_url_util"],(function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.preloadImage=t.preloadResponsiveImage=t.getFallbackSrc=t.getSrcSet=t.IMG_SIZES_ATTR=void 0,o=i.__importStar(o);const n=[[480,320],[640,480],[800,600],[1024,768],[1280,960],[1600,1200],[2048,1536]];function s(e,t){let i;return i=t?n.filter(([e,i])=>e<=t[0]&&i<=t[1]):n,i.map(([t,i])=>r.thumbnailUrlForSize(e,t,i,o.THUMBNAIL_SIZE_MODE.ABSTRACT)+` ${t}w`).join(", ")}function a(e){return r.thumbnailUrlForSize(e,800,600,o.THUMBNAIL_SIZE_MODE.ABSTRACT)}function l(e,t){return new Promise((i,o)=>{const r=Date.now(),n=new Image;n.onload=()=>{i({started:r,completed:Date.now()})},n.onerror=()=>{o({started:r,failed:Date.now()})},t&&(t.srcset&&(n.srcset=t.srcset),t.sizes&&(n.sizes=t.sizes)),n.src=e})}t.IMG_SIZES_ATTR="90vw",t.getSrcSet=s,t.getFallbackSrc=a,t.preloadResponsiveImage=function(e){return l(a(e),{srcset:s(e),sizes:t.IMG_SIZES_ATTR})},t.preloadImage=l})),define("metaserver/static/js/modules/clean/react/previews/print_helpers",["require","exports","metaserver/static/js/modules/core/i18n"],(function(e,t,i){"use strict";function o(e){return!(e&&e.canPrintRoles&&0===e.canPrintRoles.length)}Object.defineProperty(t,"__esModule",{value:!0}),t.getPrintTooltip=t.canPrint=void 0,t.canPrint=o,t.getPrintTooltip=function(e){return o(e)?i.intl.formatMessage({id:"WyIenC",defaultMessage:"Print"}):i.intl.formatMessage({id:"ZMJOlD",defaultMessage:"Printing is turned off for this file."})}})),define("metaserver/static/js/modules/clean/react/previews/video/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QualityLabelOrder=t.HdLabels=void 0,t.HdLabels=["1080p","720p"],t.QualityLabelOrder=[...t.HdLabels,"480p","360p","240p","256k","192k","128k"].reverse()})),define("metaserver/static/js/modules/clean/react/previews/video/utils",["require","exports","tslib","metaserver/static/js/modules/core/browser_detection"],(function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTechFromPlayer=t.video_type=t.showQualityNativeHls=void 0,o=i.__importStar(o),t.showQualityNativeHls=function(){return o.edge||o.safari};t.video_type=function(e){return"application/vnd.apple.mpegurl"},t.getTechFromPlayer=function(e){return e.tech({IWillNotUseThisInPlugins:!0})}}));var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,i,o){void 0===o&&(o=i),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,o){void 0===o&&(o=i),e[o]=t[i]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&__createBinding(t,e,i);return __setModuleDefault(t,e),t};define("metaserver/static/js/modules/clean/react/share_download/button",["require","exports","metaserver/static/js/modules/clean/react/async/loadable"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareDownloadButton=t.DownloadSimpleButton=void 0,t.DownloadSimpleButton=i.Loadable({loader:()=>new Promise((t,i)=>{e(["metaserver/static/js/modules/clean/react/share_download/button_component"],t,i)}).then(__importStar).then(({DownloadSimpleButton:e})=>e)}),t.ShareDownloadButton=i.Loadable({loader:()=>new Promise((t,i)=>{e(["metaserver/static/js/modules/clean/react/share_download/button_component"],t,i)}).then(__importStar).then(({ShareDownloadButton:e})=>e)})})),define("metaserver/static/js/modules/clean/shallow_equal",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shallowEqualArray=t.shallowEqual=void 0;const i=Object.prototype.hasOwnProperty;function o(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}t.shallowEqual=function(e,t){if(o(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let n=0;n<r.length;n++)if(!i.call(t,r[n])||!o(e[r[n]],t[r[n]]))return!1;return!0},t.shallowEqualArray=function(e,t){if(e===t)return!0;if(!e||!t||e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}})),define("metaserver/static/js/modules/clean/react/comments2/util",["require","exports","tslib","lodash","metaserver/static/js/modules/core/browser_detection","metaserver/static/js/modules/constants/comments2","typescript/libraries/comments2/src/components/annotation_utils","metaserver/static/js/modules/core/browser_detection","metaserver/static/js/modules/core/browser"],(function(e,t,i,o,r,n,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseActiveCommentFromUrl=t.createFullRectangle=t.isFullImageAnnotation=t.isFullPageAnnotation=t.getThreadForNumberedAnnotationAtPoint=t.useBolt=t.isTimecodeAnnotation=t.canShowUnreadPill=t.isComments2Mobile=t.getAnnotationInfoForThread=t.findCommentThread=t.isContextSame=t.isStreamSame=t.isUserSame=t.createBackoff=void 0,o=i.__importStar(o),l=i.__importStar(l);function c(e){return(t,i)=>void 0===t||void 0===i?t===i:e(t,i)}function d(...e){return c((t,i)=>e.every(e=>t[e]===i[e]))}function u(e){return void 0!==e&&("audio"===e.type||"video"===e.type)}function p(e,t,i){return t<=e&&e<=i}t.createBackoff=function(e=1e3,t=3e5){let i,o=0;return{resetBackoff:()=>{o=0,null!=i&&clearTimeout(i)},backoff:r=>i=setTimeout(r,Math.random()*Math.min(e*(Math.pow(2,o++)-1),t))}},t.isUserSame=d("id"),t.isStreamSame=d("type","id"),t.isContextSame=c((e,i)=>t.isStreamSame(e.stream,i.stream)&&t.isUserSame(e.viewer,i.viewer)),t.findCommentThread=function(e,t){for(const i of e){const e=o.find(i.comments,{id:t});if(e)return{comment:e,thread:i}}return null},t.getAnnotationInfoForThread=function({annotation:e}){if(u(e))return{playerCurrentTime:e.time,playerCurrentTimeSec:s.isVideoAnnotation(e)?e.timeSec:void 0,annotationMayBeOffscreen:!1}},t.isComments2Mobile=r.is_mobile_or_tablet,t.canShowUnreadPill=function(){return!a.msie},t.isTimecodeAnnotation=u,t.useBolt=function(){return!n.COMMENTS2_DISABLE_BOLT};const m=(e,t,i)=>Math.min(...(e=>"image"===e.annotation.type?[e.annotation.region]:e.annotation.regions)(e).map(e=>(function(e,t,i){const o=e.x+e.width,r=e.y+e.height,n=(e,t)=>e<t?e:1/0;if(p(t.x,e.x,o)&&p(t.y,e.y,r)){const s=16/i.width,a=16/i.height;return Math.min(n(Math.min(t.x-e.x,o-t.x),s),n(Math.min(t.y-e.y,r-t.y),a))}return 1/0})(e,t,i)));function _({x:e,y:t,width:i,height:o}){return 0===e&&0===t&&1===i&&1===o}t.getThreadForNumberedAnnotationAtPoint=function(e,t,i){return o=t=>m(t,e,i),t.reduce(({minRank:e,minElem:t},i)=>{const r=o(i);return e<=r?{minRank:e,minElem:t}:{minRank:r,minElem:i}},{minRank:1/0,minElem:void 0}).minElem;var o},t.isFullPageAnnotation=function(e){return 1===e.regions.length&&_(e.regions[0])},t.isFullImageAnnotation=function(e){return _(e.region)},t.createFullRectangle=function(){return{x:0,y:0,width:1,height:1}},t.parseActiveCommentFromUrl=function(){const e=/comment_id=(.*)/.exec(l.get_uri().getFragment());return e?e[1]:void 0}}));
//# sourceMappingURL=pkg-previews_core.min.js-vfln_2CVU.map